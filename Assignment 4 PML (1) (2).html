<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html><head></head><body>















    




    
    
    
    


<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h1>Goutham Selvakumar<a rel="noopener" class="anchor-link" href="#Goutham-Selvakumar">&#182;</a></h1><h1>DSC 478 (Assignment 4)<a rel="noopener" class="anchor-link" href="#DSC-478-(Assignment-4)">&#182;</a></h1><ol>
<li>PCA for Reduced Dimensionality in Clustering
a. [5 pts] Load in the image data matrix (with rows as images and columns as features). Also load in the numeric class labels from the segmentation class file. Using your favorite method (e.g., sklearn&#39;s min-max scaler), perform min-max normalization on the data matrix so that each feature is scaled to [0,1] range.</li>
</ol>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[1]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Importing the Packages</span>
<span class="c1">#Running it</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">linalg</span> <span class="k">as</span> <span class="n">la</span>
<span class="kn">import</span> <span class="nn">pdb</span>
<span class="kn">import</span> <span class="nn">pylab</span> <span class="k">as</span> <span class="nn">pl</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="c1">#Importing sci-kit learn</span>
<span class="c1">#Running it</span>
<span class="kn">import</span> <span class="nn">sklearn</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">silhouette_samples</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">completeness_score</span><span class="p">,</span> <span class="n">homogeneity_score</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">decomposition</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[2]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Reading the files of data, class, and names</span>
<span class="n">segmentation_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="s2">&quot;C:/Users/admin/Desktop/segmentation_data.txt&quot;</span><span class="p">,</span> <span class="n">delimiter</span> <span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">segmentation_class</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="s2">&quot;C:/Users/admin/Desktop/segmentation_classes.txt&quot;</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">segmentation_names</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="s2">&quot;C:/Users/admin/Desktop/segmentation_names.txt&quot;</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[3]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Segmentation data is provided</span>
<span class="n">segmentation_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[3]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
      <th>13</th>
      <th>14</th>
      <th>15</th>
      <th>16</th>
      <th>17</th>
      <th>18</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>110.0</td>
      <td>189.0</td>
      <td>9</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.000000</td>
      <td>0.666667</td>
      <td>1.222222</td>
      <td>1.186342</td>
      <td>12.925926</td>
      <td>10.888889</td>
      <td>9.222222</td>
      <td>18.666668</td>
      <td>-6.111111</td>
      <td>-11.111111</td>
      <td>17.222221</td>
      <td>18.666668</td>
      <td>0.508139</td>
      <td>1.910864</td>
    </tr>
    <tr>
      <th>1</th>
      <td>86.0</td>
      <td>187.0</td>
      <td>9</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.111111</td>
      <td>0.720082</td>
      <td>1.444444</td>
      <td>0.750309</td>
      <td>13.740741</td>
      <td>11.666667</td>
      <td>10.333334</td>
      <td>19.222221</td>
      <td>-6.222222</td>
      <td>-10.222222</td>
      <td>16.444445</td>
      <td>19.222221</td>
      <td>0.463329</td>
      <td>1.941465</td>
    </tr>
    <tr>
      <th>2</th>
      <td>225.0</td>
      <td>244.0</td>
      <td>9</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.388889</td>
      <td>2.195113</td>
      <td>3.000000</td>
      <td>1.520234</td>
      <td>12.259259</td>
      <td>10.333334</td>
      <td>9.333334</td>
      <td>17.111110</td>
      <td>-5.777778</td>
      <td>-8.777778</td>
      <td>14.555555</td>
      <td>17.111110</td>
      <td>0.480149</td>
      <td>1.987902</td>
    </tr>
    <tr>
      <th>3</th>
      <td>47.0</td>
      <td>232.0</td>
      <td>9</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.277778</td>
      <td>1.254621</td>
      <td>1.000000</td>
      <td>0.894427</td>
      <td>12.703704</td>
      <td>11.000000</td>
      <td>9.000000</td>
      <td>18.111110</td>
      <td>-5.111111</td>
      <td>-11.111111</td>
      <td>16.222221</td>
      <td>18.111110</td>
      <td>0.500966</td>
      <td>1.875362</td>
    </tr>
    <tr>
      <th>4</th>
      <td>97.0</td>
      <td>186.0</td>
      <td>9</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.166667</td>
      <td>0.691215</td>
      <td>1.166667</td>
      <td>1.005540</td>
      <td>15.592592</td>
      <td>13.888889</td>
      <td>11.777778</td>
      <td>21.111110</td>
      <td>-5.111111</td>
      <td>-11.444445</td>
      <td>16.555555</td>
      <td>21.111110</td>
      <td>0.442661</td>
      <td>1.863654</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[4]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">##Segmentation class is provided</span>
<span class="n">segmentation_class</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[4]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>GRASS</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>GRASS</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>GRASS</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>GRASS</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>GRASS</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[5]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Segmentation names is provided</span>
<span class="n">segmentation_names</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[5]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>REGION-CENTROID-COL</td>
    </tr>
    <tr>
      <th>1</th>
      <td>REGION-CENTROID-ROW</td>
    </tr>
    <tr>
      <th>2</th>
      <td>REGION-PIXEL-COUNT</td>
    </tr>
    <tr>
      <th>3</th>
      <td>SHORT-LINE-DENSITY-5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>SHORT-LINE-DENSITY-2</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[6]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Info on Segmentation_data</span>
<span class="n">segmentation_data</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 2100 entries, 0 to 2099
Data columns (total 19 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   0       2100 non-null   float64
 1   1       2100 non-null   float64
 2   2       2100 non-null   int64  
 3   3       2100 non-null   float64
 4   4       2100 non-null   float64
 5   5       2100 non-null   float64
 6   6       2100 non-null   float64
 7   7       2100 non-null   float64
 8   8       2100 non-null   float64
 9   9       2100 non-null   float64
 10  10      2100 non-null   float64
 11  11      2100 non-null   float64
 12  12      2100 non-null   float64
 13  13      2100 non-null   float64
 14  14      2100 non-null   float64
 15  15      2100 non-null   float64
 16  16      2100 non-null   float64
 17  17      2100 non-null   float64
 18  18      2100 non-null   float64
dtypes: float64(18), int64(1)
memory usage: 311.8 KB
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[7]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Info on Segmentation_class</span>
<span class="n">segmentation_class</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 2100 entries, 0 to 2099
Data columns (total 2 columns):
 #   Column  Non-Null Count  Dtype 
---  ------  --------------  ----- 
 0   0       2100 non-null   object
 1   1       2100 non-null   int64 
dtypes: int64(1), object(1)
memory usage: 32.9+ KB
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[8]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Info on Segmentation_names</span>
<span class="n">segmentation_names</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 19 entries, 0 to 18
Data columns (total 1 columns):
 #   Column  Non-Null Count  Dtype 
---  ------  --------------  ----- 
 0   0       19 non-null     object
dtypes: object(1)
memory usage: 280.0+ bytes
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[9]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Using the favorite method </span>
<span class="c1">#Sklearn&#39;s min-max scaler</span>
<span class="n">min_max_scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[10]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Normalizing the Image data</span>
<span class="n">segmentation_data_norm</span> <span class="o">=</span> <span class="n">min_max_scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">segmentation_data</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[11]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">segmentation_data_norm</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[11]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>array([[0.43083004, 0.74166667, 0.        , ..., 0.12371135, 0.50813884,
        0.83184923],
       [0.33596838, 0.73333333, 0.        , ..., 0.12739322, 0.46332908,
        0.83698646],
       [0.88537549, 0.97083333, 0.        , ..., 0.11340205, 0.48014903,
        0.84478233],
       ...,
       [0.50197628, 0.625     , 0.        , ..., 0.07216495, 0.5409177 ,
        0.17591546],
       [0.58893281, 0.6125    , 0.        , ..., 0.08100147, 0.50308645,
        0.18478933],
       [0.48616601, 0.62916667, 0.        , ..., 0.09646539, 0.4799313 ,
        0.17037463]])</pre>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>b. [10 pts] Using the Kmeans implementation in scikit-learn, perform clustering on the image data (use K = 7 in your clustering so that later we can compare the clusters to the 7 pre-assigned image classes). Print the cluster centroids (use some formatting so that they are visually understandable). To evaluate your clusters, first perform Silhouette analysis on the clusters (compute Silhouette values for all instances in the data, and then compute the overall mean Silhouette value; optionally, you can provide a visualization of the Silhouettes). Next, compare your 7 clusters to the 7 pre-assigned classes by computing the Completeness and Homogeneity values of the generated clusters.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[12]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Performing the K-Means with </span>
<span class="c1">#n_clusters = 7</span>
<span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[13]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Fitting the k_means</span>
<span class="n">kmeans</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">segmentation_data_norm</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>C:\Users\admin\AppData\Roaming\Python\Python39\site-packages\sklearn\cluster\_kmeans.py:1334: UserWarning: KMeans is known to have a memory leak on Windows with MKL, when there are less chunks than available threads. You can avoid it by setting the environment variable OMP_NUM_THREADS=9.
  warnings.warn(
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Initialization complete
Iteration 0, inertia 506.35737740375237.
Iteration 1, inertia 373.86650793537837.
Iteration 2, inertia 369.631799194094.
Iteration 3, inertia 369.2095008978527.
Iteration 4, inertia 368.6663783510166.
Iteration 5, inertia 367.7229314338777.
Iteration 6, inertia 367.111898373278.
Iteration 7, inertia 366.68471105856787.
Iteration 8, inertia 366.0995217094406.
Iteration 9, inertia 365.14649803404444.
Iteration 10, inertia 363.94430569725864.
Iteration 11, inertia 362.1112597508931.
Iteration 12, inertia 360.3518922653296.
Iteration 13, inertia 357.72950987839454.
Iteration 14, inertia 354.88692508781503.
Iteration 15, inertia 352.61226671223596.
Iteration 16, inertia 351.6400682938731.
Iteration 17, inertia 351.338077062855.
Iteration 18, inertia 351.0321366298228.
Iteration 19, inertia 350.65014384299496.
Iteration 20, inertia 350.17113660916476.
Iteration 21, inertia 350.0500996895915.
Iteration 22, inertia 350.0266720088565.
Iteration 23, inertia 350.02186147714275.
Iteration 24, inertia 350.01547472608337.
Iteration 25, inertia 350.0129027194548.
Converged at iteration 25: strict convergence.
Initialization complete
Iteration 0, inertia 671.959985174455.
Iteration 1, inertia 379.40572670941344.
Iteration 2, inertia 372.8921479284963.
Iteration 3, inertia 371.4182395876936.
Iteration 4, inertia 370.29343248635746.
Iteration 5, inertia 369.0570382579889.
Iteration 6, inertia 367.77591855269634.
Iteration 7, inertia 366.154888889612.
Iteration 8, inertia 363.98710113140265.
Iteration 9, inertia 361.36562359984305.
Iteration 10, inertia 358.386053917.
Iteration 11, inertia 356.03666764237096.
Iteration 12, inertia 354.3940664300964.
Iteration 13, inertia 353.55875347564495.
Iteration 14, inertia 352.6749346856634.
Iteration 15, inertia 351.62839493178825.
Iteration 16, inertia 351.34319627512485.
Iteration 17, inertia 351.27263103027553.
Iteration 18, inertia 351.2084570292466.
Iteration 19, inertia 351.0327800686873.
Iteration 20, inertia 350.72415491930167.
Iteration 21, inertia 350.2419161305431.
Iteration 22, inertia 350.05803602324.
Iteration 23, inertia 350.03070324779236.
Iteration 24, inertia 350.02186147714275.
Iteration 25, inertia 350.01547472608337.
Iteration 26, inertia 350.0129027194547.
Converged at iteration 26: strict convergence.
Initialization complete
Iteration 0, inertia 615.1468258781277.
Iteration 1, inertia 399.59175812027775.
Iteration 2, inertia 381.9450146322318.
Iteration 3, inertia 377.7991071021421.
Iteration 4, inertia 376.948583240124.
Iteration 5, inertia 376.7162764970415.
Iteration 6, inertia 376.6581225588815.
Iteration 7, inertia 376.63348027963394.
Iteration 8, inertia 376.6017807533802.
Iteration 9, inertia 376.55469798990083.
Iteration 10, inertia 376.48176125481143.
Iteration 11, inertia 376.3751905249011.
Iteration 12, inertia 376.08639433261027.
Iteration 13, inertia 374.7059568237554.
Iteration 14, inertia 374.23712132130686.
Iteration 15, inertia 373.9666384971418.
Iteration 16, inertia 373.84701202679105.
Iteration 17, inertia 373.7985172170371.
Iteration 18, inertia 373.7735845915269.
Iteration 19, inertia 373.7625061196404.
Iteration 20, inertia 373.7601302284342.
Converged at iteration 20: strict convergence.
Initialization complete
Iteration 0, inertia 613.1248748199533.
Iteration 1, inertia 378.0207792265611.
Iteration 2, inertia 373.54453541269163.
Iteration 3, inertia 371.25974420719916.
Iteration 4, inertia 369.99768307908.
Iteration 5, inertia 368.99860104918974.
Iteration 6, inertia 368.3566571057544.
Iteration 7, inertia 367.49494338729704.
Iteration 8, inertia 367.0684887186312.
Iteration 9, inertia 366.9901404611777.
Iteration 10, inertia 366.9385599334192.
Iteration 11, inertia 366.7697943403659.
Iteration 12, inertia 366.581541913318.
Iteration 13, inertia 366.5365598192113.
Iteration 14, inertia 366.5209695903607.
Iteration 15, inertia 366.51390132128193.
Iteration 16, inertia 366.4936502868797.
Iteration 17, inertia 366.48864819982214.
Converged at iteration 17: strict convergence.
Initialization complete
Iteration 0, inertia 611.5881249445521.
Iteration 1, inertia 384.6428654715184.
Iteration 2, inertia 378.5604005875951.
Iteration 3, inertia 377.3598474334396.
Iteration 4, inertia 376.96645833913743.
Iteration 5, inertia 376.77823268427267.
Iteration 6, inertia 376.70542246669004.
Iteration 7, inertia 376.6603641043572.
Iteration 8, inertia 376.63544120042053.
Iteration 9, inertia 376.62939261403403.
Converged at iteration 9: strict convergence.
Initialization complete
Iteration 0, inertia 556.8140740634523.
Iteration 1, inertia 396.23851225553034.
Iteration 2, inertia 389.6975880531528.
Iteration 3, inertia 383.891905205317.
Iteration 4, inertia 379.1658412381875.
Iteration 5, inertia 377.70347021268935.
Iteration 6, inertia 377.3330492397104.
Iteration 7, inertia 377.27935521760674.
Iteration 8, inertia 377.25454349902435.
Iteration 9, inertia 377.2339437838324.
Iteration 10, inertia 377.20451269063545.
Iteration 11, inertia 377.18189053715014.
Iteration 12, inertia 377.1741754272709.
Iteration 13, inertia 377.1622079395236.
Iteration 14, inertia 377.15587687217675.
Iteration 15, inertia 377.1497219922011.
Iteration 16, inertia 377.1417009096021.
Iteration 17, inertia 377.1324517435817.
Iteration 18, inertia 377.1304721245349.
Converged at iteration 18: strict convergence.
Initialization complete
Iteration 0, inertia 514.2415367799849.
Iteration 1, inertia 375.9579645291826.
Iteration 2, inertia 367.10632608347737.
Iteration 3, inertia 365.83056690056213.
Iteration 4, inertia 365.6501581115318.
Iteration 5, inertia 365.5619306405654.
Iteration 6, inertia 365.5349311546865.
Iteration 7, inertia 365.5107376170937.
Iteration 8, inertia 365.5041407388076.
Iteration 9, inertia 365.5013033211088.
Converged at iteration 9: strict convergence.
Initialization complete
Iteration 0, inertia 573.9538675786183.
Iteration 1, inertia 396.45451954104243.
Iteration 2, inertia 388.01154865064865.
Iteration 3, inertia 376.3584020908533.
Iteration 4, inertia 369.5937140722726.
Iteration 5, inertia 367.02177359772963.
Iteration 6, inertia 365.7533243926234.
Iteration 7, inertia 364.9009424293096.
Iteration 8, inertia 364.40700760473214.
Iteration 9, inertia 364.05045664749923.
Iteration 10, inertia 363.7251579242761.
Iteration 11, inertia 363.57581520097136.
Iteration 12, inertia 363.525741108853.
Iteration 13, inertia 363.4779915882066.
Iteration 14, inertia 363.4409423086217.
Iteration 15, inertia 363.42177397911405.
Iteration 16, inertia 363.4111533122933.
Converged at iteration 16: center shift 2.526478879675771e-06 within tolerance 4.150156953284628e-06.
Initialization complete
Iteration 0, inertia 510.6827753110628.
Iteration 1, inertia 379.5728637537467.
Iteration 2, inertia 373.1303182296345.
Iteration 3, inertia 370.46302941350535.
Iteration 4, inertia 368.8743971354626.
Iteration 5, inertia 368.0727371100643.
Iteration 6, inertia 367.19042505888854.
Iteration 7, inertia 366.7545081105737.
Iteration 8, inertia 366.58103944843515.
Iteration 9, inertia 366.51523102656097.
Iteration 10, inertia 366.50211994018275.
Iteration 11, inertia 366.49537930261715.
Iteration 12, inertia 366.4906720263786.
Iteration 13, inertia 366.4863178694847.
Converged at iteration 13: strict convergence.
Initialization complete
Iteration 0, inertia 581.904112551271.
Iteration 1, inertia 374.0877351691055.
Iteration 2, inertia 371.9620227672402.
Iteration 3, inertia 371.3903388991439.
Iteration 4, inertia 371.1442768158542.
Iteration 5, inertia 371.0399303784293.
Iteration 6, inertia 371.00854121403313.
Iteration 7, inertia 370.994979129795.
Iteration 8, inertia 370.9754737091733.
Iteration 9, inertia 370.95826722165634.
Converged at iteration 9: strict convergence.
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[13]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div class="sk-top-container"><div class="sk-text-repr-fallback"><pre>KMeans(max_iter=500, n_clusters=7, verbose=1)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br/>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container"><div class="sk-item"><div class="sk-estimator sk-toggleable"><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">KMeans</label><div class="sk-toggleable__content"><pre>KMeans(max_iter=500, n_clusters=7, verbose=1)</pre></div></div></div></div></div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[14]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">clusters</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">segmentation_data_norm</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[15]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">clusters</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Cluster&quot;</span><span class="p">])</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[15]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>2095</th>
      <td>6</td>
    </tr>
    <tr>
      <th>2096</th>
      <td>0</td>
    </tr>
    <tr>
      <th>2097</th>
      <td>3</td>
    </tr>
    <tr>
      <th>2098</th>
      <td>3</td>
    </tr>
    <tr>
      <th>2099</th>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>2100 rows &#215; 1 columns</p>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[16]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Printing the centroids of the cluster </span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">float_format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:,.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span>
<span class="c1">#Centroids</span>
<span class="n">centroids</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">kmeans</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">segmentation_names</span><span class="p">)</span>
<span class="n">centroids</span><span class="o">.</span><span class="n">T</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[16]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>(REGION-CENTROID-COL,)</th>
      <td>0.25</td>
      <td>0.54</td>
      <td>0.75</td>
      <td>0.77</td>
      <td>0.30</td>
      <td>0.51</td>
      <td>0.25</td>
    </tr>
    <tr>
      <th>(REGION-CENTROID-ROW,)</th>
      <td>0.39</td>
      <td>0.15</td>
      <td>0.53</td>
      <td>0.43</td>
      <td>0.53</td>
      <td>0.81</td>
      <td>0.46</td>
    </tr>
    <tr>
      <th>(REGION-PIXEL-COUNT,)</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>(SHORT-LINE-DENSITY-5,)</th>
      <td>0.08</td>
      <td>0.03</td>
      <td>0.04</td>
      <td>0.01</td>
      <td>0.05</td>
      <td>0.08</td>
      <td>0.03</td>
    </tr>
    <tr>
      <th>(SHORT-LINE-DENSITY-2,)</th>
      <td>0.02</td>
      <td>0.00</td>
      <td>0.04</td>
      <td>0.02</td>
      <td>0.05</td>
      <td>0.01</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>(VEDGE-MEAN,)</th>
      <td>0.08</td>
      <td>0.03</td>
      <td>0.11</td>
      <td>0.04</td>
      <td>0.10</td>
      <td>0.05</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>(VEDGE-SD,)</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.02</td>
      <td>0.00</td>
      <td>0.01</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>(HEDGE-MEAN,)</th>
      <td>0.06</td>
      <td>0.03</td>
      <td>0.11</td>
      <td>0.02</td>
      <td>0.08</td>
      <td>0.05</td>
      <td>0.03</td>
    </tr>
    <tr>
      <th>(HEDGE-SD,)</th>
      <td>0.01</td>
      <td>0.00</td>
      <td>0.02</td>
      <td>0.00</td>
      <td>0.01</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>(INTENSITY-MEAN,)</th>
      <td>0.15</td>
      <td>0.82</td>
      <td>0.30</td>
      <td>0.04</td>
      <td>0.40</td>
      <td>0.11</td>
      <td>0.03</td>
    </tr>
    <tr>
      <th>(RAWRED-MEAN,)</th>
      <td>0.14</td>
      <td>0.78</td>
      <td>0.28</td>
      <td>0.03</td>
      <td>0.37</td>
      <td>0.09</td>
      <td>0.02</td>
    </tr>
    <tr>
      <th>(RAWBLUE-MEAN,)</th>
      <td>0.18</td>
      <td>0.89</td>
      <td>0.35</td>
      <td>0.06</td>
      <td>0.47</td>
      <td>0.09</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>(RAWGREEN-MEAN,)</th>
      <td>0.12</td>
      <td>0.79</td>
      <td>0.26</td>
      <td>0.03</td>
      <td>0.35</td>
      <td>0.14</td>
      <td>0.02</td>
    </tr>
    <tr>
      <th>(EXRED-MEAN,)</th>
      <td>0.72</td>
      <td>0.27</td>
      <td>0.59</td>
      <td>0.78</td>
      <td>0.50</td>
      <td>0.68</td>
      <td>0.77</td>
    </tr>
    <tr>
      <th>(EXBLUE-MEAN,)</th>
      <td>0.34</td>
      <td>0.67</td>
      <td>0.45</td>
      <td>0.22</td>
      <td>0.57</td>
      <td>0.08</td>
      <td>0.22</td>
    </tr>
    <tr>
      <th>(EXGREEN-MEAN,)</th>
      <td>0.35</td>
      <td>0.29</td>
      <td>0.31</td>
      <td>0.49</td>
      <td>0.21</td>
      <td>0.82</td>
      <td>0.51</td>
    </tr>
    <tr>
      <th>(VALUE-MEAN,)</th>
      <td>0.18</td>
      <td>0.89</td>
      <td>0.35</td>
      <td>0.06</td>
      <td>0.47</td>
      <td>0.13</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>(SATURATION-MEAN,)</th>
      <td>0.41</td>
      <td>0.21</td>
      <td>0.30</td>
      <td>0.54</td>
      <td>0.30</td>
      <td>0.41</td>
      <td>0.80</td>
    </tr>
    <tr>
      <th>(HUE-MEAN,)</th>
      <td>0.20</td>
      <td>0.13</td>
      <td>0.16</td>
      <td>0.24</td>
      <td>0.16</td>
      <td>0.89</td>
      <td>0.18</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[17]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">cluster_sizes</span><span class="p">(</span><span class="n">clusters</span><span class="p">):</span>  
    <span class="n">size</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">cluster_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">clusters</span><span class="p">)</span>
    <span class="n">n_clusters</span> <span class="o">=</span> <span class="n">cluster_labels</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cluster_labels</span><span class="p">:</span>
        <span class="n">size</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">segmentation_data_norm</span><span class="p">[</span><span class="n">clusters</span> <span class="o">==</span> <span class="n">c</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">size</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[18]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">size</span> <span class="o">=</span> <span class="n">cluster_sizes</span><span class="p">(</span><span class="n">clusters</span><span class="p">)</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">size</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Size of Cluster&quot;</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s2">&quot;= &quot;</span><span class="p">,</span> <span class="n">size</span><span class="p">[</span><span class="n">c</span><span class="p">])</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Size of Cluster 0 =  336
Size of Cluster 1 =  300
Size of Cluster 2 =  332
Size of Cluster 3 =  309
Size of Cluster 4 =  236
Size of Cluster 5 =  297
Size of Cluster 6 =  290
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[19]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Performing the Silhouette analysis on the clusters</span>
<span class="n">silhouettes</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">silhouette_samples</span><span class="p">(</span><span class="n">segmentation_data_norm</span><span class="p">,</span> <span class="n">clusters</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">silhouettes</span><span class="p">[:</span><span class="mi">20</span><span class="p">])</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>[0.5723009  0.56096434 0.46537332 0.49555343 0.57184728 0.55971567
 0.54254115 0.41198301 0.52007116 0.46772731 0.48697578 0.49143895
 0.58398756 0.5624969  0.37898897 0.53116773 0.5484396  0.42267617
 0.41603628 0.40351227]
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[20]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">silhouettes</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>0.3320233761933512
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[21]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">plot_silhouettes</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">clusters</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;euclidean&#39;</span><span class="p">):</span>
<span class="c1">#Importing the necessary packages to run</span>
    <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span>
    <span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">silhouette_samples</span>
    <span class="n">cluster_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">clusters</span><span class="p">)</span>
    <span class="n">n_clusters</span> <span class="o">=</span> <span class="n">cluster_labels</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">silhouette_vals</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">silhouette_samples</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">clusters</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;euclidean&#39;</span><span class="p">)</span>
    <span class="n">c_ax_lower</span><span class="p">,</span> <span class="n">c_ax_upper</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
    <span class="n">cticks</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cluster_labels</span><span class="p">):</span>
        <span class="n">c_silhouette_vals</span> <span class="o">=</span> <span class="n">silhouette_vals</span><span class="p">[</span><span class="n">clusters</span> <span class="o">==</span> <span class="n">k</span><span class="p">]</span>
        <span class="n">c_silhouette_vals</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">c_ax_upper</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">c_silhouette_vals</span><span class="p">)</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">/</span> <span class="n">n_clusters</span><span class="p">)</span>
        <span class="n">pl</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">c_ax_lower</span><span class="p">,</span> <span class="n">c_ax_upper</span><span class="p">),</span> <span class="n">c_silhouette_vals</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> 
                      <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
        <span class="n">cticks</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">c_ax_lower</span> <span class="o">+</span> <span class="n">c_ax_upper</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">c_ax_lower</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">c_silhouette_vals</span><span class="p">)</span>
    <span class="n">silhouette_avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">silhouette_vals</span><span class="p">)</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">silhouette_avg</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span> 
    <span class="n">pl</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">cticks</span><span class="p">,</span> <span class="n">cluster_labels</span><span class="p">)</span>
<span class="c1">#Title for X and Y labels</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Cluster&#39;</span><span class="p">)</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Silhouette coefficient&#39;</span><span class="p">)</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="c1">#Plotting the silhoutte scores</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">return</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[22]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Plotting the silhoutte scores</span>
<span class="n">plot_silhouettes</span><span class="p">(</span><span class="n">segmentation_data_norm</span><span class="p">,</span> <span class="n">clusters</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://" class="jp-needs-light-background"/>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[23]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Importing the packages and running it</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">completeness_score</span><span class="p">,</span> <span class="n">homogeneity_score</span>
<span class="c1">#Calculating the Completeness Score of the clusters</span>
<span class="c1">#Calculating the homogeneity Score of the clusters</span>
<span class="n">Completeness</span> <span class="o">=</span> <span class="n">completeness_score</span><span class="p">(</span><span class="n">segmentation_class</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">clusters</span><span class="p">)</span>
<span class="n">Homogeneity</span> <span class="o">=</span> <span class="n">homogeneity_score</span><span class="p">(</span><span class="n">segmentation_class</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">clusters</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Completeness score is </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Completeness</span><span class="p">))</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Homogeneity score is </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Homogeneity</span><span class="p">))</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Completeness score is 0.6116744999910891
Homogeneity score is 0.6099656393147241
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>c. [10 pts] Do your own experiments with the number of clusters to see if a different value of K results in more cohesive clustering based on Silhouette analysis. Please do not provide all your clustering results, but you should include the best result according to your analysis and provide a brief discussion of why this particular clustering was selected.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[24]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#K value is found</span>
<span class="n">range_n_clusters</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">silhouette_avg</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">num_clusters</span> <span class="ow">in</span> <span class="n">range_n_clusters</span><span class="p">:</span>
 <span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">num_clusters</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1">#Fitting the K-Means</span>
 <span class="n">kmeans</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">segmentation_data_norm</span><span class="p">)</span>
 <span class="n">cluster_labels</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">labels_</span>
<span class="c1">#Silhoutte samples (scores)</span>
 <span class="n">silhouette_samples</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">silhouette_samples</span><span class="p">(</span><span class="n">segmentation_data_norm</span><span class="p">,</span> <span class="n">cluster_labels</span><span class="p">)</span>
 <span class="n">silhouette_avg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">silhouette_samples</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>C:\Users\admin\AppData\Roaming\Python\Python39\site-packages\sklearn\cluster\_kmeans.py:1334: UserWarning: KMeans is known to have a memory leak on Windows with MKL, when there are less chunks than available threads. You can avoid it by setting the environment variable OMP_NUM_THREADS=9.
  warnings.warn(
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Initialization complete
Iteration 0, inertia 1663.5348424236975.
Iteration 1, inertia 931.9429386486809.
Iteration 2, inertia 930.6119049593497.
Iteration 3, inertia 929.8662020766086.
Iteration 4, inertia 929.5081799320824.
Iteration 5, inertia 929.4470780547612.
Iteration 6, inertia 929.3975471426347.
Iteration 7, inertia 929.3835670676499.
Converged at iteration 7: strict convergence.
Initialization complete
Iteration 0, inertia 1351.6025647967867.
Iteration 1, inertia 930.451441401957.
Iteration 2, inertia 929.5707225834046.
Iteration 3, inertia 929.4470780547612.
Iteration 4, inertia 929.3975471426345.
Iteration 5, inertia 929.3835670676499.
Converged at iteration 5: strict convergence.
Initialization complete
Iteration 0, inertia 2195.272431314921.
Iteration 1, inertia 1360.1785397199515.
Iteration 2, inertia 1140.3668435641366.
Iteration 3, inertia 960.9252743669286.
Iteration 4, inertia 941.1765845211594.
Iteration 5, inertia 935.9384581388582.
Iteration 6, inertia 933.7329626846981.
Iteration 7, inertia 932.8138682642544.
Iteration 8, inertia 932.4407810240457.
Iteration 9, inertia 932.3773530222218.
Iteration 10, inertia 932.3568967464735.
Iteration 11, inertia 932.3488802124061.
Iteration 12, inertia 932.3380278365588.
Iteration 13, inertia 932.3284797601716.
Iteration 14, inertia 932.2966317145518.
Iteration 15, inertia 932.2280350473079.
Iteration 16, inertia 932.0989098714597.
Iteration 17, inertia 931.9401455717718.
Iteration 18, inertia 931.8042265518552.
Iteration 19, inertia 931.5485171145804.
Iteration 20, inertia 930.9437346472084.
Iteration 21, inertia 930.2097068198007.
Iteration 22, inertia 929.6256034274234.
Iteration 23, inertia 929.4730166376488.
Iteration 24, inertia 929.4083226520429.
Iteration 25, inertia 929.3835670676499.
Converged at iteration 25: strict convergence.
Initialization complete
Iteration 0, inertia 1549.14657220125.
Iteration 1, inertia 1346.1942986748695.
Iteration 2, inertia 1334.4212573784894.
Iteration 3, inertia 1280.1240595867584.
Iteration 4, inertia 1117.5749394917916.
Iteration 5, inertia 1008.2644924840735.
Iteration 6, inertia 950.5190213495692.
Iteration 7, inertia 939.6050863140238.
Iteration 8, inertia 935.4513645581081.
Iteration 9, inertia 933.5924825678304.
Iteration 10, inertia 932.6440656566838.
Iteration 11, inertia 932.4407810240455.
Iteration 12, inertia 932.3773530222218.
Iteration 13, inertia 932.3568967464737.
Iteration 14, inertia 932.3488802124062.
Iteration 15, inertia 932.3380278365588.
Iteration 16, inertia 932.3284797601717.
Iteration 17, inertia 932.2966317145518.
Iteration 18, inertia 932.228035047308.
Iteration 19, inertia 932.0989098714597.
Iteration 20, inertia 931.9401455717718.
Iteration 21, inertia 931.8042265518552.
Iteration 22, inertia 931.5485171145804.
Iteration 23, inertia 930.9437346472084.
Iteration 24, inertia 930.2097068198008.
Iteration 25, inertia 929.6256034274234.
Iteration 26, inertia 929.4730166376489.
Iteration 27, inertia 929.4083226520429.
Iteration 28, inertia 929.3835670676499.
Converged at iteration 28: strict convergence.
Initialization complete
Iteration 0, inertia 1630.5202163479971.
Iteration 1, inertia 930.6443052107976.
Iteration 2, inertia 930.4041707183944.
Iteration 3, inertia 930.3882226255972.
Iteration 4, inertia 930.3630843909344.
Iteration 5, inertia 930.3422373420779.
Iteration 6, inertia 930.3384592949586.
Converged at iteration 6: strict convergence.
Initialization complete
Iteration 0, inertia 1761.972224320848.
Iteration 1, inertia 930.5908359260178.
Iteration 2, inertia 930.4219067190145.
Iteration 3, inertia 930.3948098520001.
Iteration 4, inertia 930.3816713076133.
Iteration 5, inertia 930.3630843909344.
Iteration 6, inertia 930.3422373420779.
Iteration 7, inertia 930.3384592949584.
Converged at iteration 7: strict convergence.
Initialization complete
Iteration 0, inertia 1627.4223981124783.
Iteration 1, inertia 932.6523341247904.
Iteration 2, inertia 930.2120271493084.
Iteration 3, inertia 929.3803913033058.
Iteration 4, inertia 929.1351556044611.
Iteration 5, inertia 928.9187044036768.
Iteration 6, inertia 928.7771269688438.
Iteration 7, inertia 928.7344759732475.
Iteration 8, inertia 928.7273079899178.
Iteration 9, inertia 928.7223313208366.
Iteration 10, inertia 928.7201323314196.
Converged at iteration 10: strict convergence.
Initialization complete
Iteration 0, inertia 1713.3762167456218.
Iteration 1, inertia 1131.4168654842356.
Iteration 2, inertia 1011.6638912087664.
Iteration 3, inertia 950.7980177822335.
Iteration 4, inertia 939.6936970299505.
Iteration 5, inertia 935.5131997484383.
Iteration 6, inertia 933.5924825678304.
Iteration 7, inertia 932.6440656566838.
Iteration 8, inertia 932.4407810240455.
Iteration 9, inertia 932.3773530222218.
Iteration 10, inertia 932.3568967464737.
Iteration 11, inertia 932.3488802124064.
Iteration 12, inertia 932.3380278365588.
Iteration 13, inertia 932.3284797601716.
Iteration 14, inertia 932.2966317145518.
Iteration 15, inertia 932.2280350473079.
Iteration 16, inertia 932.0989098714598.
Iteration 17, inertia 931.9401455717718.
Iteration 18, inertia 931.8042265518551.
Iteration 19, inertia 931.5485171145802.
Iteration 20, inertia 930.9437346472085.
Iteration 21, inertia 930.2097068198009.
Iteration 22, inertia 929.6256034274234.
Iteration 23, inertia 929.4730166376488.
Iteration 24, inertia 929.4083226520429.
Iteration 25, inertia 929.3835670676499.
Converged at iteration 25: strict convergence.
Initialization complete
Iteration 0, inertia 1381.3252652252534.
Iteration 1, inertia 930.4879992588778.
Iteration 2, inertia 929.4499495823811.
Iteration 3, inertia 929.3975471426347.
Iteration 4, inertia 929.3835670676499.
Converged at iteration 4: strict convergence.
Initialization complete
Iteration 0, inertia 1686.472702225496.
Iteration 1, inertia 996.7375126416787.
Iteration 2, inertia 939.9532319325962.
Iteration 3, inertia 935.4732470636388.
Iteration 4, inertia 933.5924825678304.
Iteration 5, inertia 932.6440656566838.
Iteration 6, inertia 932.4407810240455.
Iteration 7, inertia 932.3773530222218.
Iteration 8, inertia 932.3568967464738.
Iteration 9, inertia 932.3488802124064.
Iteration 10, inertia 932.3380278365588.
Iteration 11, inertia 932.3284797601716.
Iteration 12, inertia 932.2966317145518.
Iteration 13, inertia 932.2280350473079.
Iteration 14, inertia 932.0989098714597.
Iteration 15, inertia 931.9401455717718.
Iteration 16, inertia 931.8042265518552.
Iteration 17, inertia 931.5485171145804.
Iteration 18, inertia 930.9437346472085.
Iteration 19, inertia 930.2097068198009.
Iteration 20, inertia 929.6256034274234.
Iteration 21, inertia 929.4730166376488.
Iteration 22, inertia 929.4083226520429.
Iteration 23, inertia 929.3835670676499.
Converged at iteration 23: strict convergence.
Initialization complete
Iteration 0, inertia 1158.328191482873.
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>C:\Users\admin\AppData\Roaming\Python\Python39\site-packages\sklearn\cluster\_kmeans.py:1334: UserWarning: KMeans is known to have a memory leak on Windows with MKL, when there are less chunks than available threads. You can avoid it by setting the environment variable OMP_NUM_THREADS=9.
  warnings.warn(
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Iteration 1, inertia 682.7642736844665.
Iteration 2, inertia 677.5020299332017.
Iteration 3, inertia 677.2581211207973.
Iteration 4, inertia 677.2495213881522.
Iteration 5, inertia 677.226879670261.
Iteration 6, inertia 677.1670463094293.
Iteration 7, inertia 677.1462848302875.
Iteration 8, inertia 677.1124863271762.
Iteration 9, inertia 677.0637063092317.
Iteration 10, inertia 677.0212315201688.
Iteration 11, inertia 676.9815433955646.
Iteration 12, inertia 676.9608629944317.
Iteration 13, inertia 676.9525471260584.
Converged at iteration 13: center shift 2.1745698435405196e-06 within tolerance 4.150156953284628e-06.
Initialization complete
Iteration 0, inertia 874.9727435442092.
Iteration 1, inertia 703.7378701424477.
Iteration 2, inertia 702.7270411114004.
Iteration 3, inertia 702.6754664136979.
Iteration 4, inertia 702.6722171136829.
Converged at iteration 4: strict convergence.
Initialization complete
Iteration 0, inertia 1110.615607468194.
Iteration 1, inertia 803.6796208106836.
Iteration 2, inertia 779.4632465057028.
Iteration 3, inertia 766.1113172202778.
Iteration 4, inertia 762.155044262247.
Iteration 5, inertia 761.0852388995313.
Iteration 6, inertia 760.8323309145121.
Iteration 7, inertia 760.8076292977363.
Converged at iteration 7: center shift 1.4639575774399405e-06 within tolerance 4.150156953284628e-06.
Initialization complete
Iteration 0, inertia 1171.6689486534708.
Iteration 1, inertia 709.8121258636978.
Iteration 2, inertia 702.7253428650994.
Iteration 3, inertia 702.6830282701651.
Iteration 4, inertia 702.6722006080688.
Converged at iteration 4: strict convergence.
Initialization complete
Iteration 0, inertia 1034.7478616537908.
Iteration 1, inertia 692.8775264177993.
Iteration 2, inertia 678.5483846707679.
Iteration 3, inertia 676.4330735964484.
Iteration 4, inertia 676.2063134925816.
Iteration 5, inertia 676.1744694869307.
Iteration 6, inertia 676.1628231932239.
Converged at iteration 6: center shift 3.671658598480677e-06 within tolerance 4.150156953284628e-06.
Initialization complete
Iteration 0, inertia 1201.4758065762276.
Iteration 1, inertia 722.303480373036.
Iteration 2, inertia 720.5557647593605.
Iteration 3, inertia 719.2011794146031.
Iteration 4, inertia 717.1391077776603.
Iteration 5, inertia 714.5573108521304.
Iteration 6, inertia 711.098712565681.
Iteration 7, inertia 706.5182960310727.
Iteration 8, inertia 704.0060349835447.
Iteration 9, inertia 703.0606423648434.
Iteration 10, inertia 702.8062466308066.
Iteration 11, inertia 702.7214997040801.
Iteration 12, inertia 702.6830282701652.
Iteration 13, inertia 702.6722006080688.
Converged at iteration 13: strict convergence.
Initialization complete
Iteration 0, inertia 1276.0852897879563.
Iteration 1, inertia 776.665937318888.
Iteration 2, inertia 713.521764437718.
Iteration 3, inertia 680.4360875207955.
Iteration 4, inertia 677.5795706739541.
Iteration 5, inertia 676.931121325028.
Iteration 6, inertia 676.8042211368883.
Iteration 7, inertia 676.6888010540115.
Iteration 8, inertia 676.5792992486041.
Iteration 9, inertia 676.4905550107657.
Iteration 10, inertia 676.3158313851427.
Iteration 11, inertia 676.194204962176.
Iteration 12, inertia 676.1617646279904.
Iteration 13, inertia 676.1538610160188.
Converged at iteration 13: strict convergence.
Initialization complete
Iteration 0, inertia 989.7194396494007.
Iteration 1, inertia 785.0277859287545.
Iteration 2, inertia 758.942637420924.
Iteration 3, inertia 706.5608395070844.
Iteration 4, inertia 678.5666235005327.
Iteration 5, inertia 677.2537304132778.
Iteration 6, inertia 676.8852006729052.
Iteration 7, inertia 676.8042211368883.
Iteration 8, inertia 676.6888010540115.
Iteration 9, inertia 676.5792992486041.
Iteration 10, inertia 676.4905550107657.
Iteration 11, inertia 676.3158313851428.
Iteration 12, inertia 676.194204962176.
Iteration 13, inertia 676.1617646279905.
Iteration 14, inertia 676.1538610160188.
Converged at iteration 14: strict convergence.
Initialization complete
Iteration 0, inertia 1109.6283258123715.
Iteration 1, inertia 731.4379770670321.
Iteration 2, inertia 681.6821920968948.
Iteration 3, inertia 677.1326434181833.
Iteration 4, inertia 676.2780959188973.
Iteration 5, inertia 676.1835556156268.
Iteration 6, inertia 676.1648386506225.
Converged at iteration 6: center shift 2.902182048549315e-06 within tolerance 4.150156953284628e-06.
Initialization complete
Iteration 0, inertia 1314.1410861557213.
Iteration 1, inertia 703.9511406324879.
Iteration 2, inertia 680.2275430500346.
Iteration 3, inertia 677.8449327450858.
Iteration 4, inertia 677.3457966073674.
Iteration 5, inertia 677.2793302636888.
Iteration 6, inertia 677.2698232296437.
Converged at iteration 6: center shift 3.956212907160323e-06 within tolerance 4.150156953284628e-06.
Initialization complete
Iteration 0, inertia 641.5176211691116.
Iteration 1, inertia 488.0973034613249.
Iteration 2, inertia 486.9338429546226.
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>C:\Users\admin\AppData\Roaming\Python\Python39\site-packages\sklearn\cluster\_kmeans.py:1334: UserWarning: KMeans is known to have a memory leak on Windows with MKL, when there are less chunks than available threads. You can avoid it by setting the environment variable OMP_NUM_THREADS=9.
  warnings.warn(
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Iteration 3, inertia 486.85696043430596.
Converged at iteration 3: center shift 7.803912474555859e-07 within tolerance 4.150156953284628e-06.
Initialization complete
Iteration 0, inertia 873.7371463659607.
Iteration 1, inertia 615.0590649490648.
Iteration 2, inertia 588.7907016295025.
Iteration 3, inertia 549.056395560388.
Iteration 4, inertia 496.5843780106652.
Iteration 5, inertia 487.0723270173129.
Iteration 6, inertia 486.86165439735714.
Iteration 7, inertia 486.85624011499397.
Converged at iteration 7: center shift 3.218360585369225e-06 within tolerance 4.150156953284628e-06.
Initialization complete
Iteration 0, inertia 830.6420592768416.
Iteration 1, inertia 508.15693598432256.
Iteration 2, inertia 487.88690110479456.
Iteration 3, inertia 486.91074285455346.
Iteration 4, inertia 486.84807384665316.
Iteration 5, inertia 486.845131291644.
Converged at iteration 5: strict convergence.
Initialization complete
Iteration 0, inertia 741.201664333235.
Iteration 1, inertia 517.564032691291.
Iteration 2, inertia 494.6855905783194.
Iteration 3, inertia 488.2931945800784.
Iteration 4, inertia 487.0023285476825.
Iteration 5, inertia 486.86522541452536.
Iteration 6, inertia 486.85696043430596.
Converged at iteration 6: center shift 7.803912474556369e-07 within tolerance 4.150156953284628e-06.
Initialization complete
Iteration 0, inertia 751.221675462438.
Iteration 1, inertia 487.2546778534519.
Iteration 2, inertia 486.8652254145254.
Iteration 3, inertia 486.85696043430596.
Converged at iteration 3: center shift 7.803912474556791e-07 within tolerance 4.150156953284628e-06.
Initialization complete
Iteration 0, inertia 819.833288051499.
Iteration 1, inertia 488.18933117869443.
Iteration 2, inertia 486.9961841772527.
Iteration 3, inertia 486.91844935268944.
Iteration 4, inertia 486.87348839708824.
Iteration 5, inertia 486.84411638945363.
Iteration 6, inertia 486.84117407848083.
Converged at iteration 6: strict convergence.
Initialization complete
Iteration 0, inertia 952.5255693445964.
Iteration 1, inertia 562.033197541986.
Iteration 2, inertia 545.4530824332949.
Iteration 3, inertia 511.6300126446343.
Iteration 4, inertia 489.08292990779063.
Iteration 5, inertia 486.86510657707197.
Iteration 6, inertia 486.84513129164407.
Converged at iteration 6: strict convergence.
Initialization complete
Iteration 0, inertia 980.0146144516873.
Iteration 1, inertia 527.4565399492868.
Iteration 2, inertia 493.0896593529667.
Iteration 3, inertia 487.3740671631858.
Iteration 4, inertia 486.91196670088823.
Iteration 5, inertia 486.84474541668476.
Iteration 6, inertia 486.8411740784809.
Converged at iteration 6: strict convergence.
Initialization complete
Iteration 0, inertia 832.4374866287734.
Iteration 1, inertia 514.5278321165644.
Iteration 2, inertia 490.08122952975623.
Iteration 3, inertia 487.20897762585975.
Iteration 4, inertia 486.9541035144761.
Iteration 5, inertia 486.86610251277585.
Iteration 6, inertia 486.84411638945363.
Iteration 7, inertia 486.84117407848083.
Converged at iteration 7: strict convergence.
Initialization complete
Iteration 0, inertia 836.6160076073857.
Iteration 1, inertia 488.54733799043123.
Iteration 2, inertia 486.97433714761473.
Iteration 3, inertia 486.8621069876608.
Iteration 4, inertia 486.85624011499397.
Converged at iteration 4: center shift 3.2183605853691416e-06 within tolerance 4.150156953284628e-06.
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>C:\Users\admin\AppData\Roaming\Python\Python39\site-packages\sklearn\cluster\_kmeans.py:1334: UserWarning: KMeans is known to have a memory leak on Windows with MKL, when there are less chunks than available threads. You can avoid it by setting the environment variable OMP_NUM_THREADS=9.
  warnings.warn(
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Initialization complete
Iteration 0, inertia 708.3968320160058.
Iteration 1, inertia 445.4746951456626.
Iteration 2, inertia 440.598510769819.
Iteration 3, inertia 440.08968057619404.
Iteration 4, inertia 439.17498986319055.
Iteration 5, inertia 438.5408174637484.
Iteration 6, inertia 437.92264941236033.
Iteration 7, inertia 437.4737035256568.
Iteration 8, inertia 436.91834037389.
Iteration 9, inertia 435.87781812292394.
Iteration 10, inertia 435.50073388300757.
Iteration 11, inertia 435.48230392500574.
Iteration 12, inertia 435.47662337922935.
Iteration 13, inertia 435.4593215200993.
Iteration 14, inertia 435.4189800065208.
Iteration 15, inertia 435.38612562502533.
Iteration 16, inertia 435.3793271545368.
Converged at iteration 16: center shift 2.187903194066693e-06 within tolerance 4.150156953284628e-06.
Initialization complete
Iteration 0, inertia 837.167893563578.
Iteration 1, inertia 446.42520632439454.
Iteration 2, inertia 434.3043101545909.
Iteration 3, inertia 431.0699634852701.
Iteration 4, inertia 430.2583632496001.
Iteration 5, inertia 430.0165891334332.
Iteration 6, inertia 429.92649412363545.
Iteration 7, inertia 429.9043399592452.
Iteration 8, inertia 429.8736082044669.
Iteration 9, inertia 429.84376434853743.
Iteration 10, inertia 429.79923729930385.
Iteration 11, inertia 429.79037798299606.
Iteration 12, inertia 429.7861421266146.
Iteration 13, inertia 429.7814933376835.
Converged at iteration 13: center shift 2.950318599532316e-06 within tolerance 4.150156953284628e-06.
Initialization complete
Iteration 0, inertia 694.4686522730387.
Iteration 1, inertia 573.8237779745579.
Iteration 2, inertia 524.8511955117996.
Iteration 3, inertia 468.92810317077397.
Iteration 4, inertia 453.8911096062154.
Iteration 5, inertia 450.3371487342089.
Iteration 6, inertia 448.3434738448937.
Iteration 7, inertia 446.405446871082.
Iteration 8, inertia 443.00883517244154.
Iteration 9, inertia 437.3234661294145.
Iteration 10, inertia 435.7944307145233.
Iteration 11, inertia 435.0936932655332.
Iteration 12, inertia 434.263945424145.
Iteration 13, inertia 433.7852444459348.
Iteration 14, inertia 433.47524103354243.
Iteration 15, inertia 433.2016686112637.
Iteration 16, inertia 433.0677784609829.
Iteration 17, inertia 432.99143448117485.
Iteration 18, inertia 432.9275009133971.
Iteration 19, inertia 432.87850461268454.
Iteration 20, inertia 432.84877611908496.
Iteration 21, inertia 432.79622396003856.
Iteration 22, inertia 432.6736783211653.
Iteration 23, inertia 432.56148044289716.
Iteration 24, inertia 432.5372112092611.
Iteration 25, inertia 432.4716928311605.
Iteration 26, inertia 432.3257260369991.
Iteration 27, inertia 432.0096123102931.
Iteration 28, inertia 431.52333621537684.
Iteration 29, inertia 430.8693969737271.
Iteration 30, inertia 430.3564553971779.
Iteration 31, inertia 430.0521745555623.
Iteration 32, inertia 429.949903080692.
Iteration 33, inertia 429.9043399592452.
Iteration 34, inertia 429.8736082044669.
Iteration 35, inertia 429.8437643485375.
Iteration 36, inertia 429.79923729930385.
Iteration 37, inertia 429.79037798299606.
Iteration 38, inertia 429.78614212661466.
Iteration 39, inertia 429.78149333768346.
Converged at iteration 39: center shift 2.9503185995320885e-06 within tolerance 4.150156953284628e-06.
Initialization complete
Iteration 0, inertia 748.2174265076361.
Iteration 1, inertia 454.997173870588.
Iteration 2, inertia 430.26106426327.
Iteration 3, inertia 428.74825136562504.
Iteration 4, inertia 428.5814112769201.
Iteration 5, inertia 428.5459066778657.
Converged at iteration 5: center shift 1.1587834734938428e-06 within tolerance 4.150156953284628e-06.
Initialization complete
Iteration 0, inertia 815.3404396386459.
Iteration 1, inertia 489.4291582231494.
Iteration 2, inertia 471.61001501264855.
Iteration 3, inertia 470.24577837434964.
Iteration 4, inertia 469.86362958720883.
Iteration 5, inertia 469.8358047501822.
Converged at iteration 5: strict convergence.
Initialization complete
Iteration 0, inertia 854.4466553153077.
Iteration 1, inertia 526.913049768116.
Iteration 2, inertia 478.93138042883976.
Iteration 3, inertia 466.4701034577723.
Iteration 4, inertia 461.05559785119306.
Iteration 5, inertia 457.58353794629727.
Iteration 6, inertia 455.0744500479471.
Iteration 7, inertia 450.5311438318288.
Iteration 8, inertia 445.7151915519429.
Iteration 9, inertia 444.64186729104364.
Iteration 10, inertia 444.4464388702813.
Iteration 11, inertia 444.4425350218322.
Converged at iteration 11: center shift 1.4680207616667858e-06 within tolerance 4.150156953284628e-06.
Initialization complete
Iteration 0, inertia 788.0770661458946.
Iteration 1, inertia 444.2097450853807.
Iteration 2, inertia 440.9074559038716.
Iteration 3, inertia 440.42906453031486.
Iteration 4, inertia 440.3486756066396.
Iteration 5, inertia 440.3360307582626.
Iteration 6, inertia 440.32751354437045.
Converged at iteration 6: center shift 1.1490390304854713e-06 within tolerance 4.150156953284628e-06.
Initialization complete
Iteration 0, inertia 676.536432737166.
Iteration 1, inertia 459.3065086522068.
Iteration 2, inertia 450.7698598386341.
Iteration 3, inertia 446.15420923062476.
Iteration 4, inertia 445.21849818538925.
Iteration 5, inertia 444.6042472793082.
Iteration 6, inertia 444.47479070334373.
Iteration 7, inertia 444.4522630319948.
Iteration 8, inertia 444.44221580734705.
Converged at iteration 8: center shift 3.852047391917286e-06 within tolerance 4.150156953284628e-06.
Initialization complete
Iteration 0, inertia 678.8653511365409.
Iteration 1, inertia 457.2779703984978.
Iteration 2, inertia 446.1277469227112.
Iteration 3, inertia 442.2093712163294.
Iteration 4, inertia 438.1611605381403.
Iteration 5, inertia 434.72205682326796.
Iteration 6, inertia 432.01629054666205.
Iteration 7, inertia 430.58849522874135.
Iteration 8, inertia 429.5387955457659.
Iteration 9, inertia 428.9187191044457.
Iteration 10, inertia 428.71065803737775.
Iteration 11, inertia 428.60644676968315.
Iteration 12, inertia 428.56658525545834.
Iteration 13, inertia 428.543978158463.
Iteration 14, inertia 428.5401248736446.
Converged at iteration 14: strict convergence.
Initialization complete
Iteration 0, inertia 613.1375323835146.
Iteration 1, inertia 440.47924154477437.
Iteration 2, inertia 433.47868160056555.
Iteration 3, inertia 432.9527561645382.
Iteration 4, inertia 432.87622590115313.
Iteration 5, inertia 432.82958541177595.
Iteration 6, inertia 432.76860912490224.
Iteration 7, inertia 432.64946630404097.
Iteration 8, inertia 432.5622290172745.
Iteration 9, inertia 432.5372112092611.
Iteration 10, inertia 432.4716928311604.
Iteration 11, inertia 432.3257260369991.
Iteration 12, inertia 432.00961231029316.
Iteration 13, inertia 431.52333621537684.
Iteration 14, inertia 430.8693969737271.
Iteration 15, inertia 430.3564553971779.
Iteration 16, inertia 430.0521745555623.
Iteration 17, inertia 429.949903080692.
Iteration 18, inertia 429.9043399592452.
Iteration 19, inertia 429.8736082044669.
Iteration 20, inertia 429.8437643485374.
Iteration 21, inertia 429.79923729930385.
Iteration 22, inertia 429.79037798299606.
Iteration 23, inertia 429.7861421266146.
Iteration 24, inertia 429.78149333768346.
Converged at iteration 24: center shift 2.950318599532405e-06 within tolerance 4.150156953284628e-06.
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>C:\Users\admin\AppData\Roaming\Python\Python39\site-packages\sklearn\cluster\_kmeans.py:1334: UserWarning: KMeans is known to have a memory leak on Windows with MKL, when there are less chunks than available threads. You can avoid it by setting the environment variable OMP_NUM_THREADS=9.
  warnings.warn(
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Initialization complete
Iteration 0, inertia 550.028134604136.
Iteration 1, inertia 395.49333748671773.
Iteration 2, inertia 391.95870195259556.
Iteration 3, inertia 390.65057607147173.
Iteration 4, inertia 390.18452073332037.
Iteration 5, inertia 389.8672788242682.
Iteration 6, inertia 389.74550106648115.
Iteration 7, inertia 389.6657485508916.
Iteration 8, inertia 389.64038775200265.
Iteration 9, inertia 389.62218755558047.
Iteration 10, inertia 389.6171098447756.
Iteration 11, inertia 389.5983400743455.
Iteration 12, inertia 389.58328795305925.
Iteration 13, inertia 389.5702538717331.
Iteration 14, inertia 389.5546837381313.
Iteration 15, inertia 389.47520576030394.
Iteration 16, inertia 389.3704211889979.
Iteration 17, inertia 389.3139289319369.
Iteration 18, inertia 389.27644556234316.
Converged at iteration 18: center shift 3.7565541618652897e-06 within tolerance 4.150156953284628e-06.
Initialization complete
Iteration 0, inertia 585.5321237955469.
Iteration 1, inertia 417.5931599787837.
Iteration 2, inertia 412.9313581749402.
Iteration 3, inertia 411.5987877698523.
Iteration 4, inertia 411.0099423251458.
Iteration 5, inertia 410.8118966313882.
Iteration 6, inertia 410.7333040684517.
Iteration 7, inertia 410.6743897927762.
Iteration 8, inertia 410.56261554839443.
Iteration 9, inertia 410.4264899000227.
Iteration 10, inertia 410.36377659434345.
Iteration 11, inertia 410.302434510634.
Iteration 12, inertia 410.167969239676.
Iteration 13, inertia 409.8510403824411.
Iteration 14, inertia 409.28694126578654.
Iteration 15, inertia 408.59596564880326.
Iteration 16, inertia 408.24756413034015.
Iteration 17, inertia 408.0206646188596.
Iteration 18, inertia 407.9278547396827.
Iteration 19, inertia 407.88265533838654.
Iteration 20, inertia 407.8742479577972.
Converged at iteration 20: center shift 1.6745315220563457e-06 within tolerance 4.150156953284628e-06.
Initialization complete
Iteration 0, inertia 654.3191389454039.
Iteration 1, inertia 411.4692443706845.
Iteration 2, inertia 400.49408599392365.
Iteration 3, inertia 398.61848082439025.
Iteration 4, inertia 398.0624676257137.
Iteration 5, inertia 397.8783475780007.
Iteration 6, inertia 397.8622363362702.
Iteration 7, inertia 397.86045716141564.
Converged at iteration 7: strict convergence.
Initialization complete
Iteration 0, inertia 616.6448424939679.
Iteration 1, inertia 406.9880598434791.
Iteration 2, inertia 395.50108802468554.
Iteration 3, inertia 390.9215587598316.
Iteration 4, inertia 389.53650420564884.
Iteration 5, inertia 389.0896970363223.
Iteration 6, inertia 388.9781842395553.
Iteration 7, inertia 388.94732353623357.
Iteration 8, inertia 388.9413798721382.
Iteration 9, inertia 388.9378375771677.
Converged at iteration 9: center shift 1.2871229142960963e-06 within tolerance 4.150156953284628e-06.
Initialization complete
Iteration 0, inertia 509.45155640276164.
Iteration 1, inertia 419.22322219528024.
Iteration 2, inertia 415.96471480061444.
Iteration 3, inertia 414.469715469039.
Iteration 4, inertia 413.2556097531891.
Iteration 5, inertia 412.45603243964575.
Iteration 6, inertia 412.16909291436247.
Iteration 7, inertia 412.0411812366789.
Iteration 8, inertia 412.01589330122005.
Iteration 9, inertia 411.9972992623333.
Converged at iteration 9: strict convergence.
Initialization complete
Iteration 0, inertia 591.7246716087687.
Iteration 1, inertia 426.75106196695685.
Iteration 2, inertia 416.3318137800579.
Iteration 3, inertia 412.23447219333735.
Iteration 4, inertia 407.27778851091756.
Iteration 5, inertia 400.2715704458638.
Iteration 6, inertia 396.4427965488184.
Iteration 7, inertia 394.68081392323114.
Iteration 8, inertia 393.9191701981407.
Iteration 9, inertia 393.3631986893852.
Iteration 10, inertia 392.61623360006723.
Iteration 11, inertia 392.2472756708628.
Iteration 12, inertia 392.0209871786094.
Iteration 13, inertia 391.94298367763133.
Iteration 14, inertia 391.8974651982528.
Iteration 15, inertia 391.8738293983556.
Converged at iteration 15: strict convergence.
Initialization complete
Iteration 0, inertia 563.99660925294.
Iteration 1, inertia 425.91037185929264.
Iteration 2, inertia 417.68215221950385.
Iteration 3, inertia 416.17519044247143.
Iteration 4, inertia 415.71766909872576.
Iteration 5, inertia 415.5906737529375.
Iteration 6, inertia 415.5193626656133.
Iteration 7, inertia 415.46032851763715.
Iteration 8, inertia 415.41080631551307.
Iteration 9, inertia 415.3523831967311.
Iteration 10, inertia 415.2678434932199.
Iteration 11, inertia 415.18898216013497.
Iteration 12, inertia 415.1487838154493.
Iteration 13, inertia 415.13927898661075.
Iteration 14, inertia 415.0849306105119.
Iteration 15, inertia 414.99359448184373.
Iteration 16, inertia 414.67489252601007.
Iteration 17, inertia 414.1755532623157.
Iteration 18, inertia 413.5759404837192.
Iteration 19, inertia 413.1135057102121.
Iteration 20, inertia 412.6948374981674.
Iteration 21, inertia 412.566329582849.
Iteration 22, inertia 412.51684234073.
Iteration 23, inertia 412.4885955765902.
Iteration 24, inertia 412.4583330294645.
Iteration 25, inertia 412.4112495811112.
Iteration 26, inertia 412.40239026480344.
Iteration 27, inertia 412.39843531365756.
Converged at iteration 27: center shift 3.6129419327243138e-06 within tolerance 4.150156953284628e-06.
Initialization complete
Iteration 0, inertia 659.6076225153819.
Iteration 1, inertia 436.1234097498254.
Iteration 2, inertia 415.3840125337488.
Iteration 3, inertia 411.40586447975375.
Iteration 4, inertia 409.9487347219669.
Iteration 5, inertia 409.38011359091144.
Iteration 6, inertia 409.0037686910854.
Iteration 7, inertia 408.7324921817368.
Iteration 8, inertia 408.58028840398845.
Iteration 9, inertia 408.3933406541771.
Iteration 10, inertia 408.2336882860991.
Iteration 11, inertia 408.12342750696905.
Iteration 12, inertia 408.0755055455153.
Iteration 13, inertia 408.03707725132017.
Iteration 14, inertia 408.02116206376036.
Iteration 15, inertia 408.0142877989472.
Converged at iteration 15: center shift 3.934853645498945e-06 within tolerance 4.150156953284628e-06.
Initialization complete
Iteration 0, inertia 533.6666924678447.
Iteration 1, inertia 394.96673684982676.
Iteration 2, inertia 389.95265498926994.
Iteration 3, inertia 389.2946007367221.
Iteration 4, inertia 389.04578215662286.
Iteration 5, inertia 388.9688249318658.
Iteration 6, inertia 388.95203951659744.
Iteration 7, inertia 388.9484828649909.
Converged at iteration 7: strict convergence.
Initialization complete
Iteration 0, inertia 710.4443145064021.
Iteration 1, inertia 500.0825355948934.
Iteration 2, inertia 439.9599309111591.
Iteration 3, inertia 422.1560952821608.
Iteration 4, inertia 419.3589211388878.
Iteration 5, inertia 417.99974904810637.
Iteration 6, inertia 417.16579415348207.
Iteration 7, inertia 416.5847099230891.
Iteration 8, inertia 415.85226175543613.
Iteration 9, inertia 415.2907282064249.
Iteration 10, inertia 415.1232163850368.
Iteration 11, inertia 415.0411950822726.
Iteration 12, inertia 414.9804087863015.
Iteration 13, inertia 414.94756949156823.
Iteration 14, inertia 414.9163416591306.
Iteration 15, inertia 414.8692754125307.
Iteration 16, inertia 414.7567702113431.
Iteration 17, inertia 414.6445723330751.
Iteration 18, inertia 414.62030309943896.
Iteration 19, inertia 414.5547847213383.
Iteration 20, inertia 414.40881792717704.
Iteration 21, inertia 414.0927042004711.
Iteration 22, inertia 413.6064281055549.
Iteration 23, inertia 412.95248886390493.
Iteration 24, inertia 412.4395472873558.
Iteration 25, inertia 412.13526644574034.
Iteration 26, inertia 412.03299497086994.
Iteration 27, inertia 411.9874318494231.
Iteration 28, inertia 411.9567000946448.
Iteration 29, inertia 411.92685623871535.
Iteration 30, inertia 411.88232918948177.
Iteration 31, inertia 411.8734698731741.
Iteration 32, inertia 411.8692340167925.
Iteration 33, inertia 411.8645852278614.
Converged at iteration 33: center shift 2.950318599532416e-06 within tolerance 4.150156953284628e-06.
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>C:\Users\admin\AppData\Roaming\Python\Python39\site-packages\sklearn\cluster\_kmeans.py:1334: UserWarning: KMeans is known to have a memory leak on Windows with MKL, when there are less chunks than available threads. You can avoid it by setting the environment variable OMP_NUM_THREADS=9.
  warnings.warn(
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Initialization complete
Iteration 0, inertia 513.3512032470427.
Iteration 1, inertia 376.3372596554453.
Iteration 2, inertia 368.9341811872792.
Iteration 3, inertia 367.3347555731443.
Iteration 4, inertia 367.03929552407465.
Iteration 5, inertia 366.9761051638492.
Iteration 6, inertia 366.9570116467999.
Iteration 7, inertia 366.9522891183732.
Iteration 8, inertia 366.94966277449987.
Converged at iteration 8: strict convergence.
Initialization complete
Iteration 0, inertia 556.5362053109758.
Iteration 1, inertia 388.53273714418714.
Iteration 2, inertia 383.1919287094628.
Iteration 3, inertia 379.6060156715949.
Iteration 4, inertia 375.65904893722285.
Iteration 5, inertia 369.3889299358727.
Iteration 6, inertia 365.5669660216637.
Iteration 7, inertia 363.08151485922434.
Iteration 8, inertia 358.0602579210988.
Iteration 9, inertia 355.1277060726354.
Iteration 10, inertia 353.5780531362414.
Iteration 11, inertia 352.8236056923115.
Iteration 12, inertia 351.7076825098565.
Iteration 13, inertia 351.2977572915959.
Iteration 14, inertia 351.1330784668076.
Iteration 15, inertia 350.872816215004.
Iteration 16, inertia 350.4285532899604.
Iteration 17, inertia 350.08487148630434.
Iteration 18, inertia 350.0385063215505.
Iteration 19, inertia 350.02186147714275.
Iteration 20, inertia 350.01547472608337.
Iteration 21, inertia 350.0129027194547.
Converged at iteration 21: strict convergence.
Initialization complete
Iteration 0, inertia 582.0505707666945.
Iteration 1, inertia 397.9178073345227.
Iteration 2, inertia 395.1726346056807.
Iteration 3, inertia 393.7481101671182.
Iteration 4, inertia 391.0060126388127.
Iteration 5, inertia 390.5777546829979.
Iteration 6, inertia 390.4997710346744.
Iteration 7, inertia 390.46935312090665.
Iteration 8, inertia 390.45171103499854.
Iteration 9, inertia 390.4371077036664.
Converged at iteration 9: strict convergence.
Initialization complete
Iteration 0, inertia 575.4058688726464.
Iteration 1, inertia 409.61430197388734.
Iteration 2, inertia 388.1869698534191.
Iteration 3, inertia 378.7476227520716.
Iteration 4, inertia 373.49065945316124.
Iteration 5, inertia 371.42619996462435.
Iteration 6, inertia 371.12607882868963.
Iteration 7, inertia 371.0387457081298.
Iteration 8, inertia 370.97980155061066.
Iteration 9, inertia 370.96026314235104.
Iteration 10, inertia 370.95729967472084.
Converged at iteration 10: strict convergence.
Initialization complete
Iteration 0, inertia 599.0843535702751.
Iteration 1, inertia 379.58102584971414.
Iteration 2, inertia 370.4593749988339.
Iteration 3, inertia 367.70973783585026.
Iteration 4, inertia 366.8524826201653.
Iteration 5, inertia 366.5416488957783.
Iteration 6, inertia 366.39774211365744.
Iteration 7, inertia 366.2522795566749.
Iteration 8, inertia 366.0187277413001.
Iteration 9, inertia 365.04084393308233.
Iteration 10, inertia 363.59452776759997.
Iteration 11, inertia 361.7069157499972.
Iteration 12, inertia 359.96400575115536.
Iteration 13, inertia 357.36534918886514.
Iteration 14, inertia 354.48217174594186.
Iteration 15, inertia 352.35398490648595.
Iteration 16, inertia 351.60911508060906.
Iteration 17, inertia 351.2965069824426.
Iteration 18, inertia 350.9507342472441.
Iteration 19, inertia 350.41938816903513.
Iteration 20, inertia 350.08674903921406.
Iteration 21, inertia 350.0401515271839.
Iteration 22, inertia 350.02186147714275.
Iteration 23, inertia 350.01547472608337.
Iteration 24, inertia 350.0129027194547.
Converged at iteration 24: strict convergence.
Initialization complete
Iteration 0, inertia 560.6346809178757.
Iteration 1, inertia 385.7903738805033.
Iteration 2, inertia 375.820761423943.
Iteration 3, inertia 373.82986026009945.
Iteration 4, inertia 373.11394549330885.
Iteration 5, inertia 372.5170952010255.
Iteration 6, inertia 372.184032578325.
Iteration 7, inertia 371.86104907767816.
Iteration 8, inertia 371.77779449212983.
Iteration 9, inertia 371.74361455119634.
Iteration 10, inertia 371.739127099525.
Converged at iteration 10: strict convergence.
Initialization complete
Iteration 0, inertia 507.8589181039906.
Iteration 1, inertia 388.1701933166193.
Iteration 2, inertia 381.4242084233877.
Iteration 3, inertia 379.54082692617044.
Iteration 4, inertia 377.3472978471478.
Iteration 5, inertia 375.3580011175326.
Iteration 6, inertia 374.1427506972044.
Iteration 7, inertia 373.050194517595.
Iteration 8, inertia 372.26694372983934.
Iteration 9, inertia 371.7271431590991.
Iteration 10, inertia 371.4968836609484.
Iteration 11, inertia 371.38308242748826.
Iteration 12, inertia 371.34369494648837.
Iteration 13, inertia 371.32798661880236.
Iteration 14, inertia 371.31868323912784.
Iteration 15, inertia 371.3162624907021.
Converged at iteration 15: strict convergence.
Initialization complete
Iteration 0, inertia 505.72096587754083.
Iteration 1, inertia 367.6366318492062.
Iteration 2, inertia 364.31260032528695.
Iteration 3, inertia 363.6973375618809.
Iteration 4, inertia 363.5246853957261.
Iteration 5, inertia 363.4312365280561.
Iteration 6, inertia 363.4186360399659.
Iteration 7, inertia 363.4107624746084.
Iteration 8, inertia 363.4068590173737.
Iteration 9, inertia 363.4007783031679.
Iteration 10, inertia 363.39664907897685.
Converged at iteration 10: strict convergence.
Initialization complete
Iteration 0, inertia 597.7342523101873.
Iteration 1, inertia 394.03857871899555.
Iteration 2, inertia 368.36891566849636.
Iteration 3, inertia 360.37060492563864.
Iteration 4, inertia 357.0568674219666.
Iteration 5, inertia 355.2615188838687.
Iteration 6, inertia 354.3068864232039.
Iteration 7, inertia 353.62225287939395.
Iteration 8, inertia 352.72648462838464.
Iteration 9, inertia 351.66851708629764.
Iteration 10, inertia 351.3761796497401.
Iteration 11, inertia 351.33820814713346.
Iteration 12, inertia 351.30144044212216.
Iteration 13, inertia 351.2762890907941.
Iteration 14, inertia 351.2370971490688.
Iteration 15, inertia 351.16104133745404.
Iteration 16, inertia 350.968561915827.
Iteration 17, inertia 350.5822530483169.
Iteration 18, inertia 350.1288909054884.
Iteration 19, inertia 350.0431591407448.
Iteration 20, inertia 350.0266720088565.
Iteration 21, inertia 350.02186147714275.
Iteration 22, inertia 350.0154747260833.
Iteration 23, inertia 350.0129027194547.
Converged at iteration 23: strict convergence.
Initialization complete
Iteration 0, inertia 483.95615532347256.
Iteration 1, inertia 386.45080474306314.
Iteration 2, inertia 378.59709384896416.
Iteration 3, inertia 376.6577054012263.
Iteration 4, inertia 376.0136567305753.
Iteration 5, inertia 375.6324310333111.
Iteration 6, inertia 375.3054372758138.
Iteration 7, inertia 374.6935617696197.
Iteration 8, inertia 373.5426297938617.
Iteration 9, inertia 371.16196443268757.
Iteration 10, inertia 369.4532561457734.
Iteration 11, inertia 369.0245215311935.
Iteration 12, inertia 368.9013170845364.
Iteration 13, inertia 368.82560998018266.
Iteration 14, inertia 368.8107175818819.
Iteration 15, inertia 368.8060794743912.
Converged at iteration 15: strict convergence.
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>C:\Users\admin\AppData\Roaming\Python\Python39\site-packages\sklearn\cluster\_kmeans.py:1334: UserWarning: KMeans is known to have a memory leak on Windows with MKL, when there are less chunks than available threads. You can avoid it by setting the environment variable OMP_NUM_THREADS=9.
  warnings.warn(
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Initialization complete
Iteration 0, inertia 470.3810003536013.
Iteration 1, inertia 359.7805219447818.
Iteration 2, inertia 344.81831885533387.
Iteration 3, inertia 334.7348500198881.
Iteration 4, inertia 332.689529106285.
Iteration 5, inertia 332.0570415668926.
Iteration 6, inertia 331.7850852030373.
Iteration 7, inertia 331.7125687892854.
Iteration 8, inertia 331.6903658622018.
Converged at iteration 8: strict convergence.
Initialization complete
Iteration 0, inertia 495.3468419721079.
Iteration 1, inertia 368.57477356329673.
Iteration 2, inertia 358.8536332629562.
Iteration 3, inertia 349.4410085670714.
Iteration 4, inertia 346.5795836430056.
Iteration 5, inertia 345.9517358916455.
Iteration 6, inertia 345.7711893344998.
Iteration 7, inertia 345.6516998100584.
Iteration 8, inertia 345.5752505568301.
Iteration 9, inertia 345.52304384690456.
Iteration 10, inertia 345.49373438196585.
Iteration 11, inertia 345.4879368028088.
Converged at iteration 11: center shift 3.2117488475673164e-06 within tolerance 4.150156953284628e-06.
Initialization complete
Iteration 0, inertia 524.7818205005802.
Iteration 1, inertia 382.0543243789232.
Iteration 2, inertia 361.28132800151667.
Iteration 3, inertia 355.1073852332515.
Iteration 4, inertia 353.88446167596084.
Iteration 5, inertia 352.716784857884.
Iteration 6, inertia 351.17575148379314.
Iteration 7, inertia 348.8552408855145.
Iteration 8, inertia 346.067857697797.
Iteration 9, inertia 343.69060344887333.
Iteration 10, inertia 340.740211944284.
Iteration 11, inertia 337.2666054766572.
Iteration 12, inertia 333.39121065846257.
Iteration 13, inertia 331.83625231144543.
Iteration 14, inertia 331.27469966731235.
Iteration 15, inertia 330.77903586379557.
Iteration 16, inertia 330.63333638318585.
Iteration 17, inertia 330.58975410670564.
Iteration 18, inertia 330.58747721471264.
Converged at iteration 18: strict convergence.
Initialization complete
Iteration 0, inertia 582.0758116752922.
Iteration 1, inertia 372.5165011633965.
Iteration 2, inertia 365.75962540312713.
Iteration 3, inertia 363.07622888102526.
Iteration 4, inertia 362.39322311026655.
Iteration 5, inertia 362.0666740253467.
Iteration 6, inertia 361.93330905973363.
Iteration 7, inertia 361.8146972582912.
Iteration 8, inertia 361.7779614258702.
Iteration 9, inertia 361.7512264574163.
Iteration 10, inertia 361.6870598967357.
Iteration 11, inertia 361.58469255806557.
Iteration 12, inertia 361.51798645625314.
Iteration 13, inertia 361.49248404934525.
Iteration 14, inertia 361.4493145510833.
Iteration 15, inertia 361.424835077166.
Iteration 16, inertia 361.41471311070774.
Iteration 17, inertia 361.4123966095069.
Iteration 18, inertia 361.40659187428.
Iteration 19, inertia 361.38400431864375.
Iteration 20, inertia 361.2812233425854.
Iteration 21, inertia 361.1790290744663.
Iteration 22, inertia 361.1454476570675.
Iteration 23, inertia 361.14058549954564.
Converged at iteration 23: center shift 3.6182683218688435e-06 within tolerance 4.150156953284628e-06.
Initialization complete
Iteration 0, inertia 487.04336942557694.
Iteration 1, inertia 367.25913710237023.
Iteration 2, inertia 362.7378280217092.
Iteration 3, inertia 361.7830901297319.
Iteration 4, inertia 361.2832233398601.
Iteration 5, inertia 360.9784886090707.
Iteration 6, inertia 360.7486218108736.
Iteration 7, inertia 360.44369624113403.
Iteration 8, inertia 359.94796561983065.
Iteration 9, inertia 359.8286261776018.
Iteration 10, inertia 359.4505800785059.
Iteration 11, inertia 359.0652410777712.
Iteration 12, inertia 358.7486192247122.
Iteration 13, inertia 358.6021543283267.
Converged at iteration 13: strict convergence.
Initialization complete
Iteration 0, inertia 512.8323447791395.
Iteration 1, inertia 345.1654556855418.
Iteration 2, inertia 335.46104185700705.
Iteration 3, inertia 333.91583311127096.
Iteration 4, inertia 333.38144672220835.
Iteration 5, inertia 333.136414828742.
Iteration 6, inertia 333.02435287800995.
Iteration 7, inertia 332.96589826455795.
Iteration 8, inertia 332.9096442937458.
Iteration 9, inertia 332.81486111613907.
Iteration 10, inertia 332.5948647795365.
Iteration 11, inertia 332.1791646345473.
Iteration 12, inertia 331.7827703611297.
Iteration 13, inertia 331.7219502104927.
Iteration 14, inertia 331.70546307860445.
Iteration 15, inertia 331.7006525468907.
Iteration 16, inertia 331.6942657958313.
Iteration 17, inertia 331.6916937892028.
Converged at iteration 17: strict convergence.
Initialization complete
Iteration 0, inertia 469.60916468441377.
Iteration 1, inertia 344.620163202747.
Iteration 2, inertia 330.90110421530954.
Iteration 3, inertia 328.94645319060453.
Iteration 4, inertia 328.59478080336163.
Iteration 5, inertia 328.5393380008715.
Iteration 6, inertia 328.5238296268808.
Iteration 7, inertia 328.5125860454734.
Converged at iteration 7: strict convergence.
Initialization complete
Iteration 0, inertia 460.9537665705993.
Iteration 1, inertia 362.715116891077.
Iteration 2, inertia 352.44999267807407.
Iteration 3, inertia 348.00822663100183.
Iteration 4, inertia 346.82493681384324.
Iteration 5, inertia 346.55509647721453.
Iteration 6, inertia 346.4859045206876.
Iteration 7, inertia 346.4351573937934.
Iteration 8, inertia 346.3902234368313.
Iteration 9, inertia 346.37169356935544.
Iteration 10, inertia 346.35007666498177.
Iteration 11, inertia 346.3483606532062.
Converged at iteration 11: strict convergence.
Initialization complete
Iteration 0, inertia 518.8031226944229.
Iteration 1, inertia 373.99532706958485.
Iteration 2, inertia 352.85731327866324.
Iteration 3, inertia 342.53152537731484.
Iteration 4, inertia 335.808645953195.
Iteration 5, inertia 333.299672653335.
Iteration 6, inertia 332.744897644923.
Iteration 7, inertia 332.55803882834783.
Iteration 8, inertia 332.2645717791277.
Iteration 9, inertia 331.7786799631405.
Iteration 10, inertia 331.5078374312672.
Iteration 11, inertia 331.4701534480808.
Iteration 12, inertia 331.45740515093166.
Iteration 13, inertia 331.4510183998722.
Iteration 14, inertia 331.4484463932436.
Converged at iteration 14: strict convergence.
Initialization complete
Iteration 0, inertia 487.86543490963055.
Iteration 1, inertia 350.7778738898838.
Iteration 2, inertia 337.78785692677593.
Iteration 3, inertia 332.87633600933907.
Iteration 4, inertia 331.80956097194417.
Iteration 5, inertia 331.5723071533509.
Iteration 6, inertia 331.5483225558219.
Iteration 7, inertia 331.5205389217688.
Iteration 8, inertia 331.4755526570257.
Iteration 9, inertia 331.4561212078146.
Iteration 10, inertia 331.4490927917436.
Iteration 11, inertia 331.44762341485847.
Converged at iteration 11: strict convergence.
Initialization complete
Iteration 0, inertia 418.8695917514101.
Iteration 1, inertia 340.25275968373836.
Iteration 2, inertia 334.189134898678.
Iteration 3, inertia 331.27876952690934.
Iteration 4, inertia 330.57423910963666.
Iteration 5, inertia 330.17181341752473.
Iteration 6, inertia 330.092164853767.
Iteration 7, inertia 330.0558430032502.
Iteration 8, inertia 330.0419960299533.
Converged at iteration 8: center shift 2.2864541687352634e-06 within tolerance 4.150156953284628e-06.
Initialization complete
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>C:\Users\admin\AppData\Roaming\Python\Python39\site-packages\sklearn\cluster\_kmeans.py:1334: UserWarning: KMeans is known to have a memory leak on Windows with MKL, when there are less chunks than available threads. You can avoid it by setting the environment variable OMP_NUM_THREADS=9.
  warnings.warn(
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Iteration 0, inertia 458.80118456789774.
Iteration 1, inertia 337.41813040139846.
Iteration 2, inertia 325.64129947280475.
Iteration 3, inertia 320.5644976809759.
Iteration 4, inertia 318.36641682119017.
Iteration 5, inertia 317.4039123591714.
Iteration 6, inertia 316.88845469672515.
Iteration 7, inertia 316.3425145207166.
Iteration 8, inertia 315.2498152692685.
Iteration 9, inertia 312.3794512028222.
Iteration 10, inertia 309.7257709053657.
Iteration 11, inertia 309.5228524757163.
Iteration 12, inertia 309.5031725564369.
Iteration 13, inertia 309.4989179577498.
Converged at iteration 13: strict convergence.
Initialization complete
Iteration 0, inertia 471.93769641180575.
Iteration 1, inertia 353.48055580130523.
Iteration 2, inertia 338.29977639133176.
Iteration 3, inertia 329.85394755198126.
Iteration 4, inertia 326.7441932910433.
Iteration 5, inertia 324.0422396654699.
Iteration 6, inertia 320.57395023035366.
Iteration 7, inertia 317.3817105967318.
Iteration 8, inertia 315.07130153086695.
Iteration 9, inertia 313.2800939374424.
Iteration 10, inertia 312.62863234187415.
Iteration 11, inertia 312.4452105040122.
Iteration 12, inertia 312.353573204451.
Iteration 13, inertia 312.31022838410206.
Iteration 14, inertia 312.2766039708392.
Iteration 15, inertia 312.2643927252394.
Converged at iteration 15: center shift 2.7748396683320564e-06 within tolerance 4.150156953284628e-06.
Initialization complete
Iteration 0, inertia 441.7735039190783.
Iteration 1, inertia 347.94173275093726.
Iteration 2, inertia 336.6048189806491.
Iteration 3, inertia 334.31619756189383.
Iteration 4, inertia 330.53892598724826.
Iteration 5, inertia 325.91211504937235.
Iteration 6, inertia 322.4584593357035.
Iteration 7, inertia 319.4172780604193.
Iteration 8, inertia 317.4967740051117.
Iteration 9, inertia 316.5993772914741.
Iteration 10, inertia 316.28870343558503.
Iteration 11, inertia 316.0595157133766.
Iteration 12, inertia 315.9462711941353.
Iteration 13, inertia 315.73877442734835.
Iteration 14, inertia 315.440254935284.
Iteration 15, inertia 315.34522107382725.
Iteration 16, inertia 315.3173643304529.
Iteration 17, inertia 315.2719741902757.
Iteration 18, inertia 315.1479033863198.
Iteration 19, inertia 315.06362094739404.
Iteration 20, inertia 314.985657134832.
Iteration 21, inertia 314.90333390209264.
Iteration 22, inertia 314.8741226366776.
Iteration 23, inertia 314.83351737845305.
Iteration 24, inertia 314.79170777759566.
Iteration 25, inertia 314.787604396475.
Converged at iteration 25: strict convergence.
Initialization complete
Iteration 0, inertia 432.2829541177978.
Iteration 1, inertia 318.9670954030507.
Iteration 2, inertia 310.60227327534017.
Iteration 3, inertia 309.67011615713267.
Iteration 4, inertia 309.5258017520136.
Iteration 5, inertia 309.5034352861004.
Iteration 6, inertia 309.4994689324497.
Iteration 7, inertia 309.4977301626677.
Converged at iteration 7: strict convergence.
Initialization complete
Iteration 0, inertia 514.9535644137438.
Iteration 1, inertia 353.34416150736774.
Iteration 2, inertia 334.5360529068138.
Iteration 3, inertia 321.9754381716443.
Iteration 4, inertia 312.0125099578929.
Iteration 5, inertia 309.72171089968003.
Iteration 6, inertia 309.2736319668375.
Iteration 7, inertia 309.1430476028068.
Iteration 8, inertia 309.1099429849444.
Iteration 9, inertia 309.09175994233334.
Iteration 10, inertia 309.09058107131654.
Converged at iteration 10: strict convergence.
Initialization complete
Iteration 0, inertia 487.86443485667587.
Iteration 1, inertia 350.0411637952968.
Iteration 2, inertia 339.04964526465955.
Iteration 3, inertia 334.3041044416628.
Iteration 4, inertia 332.2808726842898.
Iteration 5, inertia 331.39418943916047.
Iteration 6, inertia 330.9770705415142.
Iteration 7, inertia 330.75263468065594.
Iteration 8, inertia 330.72238640518566.
Iteration 9, inertia 330.71102856841475.
Converged at iteration 9: strict convergence.
Initialization complete
Iteration 0, inertia 417.6501910284532.
Iteration 1, inertia 331.8064901310793.
Iteration 2, inertia 323.4117895712657.
Iteration 3, inertia 318.4230729663058.
Iteration 4, inertia 315.92858639991624.
Iteration 5, inertia 314.51268725317533.
Iteration 6, inertia 313.9795814300112.
Iteration 7, inertia 313.7666913991247.
Iteration 8, inertia 313.66513820102983.
Iteration 9, inertia 313.5991972242056.
Iteration 10, inertia 313.57496578234776.
Iteration 11, inertia 313.553421667093.
Iteration 12, inertia 313.50825719768693.
Iteration 13, inertia 313.4364735532121.
Iteration 14, inertia 313.2088988211259.
Iteration 15, inertia 312.82625108122704.
Iteration 16, inertia 312.41900987968415.
Iteration 17, inertia 312.29543415653256.
Iteration 18, inertia 312.2670220246272.
Iteration 19, inertia 312.2650158770858.
Converged at iteration 19: strict convergence.
Initialization complete
Iteration 0, inertia 444.87004883994854.
Iteration 1, inertia 347.9064416167153.
Iteration 2, inertia 333.86011801546033.
Iteration 3, inertia 327.02155102178165.
Iteration 4, inertia 325.7024087433042.
Iteration 5, inertia 324.79804312496645.
Iteration 6, inertia 323.4227979516623.
Iteration 7, inertia 322.908702559151.
Iteration 8, inertia 322.46018230738656.
Iteration 9, inertia 322.1964400500508.
Iteration 10, inertia 322.08450914853574.
Iteration 11, inertia 321.945654231334.
Iteration 12, inertia 321.58651717251087.
Iteration 13, inertia 320.8274664630577.
Iteration 14, inertia 320.5316731107325.
Iteration 15, inertia 320.4250073778508.
Iteration 16, inertia 320.3976033611618.
Iteration 17, inertia 320.387951981081.
Iteration 18, inertia 320.37303730874913.
Iteration 19, inertia 320.3236622205349.
Iteration 20, inertia 320.26653107372044.
Iteration 21, inertia 320.23909032315106.
Iteration 22, inertia 320.16799583962427.
Iteration 23, inertia 320.0735882227743.
Iteration 24, inertia 319.9472726334301.
Iteration 25, inertia 319.79161700572223.
Iteration 26, inertia 319.65022139581356.
Iteration 27, inertia 319.25814645044466.
Iteration 28, inertia 318.049734658951.
Iteration 29, inertia 315.8157694430329.
Iteration 30, inertia 313.94413729549245.
Iteration 31, inertia 313.27326715582495.
Iteration 32, inertia 312.8693736034659.
Iteration 33, inertia 312.2432567772994.
Iteration 34, inertia 311.4249863678077.
Iteration 35, inertia 311.07515946028036.
Iteration 36, inertia 310.9713036714872.
Iteration 37, inertia 310.8235364107113.
Iteration 38, inertia 310.65492761765586.
Iteration 39, inertia 310.61491938385745.
Iteration 40, inertia 310.60797724970405.
Iteration 41, inertia 310.5967336682967.
Converged at iteration 41: strict convergence.
Initialization complete
Iteration 0, inertia 467.04062198510735.
Iteration 1, inertia 330.150914163842.
Iteration 2, inertia 324.83650764458366.
Iteration 3, inertia 322.74242210824195.
Iteration 4, inertia 321.96384249958413.
Iteration 5, inertia 321.42288744609584.
Iteration 6, inertia 321.2446021072375.
Iteration 7, inertia 321.20234500640936.
Iteration 8, inertia 321.16960620653606.
Iteration 9, inertia 321.1378535494524.
Iteration 10, inertia 321.11099717446507.
Iteration 11, inertia 321.09532222837686.
Iteration 12, inertia 321.0936671098292.
Converged at iteration 12: strict convergence.
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[25]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Plotting between the K value and Silhoutte Score</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">range_n_clusters</span><span class="p">,</span><span class="n">silhouette_avg</span><span class="p">,</span> <span class="s1">&#39;bx-&#39;</span><span class="p">)</span>
<span class="c1">#X-label - Values of K</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Values of K&quot;</span><span class="p">)</span>
<span class="c1">#Y-label - Silhouette Score</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Silhouette score&quot;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Silhouette analysis For Optimal k&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://" class="jp-needs-light-background"/>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>The highest silhouette score is given to K=2 as it has about 0.46 score from the plot.</p>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>d. [10 pts] Perform PCA on the normalized image data matrix. You may use the linear algebra package in Numpy or the Decomposition module in scikit-learn (the latter is much more efficient). Analyze the principal components to determine the number, r, of PCs needed to capture at least 95% of variance in the data. Provide a Scree plot of PC variances. Then use these r components as features to transform the data into a reduced dimension space.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[26]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Performing PCA on the image</span>
<span class="n">PCA</span> <span class="o">=</span> <span class="n">decomposition</span><span class="o">.</span><span class="n">PCA</span><span class="p">()</span>
<span class="n">segmentation_data_trans</span> <span class="o">=</span> <span class="n">PCA</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">segmentation_data_norm</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">segmentation_data_norm</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[27]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                    <span class="n">edgeitems</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">120</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[28]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">segmentation_data_trans</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>[[-0.69  0.53  0.25 -0.2  -0.08 ...  0.    0.   -0.    0.    0.  ]
 [-0.67  0.51  0.34 -0.17 -0.04 ... -0.   -0.    0.   -0.    0.  ]
 [-0.71  0.77 -0.16 -0.01 -0.17 ... -0.   -0.    0.    0.    0.  ]
 [-0.73  0.51  0.5  -0.06 -0.14 ... -0.   -0.   -0.    0.    0.  ]
 [-0.64  0.53  0.3  -0.18 -0.02 ... -0.   -0.    0.    0.    0.  ]
 ...
 [-0.5  -0.26  0.27  0.11 -0.01 ...  0.   -0.    0.   -0.   -0.  ]
 [-0.5  -0.26  0.38  0.15  0.03 ...  0.    0.    0.   -0.   -0.  ]
 [-0.51 -0.13 -0.08  0.1  -0.03 ... -0.   -0.   -0.    0.   -0.  ]
 [-0.48 -0.09 -0.16  0.11  0.   ...  0.   -0.   -0.    0.   -0.  ]
 [-0.44 -0.11 -0.05  0.15  0.02 ...  0.   -0.   -0.    0.   -0.  ]]
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[29]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Printing the PCA variance ratio</span>
<span class="nb">print</span><span class="p">(</span><span class="n">PCA</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>[0.61 0.13 0.1  0.05 0.04 0.02 0.02 0.02 0.01 0.01 0.   0.   0.   0.   0.   0.   0.   0.   0.  ]
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[30]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Analyzing the Principal Components</span>
<span class="n">varPercentage</span> <span class="o">=</span> <span class="n">PCA</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="o">*</span><span class="mi">100</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[31]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Plotting the %variance and Principal Component Number</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">19</span><span class="p">),</span> <span class="n">varPercentage</span><span class="p">[:],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;^&#39;</span><span class="p">)</span>
<span class="c1">#X-label for Principal Component Number</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Principal Component Number&#39;</span><span class="p">)</span>
<span class="c1">#y-label for %variance</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Percentage of Variance&#39;</span><span class="p">)</span>
<span class="c1">#Plotting the points</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://" class="jp-needs-light-background"/>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>The 95% of the variance in the data have been captured by 6 Principal Components.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[32]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Reduced data</span>
<span class="n">DT_trans_reduced</span> <span class="o">=</span> <span class="n">segmentation_data_trans</span><span class="p">[:,:</span><span class="mi">6</span><span class="p">]</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[33]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">DT_trans_reduced</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>[[-0.69  0.53  0.25 -0.2  -0.08  0.05]
 [-0.67  0.51  0.34 -0.17 -0.04  0.06]
 [-0.71  0.77 -0.16 -0.01 -0.17  0.04]
 [-0.73  0.51  0.5  -0.06 -0.14  0.03]
 [-0.64  0.53  0.3  -0.18 -0.02  0.05]
 ...
 [-0.5  -0.26  0.27  0.11 -0.01 -0.01]
 [-0.5  -0.26  0.38  0.15  0.03 -0.2 ]
 [-0.51 -0.13 -0.08  0.1  -0.03 -0.03]
 [-0.48 -0.09 -0.16  0.11  0.   -0.  ]
 [-0.44 -0.11 -0.05  0.15  0.02 -0.21]]
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>e. [5 pts] Perform Kmeans again, but this time on the lower dimensional transformed data. Then compare Silhouette values as well as completeness and Homogeneity values of the new clusters. Compare these results with those obtained on the full data in part b.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[34]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Using K-Means for the lower dimensional transformed data</span>
<span class="n">k_means</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span> <span class="o">=</span><span class="mi">7</span><span class="p">,</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[35]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">k_means</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">segmentation_data_trans</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>C:\Users\admin\AppData\Roaming\Python\Python39\site-packages\sklearn\cluster\_kmeans.py:1334: UserWarning: KMeans is known to have a memory leak on Windows with MKL, when there are less chunks than available threads. You can avoid it by setting the environment variable OMP_NUM_THREADS=9.
  warnings.warn(
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Initialization complete
Iteration 0, inertia 559.4859477770676.
Iteration 1, inertia 377.0060618229603.
Iteration 2, inertia 371.581882309834.
Iteration 3, inertia 370.01258512024214.
Iteration 4, inertia 369.5515414875032.
Iteration 5, inertia 369.4637527778182.
Iteration 6, inertia 369.45193563204464.
Iteration 7, inertia 369.41531992169115.
Iteration 8, inertia 369.38886843670207.
Iteration 9, inertia 369.32865891320415.
Iteration 10, inertia 369.14114792683125.
Iteration 11, inertia 368.8675486275784.
Iteration 12, inertia 368.45360907394297.
Iteration 13, inertia 368.0661681467462.
Iteration 14, inertia 367.81065961223857.
Iteration 15, inertia 367.64767065116285.
Iteration 16, inertia 367.5937361811224.
Iteration 17, inertia 367.579620030702.
Converged at iteration 17: center shift 3.082570388713687e-06 within tolerance 4.150156953284627e-06.
Initialization complete
Iteration 0, inertia 506.6923930932133.
Iteration 1, inertia 376.445824224008.
Iteration 2, inertia 357.290309253738.
Iteration 3, inertia 350.89608760322676.
Iteration 4, inertia 350.08625053688235.
Iteration 5, inertia 350.0323179660604.
Iteration 6, inertia 350.01883988047575.
Iteration 7, inertia 350.0143061331364.
Iteration 8, inertia 350.01290271945464.
Converged at iteration 8: strict convergence.
Initialization complete
Iteration 0, inertia 525.6171004046748.
Iteration 1, inertia 410.01481220528433.
Iteration 2, inertia 400.76668437697305.
Iteration 3, inertia 397.5097936505431.
Iteration 4, inertia 395.8268743776593.
Iteration 5, inertia 393.21897298864593.
Iteration 6, inertia 387.5783230157641.
Iteration 7, inertia 385.1196484659825.
Iteration 8, inertia 384.0796564704726.
Iteration 9, inertia 383.7999446586648.
Iteration 10, inertia 383.6333667379667.
Iteration 11, inertia 383.51593444325806.
Iteration 12, inertia 383.46720288520544.
Iteration 13, inertia 383.37151816044855.
Iteration 14, inertia 383.1628201562725.
Iteration 15, inertia 382.99364321766257.
Iteration 16, inertia 382.9391044706415.
Iteration 17, inertia 382.9336281573059.
Converged at iteration 17: center shift 3.6407335700648426e-06 within tolerance 4.150156953284627e-06.
Initialization complete
Iteration 0, inertia 576.679540444361.
Iteration 1, inertia 410.63221943499894.
Iteration 2, inertia 395.0434332658026.
Iteration 3, inertia 392.16920992000144.
Iteration 4, inertia 391.9463596511677.
Iteration 5, inertia 391.75589563474887.
Iteration 6, inertia 391.4610245458207.
Iteration 7, inertia 391.09879819478135.
Iteration 8, inertia 390.7844114365829.
Iteration 9, inertia 390.32638168007924.
Iteration 10, inertia 389.77642731156595.
Iteration 11, inertia 389.43584972706105.
Iteration 12, inertia 389.1643011580382.
Iteration 13, inertia 388.9612041020096.
Iteration 14, inertia 388.8143956253454.
Iteration 15, inertia 388.7548703623535.
Iteration 16, inertia 388.69613959807776.
Iteration 17, inertia 388.6387086978418.
Iteration 18, inertia 388.59668328857606.
Iteration 19, inertia 388.55736320353793.
Iteration 20, inertia 388.50955567720746.
Iteration 21, inertia 388.4317905893145.
Iteration 22, inertia 388.3574285553617.
Iteration 23, inertia 388.33842006389966.
Converged at iteration 23: center shift 3.263551148164673e-06 within tolerance 4.150156953284627e-06.
Initialization complete
Iteration 0, inertia 504.63457806430443.
Iteration 1, inertia 390.6583214873685.
Iteration 2, inertia 383.37963633706715.
Iteration 3, inertia 375.85141589744455.
Iteration 4, inertia 370.26484294657826.
Iteration 5, inertia 369.22907082356.
Iteration 6, inertia 369.0295731192009.
Iteration 7, inertia 368.9100024567184.
Iteration 8, inertia 368.8561054970133.
Iteration 9, inertia 368.83983412719795.
Iteration 10, inertia 368.82595625057394.
Iteration 11, inertia 368.8237300081671.
Iteration 12, inertia 368.818229519957.
Iteration 13, inertia 368.8150350302752.
Converged at iteration 13: center shift 3.966474896791236e-06 within tolerance 4.150156953284627e-06.
Initialization complete
Iteration 0, inertia 551.6887071631268.
Iteration 1, inertia 407.3446695934091.
Iteration 2, inertia 391.2645194847383.
Iteration 3, inertia 382.6818920834735.
Iteration 4, inertia 378.7993526363946.
Iteration 5, inertia 376.9023885133256.
Iteration 6, inertia 375.19685526889947.
Iteration 7, inertia 374.4378258486375.
Iteration 8, inertia 374.1295530241998.
Iteration 9, inertia 373.8582026274899.
Iteration 10, inertia 373.7066496266462.
Iteration 11, inertia 373.62612064637653.
Iteration 12, inertia 373.5699403278854.
Iteration 13, inertia 373.5425403198905.
Iteration 14, inertia 373.5200894538152.
Converged at iteration 14: center shift 3.636028071702104e-06 within tolerance 4.150156953284627e-06.
Initialization complete
Iteration 0, inertia 512.175610846383.
Iteration 1, inertia 388.42492637440523.
Iteration 2, inertia 382.66478879304753.
Iteration 3, inertia 379.75413120084346.
Iteration 4, inertia 376.72138950819624.
Iteration 5, inertia 374.96785164560805.
Iteration 6, inertia 374.2465213902866.
Iteration 7, inertia 373.9469020395411.
Iteration 8, inertia 373.7672050351973.
Iteration 9, inertia 373.6750742528122.
Iteration 10, inertia 373.660028873277.
Converged at iteration 10: center shift 3.949329818443513e-06 within tolerance 4.150156953284627e-06.
Initialization complete
Iteration 0, inertia 534.5384854042021.
Iteration 1, inertia 378.573093287695.
Iteration 2, inertia 374.02118433715674.
Iteration 3, inertia 372.6100054533512.
Iteration 4, inertia 371.29151981203734.
Iteration 5, inertia 369.4788807619653.
Iteration 6, inertia 367.78991721803936.
Iteration 7, inertia 366.0425991641739.
Iteration 8, inertia 364.7520342447121.
Iteration 9, inertia 364.2226950205953.
Iteration 10, inertia 363.83752540627245.
Iteration 11, inertia 363.61294358087133.
Iteration 12, inertia 363.47695065614215.
Iteration 13, inertia 363.42146975231594.
Iteration 14, inertia 363.404662646212.
Iteration 15, inertia 363.39932504202864.
Iteration 16, inertia 363.3977308103997.
Converged at iteration 16: strict convergence.
Initialization complete
Iteration 0, inertia 533.6647557238639.
Iteration 1, inertia 375.76082815329835.
Iteration 2, inertia 370.897785780071.
Iteration 3, inertia 370.0923845345271.
Iteration 4, inertia 369.924963179042.
Iteration 5, inertia 369.88871493429497.
Iteration 6, inertia 369.8634422089765.
Iteration 7, inertia 369.86088008085113.
Converged at iteration 7: strict convergence.
Initialization complete
Iteration 0, inertia 550.5290814095807.
Iteration 1, inertia 392.6107709773056.
Iteration 2, inertia 374.0586322860795.
Iteration 3, inertia 370.8051665857835.
Iteration 4, inertia 370.0182093459627.
Iteration 5, inertia 369.80301635992987.
Iteration 6, inertia 369.7295597516562.
Iteration 7, inertia 369.6967364185822.
Iteration 8, inertia 369.66774040852334.
Iteration 9, inertia 369.66444814400097.
Converged at iteration 9: center shift 3.091326850787372e-06 within tolerance 4.150156953284627e-06.
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[35]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div class="sk-top-container"><div class="sk-text-repr-fallback"><pre>KMeans(max_iter=500, n_clusters=7, verbose=1)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br/>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container"><div class="sk-item"><div class="sk-estimator sk-toggleable"><label for="sk-estimator-id-2" class="sk-toggleable__label sk-toggleable__label-arrow">KMeans</label><div class="sk-toggleable__content"><pre>KMeans(max_iter=500, n_clusters=7, verbose=1)</pre></div></div></div></div></div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[36]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">PC_clusters</span> <span class="o">=</span> <span class="n">k_means</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">segmentation_data_trans</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[37]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Showing the clusters in PC</span>
<span class="n">PC_clusters</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[37]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>array([3, 3, 3, 3, 3, ..., 4, 6, 0, 0, 6])</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[38]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Implementing the Silhoutte Values,</span>
<span class="c1">#Completeness Values, and</span>
<span class="c1">#Homogeneity values</span>
<span class="c1">#Compare between them</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[39]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">PC_silhouettes</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">silhouette_samples</span><span class="p">(</span><span class="n">segmentation_data_trans</span><span class="p">,</span> <span class="n">PC_clusters</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">PC_silhouettes</span><span class="p">[:</span><span class="mi">20</span><span class="p">])</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>[0.57 0.56 0.47 0.5  0.57 0.56 0.54 0.41 0.52 0.47 0.49 0.49 0.58 0.56 0.38 0.53 0.55 0.42 0.42 0.4 ]
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[40]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#For Silhoutte </span>
<span class="nb">print</span><span class="p">(</span><span class="n">PC_silhouettes</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>0.33202337619297806
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[41]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Completeness Score</span>
<span class="n">PC_Completeness_score</span> <span class="o">=</span> <span class="n">completeness_score</span><span class="p">(</span><span class="n">segmentation_class</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">PC_clusters</span><span class="p">)</span>
<span class="n">PC_Completeness_score</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[41]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>0.6116744999910889</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[42]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Homogeneity Score</span>
<span class="n">PC_Homogeneity_score</span> <span class="o">=</span> <span class="n">homogeneity_score</span><span class="p">(</span><span class="n">segmentation_class</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">PC_clusters</span><span class="p">)</span>
<span class="n">PC_Homogeneity_score</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[42]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>0.609965639314724</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[43]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Comparison with part b</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Without using the PCA&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Silhouette Score: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">silhouettes</span><span class="o">.</span><span class="n">mean</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Completeness Ccore: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">completeness_score</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Homogeneity Score: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">homogeneity_score</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;With using the PCA&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Silhouette Score: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PC_silhouettes</span><span class="o">.</span><span class="n">mean</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Completeness Ccore: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PC_Completeness_score</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Homogeneity Score: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PC_Homogeneity_score</span><span class="p">))</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Without using the PCA
Silhouette Score: 0.3320233761933512
Completeness Ccore: &lt;function completeness_score at 0x000001F793187040&gt;
Homogeneity Score: &lt;function homogeneity_score at 0x000001F79316CF70&gt;
With using the PCA
Silhouette Score: 0.33202337619297806
Completeness Ccore: 0.6116744999910889
Homogeneity Score: 0.609965639314724
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<ol>
<li>a. [15 pts] Load in the joke ratings data and the joke text data into appropriate data structures. Use the &quot;recommend&quot; function to provide top 5 joke recommendations for users with id 4 using both Pearson and cosine similarity measures. Note the differences. Use the standard item-based collaborative filtering (based on the rating prediction function &quot;standEst&quot;). Next, find the top 5 recommendations for user with id 25 only with Pearson similarity using both the standard estimator and the SVD-based version (using &quot;svdEst&quot; as the prediction engine) to generate these recommendations. Note the differences. When outputting recommendations, you should show both the id and the text of the recommended jokes (in decreasing order of predicted rating) as well as the predicted ratings for each.</li>
</ol>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[44]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Loading the necessary files and running them</span>
<span class="n">jest_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;C:/Users/admin/Desktop/modified_jester_data.csv&quot;</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">jokes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;C:/Users/admin/Desktop//jokes.csv&quot;</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[45]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Loading the descriptions of Jester_data</span>
<span class="n">jest_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[45]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>90</th>
      <th>91</th>
      <th>92</th>
      <th>93</th>
      <th>94</th>
      <th>95</th>
      <th>96</th>
      <th>97</th>
      <th>98</th>
      <th>99</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3.18</td>
      <td>19.79</td>
      <td>1.34</td>
      <td>2.84</td>
      <td>3.48</td>
      <td>2.50</td>
      <td>1.15</td>
      <td>15.17</td>
      <td>2.02</td>
      <td>6.24</td>
      <td>...</td>
      <td>13.82</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>5.37</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>15.08</td>
      <td>10.71</td>
      <td>17.36</td>
      <td>15.37</td>
      <td>8.62</td>
      <td>1.34</td>
      <td>10.27</td>
      <td>5.66</td>
      <td>19.88</td>
      <td>20.22</td>
      <td>...</td>
      <td>13.82</td>
      <td>6.05</td>
      <td>10.71</td>
      <td>18.86</td>
      <td>10.81</td>
      <td>8.86</td>
      <td>14.06</td>
      <td>11.34</td>
      <td>6.68</td>
      <td>12.07</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>20.03</td>
      <td>20.27</td>
      <td>20.03</td>
      <td>20.27</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>...</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>20.08</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.00</td>
      <td>19.35</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>12.80</td>
      <td>19.16</td>
      <td>8.18</td>
      <td>17.21</td>
      <td>0.00</td>
      <td>12.84</td>
      <td>...</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>11.53</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>19.50</td>
      <td>15.61</td>
      <td>6.83</td>
      <td>5.61</td>
      <td>12.36</td>
      <td>12.60</td>
      <td>18.04</td>
      <td>15.61</td>
      <td>10.56</td>
      <td>16.73</td>
      <td>...</td>
      <td>16.19</td>
      <td>16.58</td>
      <td>15.27</td>
      <td>16.19</td>
      <td>16.73</td>
      <td>12.55</td>
      <td>14.11</td>
      <td>17.55</td>
      <td>12.80</td>
      <td>12.60</td>
    </tr>
  </tbody>
</table>
<p>5 rows &#215; 100 columns</p>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[46]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Info</span>
<span class="n">jest_data</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 1000 entries, 0 to 999
Data columns (total 100 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   0       1000 non-null   float64
 1   1       1000 non-null   float64
 2   2       1000 non-null   float64
 3   3       1000 non-null   float64
 4   4       1000 non-null   float64
 5   5       1000 non-null   float64
 6   6       1000 non-null   float64
 7   7       1000 non-null   float64
 8   8       1000 non-null   float64
 9   9       1000 non-null   float64
 10  10      1000 non-null   float64
 11  11      1000 non-null   float64
 12  12      1000 non-null   float64
 13  13      1000 non-null   float64
 14  14      1000 non-null   float64
 15  15      1000 non-null   float64
 16  16      1000 non-null   float64
 17  17      1000 non-null   float64
 18  18      1000 non-null   float64
 19  19      1000 non-null   float64
 20  20      1000 non-null   float64
 21  21      1000 non-null   float64
 22  22      1000 non-null   float64
 23  23      1000 non-null   float64
 24  24      1000 non-null   float64
 25  25      1000 non-null   float64
 26  26      1000 non-null   float64
 27  27      1000 non-null   float64
 28  28      1000 non-null   float64
 29  29      1000 non-null   float64
 30  30      1000 non-null   float64
 31  31      1000 non-null   float64
 32  32      1000 non-null   float64
 33  33      1000 non-null   float64
 34  34      1000 non-null   float64
 35  35      1000 non-null   float64
 36  36      1000 non-null   float64
 37  37      1000 non-null   float64
 38  38      1000 non-null   float64
 39  39      1000 non-null   float64
 40  40      1000 non-null   float64
 41  41      1000 non-null   float64
 42  42      1000 non-null   float64
 43  43      1000 non-null   float64
 44  44      1000 non-null   float64
 45  45      1000 non-null   float64
 46  46      1000 non-null   float64
 47  47      1000 non-null   float64
 48  48      1000 non-null   float64
 49  49      1000 non-null   float64
 50  50      1000 non-null   float64
 51  51      1000 non-null   float64
 52  52      1000 non-null   float64
 53  53      1000 non-null   float64
 54  54      1000 non-null   float64
 55  55      1000 non-null   float64
 56  56      1000 non-null   float64
 57  57      1000 non-null   float64
 58  58      1000 non-null   float64
 59  59      1000 non-null   float64
 60  60      1000 non-null   float64
 61  61      1000 non-null   float64
 62  62      1000 non-null   float64
 63  63      1000 non-null   float64
 64  64      1000 non-null   float64
 65  65      1000 non-null   float64
 66  66      1000 non-null   float64
 67  67      1000 non-null   float64
 68  68      1000 non-null   float64
 69  69      1000 non-null   float64
 70  70      1000 non-null   float64
 71  71      1000 non-null   float64
 72  72      1000 non-null   float64
 73  73      1000 non-null   float64
 74  74      1000 non-null   float64
 75  75      1000 non-null   float64
 76  76      1000 non-null   float64
 77  77      1000 non-null   float64
 78  78      1000 non-null   float64
 79  79      1000 non-null   float64
 80  80      1000 non-null   float64
 81  81      1000 non-null   float64
 82  82      1000 non-null   float64
 83  83      1000 non-null   float64
 84  84      1000 non-null   float64
 85  85      1000 non-null   float64
 86  86      1000 non-null   float64
 87  87      1000 non-null   float64
 88  88      1000 non-null   float64
 89  89      1000 non-null   float64
 90  90      1000 non-null   float64
 91  91      1000 non-null   float64
 92  92      1000 non-null   float64
 93  93      1000 non-null   float64
 94  94      1000 non-null   float64
 95  95      1000 non-null   float64
 96  96      1000 non-null   float64
 97  97      1000 non-null   float64
 98  98      1000 non-null   float64
 99  99      1000 non-null   float64
dtypes: float64(100)
memory usage: 781.4 KB
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[47]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Shape of the Jester file</span>
<span class="n">jest_data</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[47]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>(1000, 100)</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[48]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">jokes</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[48]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A man visits the doctor. The doctor says &quot;I ha...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>This couple had an excellent relationship goin...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Q. What&#39;s 200 feet long and has 4 teeth? A. Th...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Q. What&#39;s the difference between a man and a t...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Q. What&#39;s O. J. Simpson&#39;s Internet address? A....</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[49]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Info on Jokes</span>
<span class="n">jokes</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 100 entries, 0 to 99
Data columns (total 1 columns):
 #   Column  Non-Null Count  Dtype 
---  ------  --------------  ----- 
 0   1       100 non-null    object
dtypes: object(1)
memory usage: 928.0+ bytes
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[50]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Shape of the Jokes files</span>
<span class="n">jokes</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[50]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>(100, 1)</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[51]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Implementing the Pearson and Cosine</span>
<span class="c1">#Similarity measures</span>
<span class="k">def</span> <span class="nf">euclidSim</span><span class="p">(</span><span class="n">in_A</span><span class="p">,</span><span class="n">in_B</span><span class="p">):</span>
    <span class="k">return</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">la</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">in_A</span> <span class="o">-</span> <span class="n">in_B</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">pearsonSim</span><span class="p">(</span><span class="n">in_A</span><span class="p">,</span><span class="n">in_B</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">in_A</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span> <span class="p">:</span> <span class="k">return</span> <span class="mf">1.0</span>
    <span class="k">return</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">corrcoef</span><span class="p">(</span><span class="n">in_A</span><span class="p">,</span> <span class="n">in_B</span><span class="p">,</span> <span class="n">rowvar</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<span class="k">def</span> <span class="nf">cosineSim</span><span class="p">(</span><span class="n">in_A</span><span class="p">,</span><span class="n">in_B</span><span class="p">):</span>
    <span class="n">num</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">in_A</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">in_B</span><span class="p">)</span>
    <span class="n">denom</span> <span class="o">=</span> <span class="n">la</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">in_A</span><span class="p">)</span><span class="o">*</span><span class="n">la</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">in_B</span><span class="p">)</span>
    <span class="k">return</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">num</span> <span class="o">/</span> <span class="n">denom</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[52]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Using the Standard item-based collaborative filtering</span>
<span class="k">def</span> <span class="nf">standEst</span><span class="p">(</span><span class="n">dataMat</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">simMeas</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">shape</span><span class="p">(</span><span class="n">dataMat</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">simTotal</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="n">ratSimTotal</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">data</span><span class="o">=</span><span class="n">mat</span><span class="p">(</span><span class="n">dataMat</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">userRating</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">user</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">userRating</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">continue</span>
        <span class="n">overLap</span> <span class="o">=</span> <span class="n">nonzero</span><span class="p">(</span><span class="n">logical_and</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="n">item</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span> <span class="n">data</span><span class="p">[:,</span><span class="n">j</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">overLap</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">similarity</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">similarity</span> <span class="o">=</span> <span class="n">simMeas</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">overLap</span><span class="p">,</span><span class="n">item</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">overLap</span><span class="p">,</span><span class="n">j</span><span class="p">])</span>
        <span class="n">simTotal</span> <span class="o">+=</span> <span class="n">similarity</span>
        <span class="n">ratSimTotal</span> <span class="o">+=</span> <span class="n">similarity</span> <span class="o">*</span> <span class="n">userRating</span>
    <span class="k">if</span> <span class="n">simTotal</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">return</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="n">ratSimTotal</span><span class="o">/</span><span class="n">simTotal</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[53]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">svdEst</span><span class="p">(</span><span class="n">dataMat</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">simMeas</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">shape</span><span class="p">(</span><span class="n">dataMat</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">simTotal</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="n">ratSimTotal</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">data</span><span class="o">=</span><span class="n">mat</span><span class="p">(</span><span class="n">dataMat</span><span class="p">)</span>
    <span class="n">U</span><span class="p">,</span><span class="n">Sigma</span><span class="p">,</span><span class="n">VT</span> <span class="o">=</span> <span class="n">la</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="c1">#The sig4 is arranged into a diagonal matrix</span>
    <span class="n">Sig4</span> <span class="o">=</span> <span class="n">mat</span><span class="p">(</span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">Sigma</span><span class="p">[:</span><span class="mi">4</span><span class="p">])</span> 
    <span class="n">xformedItems</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">U</span><span class="p">[:,:</span><span class="mi">4</span><span class="p">]</span> <span class="o">*</span> <span class="n">Sig4</span><span class="o">.</span><span class="n">I</span> 
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">userRating</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">user</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">userRating</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">j</span><span class="o">==</span><span class="n">item</span><span class="p">:</span> <span class="k">continue</span>
        <span class="n">similarity</span> <span class="o">=</span> <span class="n">simMeas</span><span class="p">(</span><span class="n">xformedItems</span><span class="p">[</span><span class="n">item</span><span class="p">,:]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">xformedItems</span><span class="p">[</span><span class="n">j</span><span class="p">,:]</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
        <span class="n">simTotal</span> <span class="o">+=</span> <span class="n">similarity</span>
        <span class="n">ratSimTotal</span> <span class="o">+=</span> <span class="n">similarity</span> <span class="o">*</span> <span class="n">userRating</span>
    <span class="k">if</span> <span class="n">simTotal</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">return</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="n">ratSimTotal</span><span class="o">/</span><span class="n">simTotal</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[54]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">recommend</span><span class="p">(</span><span class="n">dataMat</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">simMeas</span><span class="o">=</span><span class="n">cosineSim</span><span class="p">,</span> <span class="n">estMethod</span><span class="o">=</span><span class="n">standEst</span><span class="p">):</span>
    <span class="n">unratedItems</span> <span class="o">=</span> <span class="n">nonzero</span><span class="p">(</span><span class="n">dataMat</span><span class="p">[</span><span class="n">user</span><span class="p">,:]</span><span class="o">.</span><span class="n">A</span><span class="o">==</span><span class="mi">0</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> 
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unratedItems</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">return</span> <span class="s1">&#39;you rated everything&#39;</span>
    <span class="n">itemScores</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">unratedItems</span><span class="p">:</span>
        <span class="n">estimatedScore</span> <span class="o">=</span> <span class="n">estMethod</span><span class="p">(</span><span class="n">dataMat</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">simMeas</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
        <span class="n">itemScores</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">item</span><span class="p">,</span> <span class="n">estimatedScore</span><span class="p">))</span>
    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">itemScores</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">jj</span><span class="p">:</span> <span class="n">jj</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)[:</span><span class="n">N</span><span class="p">]</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[55]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">jest_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">jest_data</span><span class="p">)</span>
<span class="n">user</span> <span class="o">=</span> <span class="mi">4</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[56]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">cos_recomm</span> <span class="o">=</span> <span class="n">recommend</span><span class="p">(</span><span class="n">jest_matrix</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">simMeas</span><span class="o">=</span><span class="n">cosineSim</span><span class="p">,</span> <span class="n">estMethod</span><span class="o">=</span><span class="n">standEst</span><span class="p">)</span>
<span class="n">cos_recomm</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[56]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>[(71, 14.293754381681563),
 (75, 14.293605672411005),
 (79, 14.293063319114747),
 (78, 14.2908339103558),
 (70, 14.287092374768891)]</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[57]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Pearson</span>
<span class="n">pear_recomm</span> <span class="o">=</span> <span class="n">recommend</span><span class="p">(</span><span class="n">jest_matrix</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">simMeas</span><span class="o">=</span><span class="n">pearsonSim</span><span class="p">,</span> <span class="n">estMethod</span><span class="o">=</span><span class="n">standEst</span><span class="p">)</span>
<span class="n">pear_recomm</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[57]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>[(71, 14.413443009309447),
 (75, 14.397311198445264),
 (79, 14.382511887413443),
 (78, 14.356160763938075),
 (72, 14.334361485417928)]</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[58]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Finding the top 5 recommendations for user</span>
<span class="k">def</span> <span class="nf">top_N_jokes</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">jokes</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">Means</span><span class="p">,</span> <span class="n">Method</span><span class="p">):</span>
    <span class="n">recom_jokes</span> <span class="o">=</span> <span class="n">recommend</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">simMeas</span><span class="o">=</span><span class="n">Means</span><span class="p">,</span> <span class="n">estMethod</span><span class="o">=</span><span class="n">Method</span><span class="p">)</span>
    <span class="k">if</span><span class="p">(</span><span class="n">recom_jokes</span><span class="o">==</span><span class="s1">&#39;you rated everything&#39;</span><span class="p">):</span>
        <span class="k">return</span><span class="p">;</span>
<span class="c1">#Printing the recommendations</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Recomemndations are: &quot;</span><span class="p">,</span><span class="n">recom_jokes</span><span class="p">)</span>
<span class="c1">#Printing for user id 25  </span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Top 5 jokes for user with id 25 are:&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">recom_jokes</span><span class="p">)):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot; JOKE : (&quot;</span><span class="p">,</span><span class="n">recom_jokes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;) - &quot;</span><span class="p">,</span>
              <span class="n">jokes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">recom_jokes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]],</span>
              <span class="s1">&#39;</span><span class="se">\n\t</span><span class="s1"> RATING (Predicted) = &#39;</span><span class="p">,</span><span class="n">recom_jokes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[59]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Pearson Similarity for StandEst</span>
<span class="n">top_N_jokes</span><span class="p">(</span><span class="n">jest_matrix</span><span class="p">,</span> <span class="n">jokes</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span><span class="n">pearsonSim</span> <span class="p">,</span> <span class="n">standEst</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Recomemndations are:  [(99, 15.324673571007686), (71, 15.324296950553675), (97, 15.322105340570541), (82, 15.301730225022272), (91, 15.294030630051065)]
Top 5 jokes for user with id 25 are:
	  JOKE : ( 99 ) -  Q: What&#39;s the difference between greeting a Queen and greeting thePresident of the United  States?A: You only have to get on one knee to greet the queen. 
	 RATING (Predicted) =  15.324673571007686 

	  JOKE : ( 71 ) -  On the first day of college the Dean addressed the students pointing out some of the rules:&quot;The female dormitory will be out-of-bounds for all male students and the male dormitory to the female students. Anybody caught breaking this rule will be fined $20 the first time.&quot; He continued &quot;Anybody caught breaking this rule the second time will be fined $60. Being caught a third time will cost you a fine of $180. Are there any questions ?&quot;At this point a male student in the crowd inquired:&quot;How much for a season pass ?&quot; 
	 RATING (Predicted) =  15.324296950553675 

	  JOKE : ( 97 ) -  Age and Womanhood1. Between the ages of 13 and 18 ... She is like Africa virgin and unexplored. 2. Between the ages of 19 and 35 ... She is like Asia hot and exotic. 3. Between the ages of 36 and 45 ... She is like America fully explored breathtakingly beautiful and free with her resources.4. Between the ages of 46 and 56 ...She is like Europe exhausted but still has points of interest. 5. After 56 she is like Australia ...Everybody knows it&#39;s down there but who gives a damn? 
	 RATING (Predicted) =  15.322105340570541 

	  JOKE : ( 82 ) -  What a woman says:&quot;This place is a mess!  C&#39;monYou and I need to clean upYour stuff is lying on the floor and you&#39;ll have no clothes to wear if we don&#39;t do laundry right now!&quot;What a man hears:blah blah blah blah C&#39;mon blah blah blah blah you and I blah blah blah blah on the floor blah blah blah blah no clothes blah blah blah blah RIGHT NOW! 
	 RATING (Predicted) =  15.301730225022272 

	  JOKE : ( 91 ) -  Early one morning a mother went to her sleeping son and woke him up.&quot;Wake up son.  It&#39;s time to go to school.&quot; &quot;But why Mama?  I don&#39;t want to go to school.&quot; &quot;Give me two reasons why you don&#39;t want to go to school.&quot; &quot;One all the children hate me. Two all the teachers hate me&quot; &quot;Oh! that&#39;s no reason. Come on you have to go to school&quot; &quot;Give me two good reasons WHY I should go to school?&quot;  &quot;One you are fifty-two years old. Two you are the principal of the school.&quot;  
	 RATING (Predicted) =  15.294030630051065 




</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[60]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Pearson Similarity for SVD</span>
<span class="n">top_N_jokes</span><span class="p">(</span><span class="n">jest_matrix</span><span class="p">,</span> <span class="n">jokes</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span><span class="n">pearsonSim</span> <span class="p">,</span> <span class="n">svdEst</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Recomemndations are:  [(3, 15.277088154749473), (79, 15.238062599769163), (72, 15.209188661833458), (71, 15.18502140590189), (99, 15.180560799732316)]
Top 5 jokes for user with id 25 are:
	  JOKE : ( 3 ) -  Q. What&#39;s the difference between a man and a toilet? A. A toilet doesn&#39;t follow you around after you use it. 
	 RATING (Predicted) =  15.277088154749473 

	  JOKE : ( 79 ) -  Hillary Bill Clinton and the Pope are sitting together on an airplane. Bill says &quot;I could throw one thousand dollar bill out of this plane and make one person very happy.&quot;Hillary says &quot;I could throw 10 hundred dollar bills out of the plane and make 10 people very happy.&quot;The Pope chips in and says &quot;I could throw Bill out of the airplane and make the whole country happy.&quot; 
	 RATING (Predicted) =  15.238062599769163 

	  JOKE : ( 72 ) -  Q: What is the difference between George  Washington Richard Nixon and Bill Clinton? A: Washington couldn&#39;t tell a lie Nixon couldn&#39;t   tell the truth andClinton doesn&#39;t know the difference. 
	 RATING (Predicted) =  15.209188661833458 

	  JOKE : ( 71 ) -  On the first day of college the Dean addressed the students pointing out some of the rules:&quot;The female dormitory will be out-of-bounds for all male students and the male dormitory to the female students. Anybody caught breaking this rule will be fined $20 the first time.&quot; He continued &quot;Anybody caught breaking this rule the second time will be fined $60. Being caught a third time will cost you a fine of $180. Are there any questions ?&quot;At this point a male student in the crowd inquired:&quot;How much for a season pass ?&quot; 
	 RATING (Predicted) =  15.18502140590189 

	  JOKE : ( 99 ) -  Q: What&#39;s the difference between greeting a Queen and greeting thePresident of the United  States?A: You only have to get on one knee to greet the queen. 
	 RATING (Predicted) =  15.180560799732316 




</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>b. [15 pts] Complete the definition for the function &quot;test&quot;. This function iterates over all users and for each performs evaluation (by calling the provided &quot;cross_validate_user&quot; function) and returns the error information necessary to compute Mean Absolute Error (MAE). Use this function to perform evaluation (with 20% test-ratio for each user) comparing MAE results using the rating prediction function &quot;standEst&quot; with results using the &quot;svdEst&quot; prediction function (in both cases using Pearson similarity measure. Note that this may take several minutes depending on your computational environment. [Note: See comments provided in the module for hints on accomplishing these tasks.]</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[61]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">cross_validate_user</span><span class="p">(</span><span class="n">dataMat</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">test_ratio</span><span class="p">,</span> <span class="n">estMethod</span><span class="o">=</span><span class="n">standEst</span><span class="p">,</span> <span class="n">simMeas</span><span class="o">=</span><span class="n">pearsonSim</span><span class="p">):</span>
    <span class="n">dataMat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dataMat</span><span class="p">)</span>
    <span class="n">num_of_items</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">dataMat</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">rated_items_by_user</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_of_items</span><span class="p">)</span> <span class="k">if</span> <span class="n">dataMat</span><span class="p">[</span><span class="n">user</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">test_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">test_ratio</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">rated_items_by_user</span><span class="p">))</span>
    <span class="n">test_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">rated_items_by_user</span><span class="p">),</span> <span class="n">test_size</span><span class="p">)</span>
    <span class="n">with_held_items</span> <span class="o">=</span> <span class="n">rated_items_by_user</span><span class="p">[</span><span class="n">test_indices</span><span class="p">]</span>
    <span class="n">orig_user_profile</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">dataMat</span><span class="p">[</span><span class="n">user</span><span class="p">])</span>
    <span class="n">dataMat</span><span class="p">[</span><span class="n">user</span><span class="p">,</span> <span class="n">with_held_items</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> 
    <span class="n">error_u</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">count_u</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">with_held_items</span><span class="p">)</span>
<span class="c1">#Absolute error is computed </span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">with_held_items</span><span class="p">:</span>
<span class="c1">#The rating is estimated based on the withheld item</span>
        <span class="n">esti_Score</span> <span class="o">=</span> <span class="n">estMethod</span><span class="p">(</span><span class="n">dataMat</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">simMeas</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
        <span class="n">error_u</span> <span class="o">=</span> <span class="n">error_u</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">esti_Score</span> <span class="o">-</span> <span class="n">orig_user_profile</span><span class="p">[</span><span class="n">item</span><span class="p">])</span>
<span class="c1">#From the withheld items, now restoring</span>
<span class="c1">#Ratings to the user profile</span>
<span class="c1">#Also, for the user returning both the sum of abs errors and count of test cases</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">with_held_items</span><span class="p">:</span>
        <span class="n">dataMat</span><span class="p">[</span><span class="n">user</span><span class="p">,</span> <span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="n">orig_user_profile</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">error_u</span><span class="p">,</span> <span class="n">count_u</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[62]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Using this function, all users are iterated and evaluated </span>
<span class="c1">#Using the cross_validate_user fn</span>
<span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="n">dataMat</span><span class="p">,</span> <span class="n">test_ratio</span><span class="p">,</span> <span class="n">Method</span><span class="p">,</span> <span class="n">Means</span><span class="p">):</span>
<span class="c1">#The number of users </span>
    <span class="n">users</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataMat</span><span class="p">)</span>
    <span class="n">total_error</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">total_count_u</span> <span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">users</span><span class="p">):</span>
        <span class="n">error_u</span><span class="p">,</span> <span class="n">count_u</span> <span class="o">=</span> <span class="n">cross_validate_user</span><span class="p">(</span><span class="n">dataMat</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">test_ratio</span><span class="p">,</span> <span class="n">estMethod</span><span class="o">=</span><span class="n">Method</span><span class="p">,</span> <span class="n">simMeas</span><span class="o">=</span><span class="n">Means</span><span class="p">)</span>
        <span class="n">total_error</span> <span class="o">+=</span> <span class="n">error_u</span>
        <span class="n">total_count_u</span> <span class="o">+=</span> <span class="n">count_u</span>
<span class="c1">#Calculating the MAE and returning the values </span>
    <span class="n">MAE</span> <span class="o">=</span> <span class="n">total_error</span><span class="o">/</span><span class="n">total_count_u</span>
    <span class="k">return</span> <span class="n">MAE</span><span class="p">;</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[63]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="c1">#MAE (std)</span>
<span class="n">std_MAE</span> <span class="o">=</span> <span class="n">test</span><span class="p">(</span><span class="n">jest_matrix</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">standEst</span><span class="p">,</span> <span class="n">pearsonSim</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>CPU times: total: 17min 4s
Wall time: 1min 43s
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[64]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#MAE for standard estimate</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MAE for standard estimate is: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">std_MAE</span><span class="p">))</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>MAE for standard estimate is: 3.739999840360228
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[65]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="c1">#MAE (svd)</span>
<span class="n">svd_MAE</span> <span class="o">=</span> <span class="n">test</span><span class="p">(</span><span class="n">jest_matrix</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">svdEst</span><span class="p">,</span> <span class="n">pearsonSim</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>CPU times: total: 34min 12s
Wall time: 3min 26s
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[66]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#MAE for SVD estimate</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MAE for SVD estimate is: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">svd_MAE</span><span class="p">))</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>MAE for SVD estimate is: 3.6574386053285197
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>c. [15 pts] Write a new function &quot;print_most_similar_jokes&quot; which outputs the most similar jokes (based on user ratings) to a specified query joke. You function should take as input the joke ratings data, a query joke id, a parameter k for the number similar jokes, and a similarity metric function. It should output the text of the query joke as well as the texts of the top k most similar jokes in decreasing order of similarity (you should also provide the similarity values). Test your function as follows:</p>
<ul>
<li>Show the top 3 most similar jokes to joke with id 9 using Pearson similarity.</li>
<li>Show the top 3 most similar jokes to Joke with id 9 using cosine similarity.</li>
</ul>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[67]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">knn_search</span><span class="p">(</span><span class="n">query_ratings_vector</span><span class="p">,</span> <span class="n">dataMat</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="n">cosineSim</span><span class="p">):</span>
    <span class="n">ratings_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">query_ratings_vector</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dataMat</span><span class="p">)</span>
    <span class="n">distances</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1">#Each joke from the data are compared </span>
<span class="c1">#With the rating vector</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dataMat</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">data_rating_vector</span> <span class="o">=</span> <span class="n">dataMat</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span>
        <span class="n">distances</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">metric</span><span class="p">(</span><span class="n">query_ratings_vector</span><span class="p">,</span> <span class="n">data_rating_vector</span><span class="p">))</span>  
    <span class="n">distances_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">distances</span><span class="p">);</span>
    <span class="n">distances_arr</span> <span class="o">=</span> <span class="n">distances_arr</span><span class="o">.</span><span class="n">argsort</span><span class="p">()</span>   
    <span class="n">kNeighbors</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">((</span><span class="n">k</span><span class="p">,</span><span class="n">dataMat</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="n">topIndicies</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">classCount</span><span class="o">=</span><span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
        <span class="n">kNeighbors</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">dataMat</span><span class="p">[</span><span class="n">distances_arr</span><span class="p">[</span><span class="n">i</span><span class="p">],:]</span>
        <span class="n">topIndicies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">distances_arr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">kNeighbors</span><span class="p">,</span> <span class="n">topIndicies</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[68]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">print_most_similar_jokes</span><span class="p">(</span><span class="n">dataMat</span><span class="p">,</span> <span class="n">jokes</span><span class="p">,</span> <span class="n">queryJoke</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="n">pearsonSim</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; Query joke id&#39;</span><span class="p">,</span><span class="n">queryJoke</span><span class="p">,</span> <span class="s1">&#39;query joke =&#39;</span><span class="p">,</span><span class="n">jokes</span><span class="p">[</span><span class="n">queryJoke</span><span class="p">])</span>
    <span class="n">kNeighbors</span><span class="p">,</span> <span class="n">topIndicies</span> <span class="o">=</span> <span class="n">knn_search</span><span class="p">(</span><span class="n">dataMat</span><span class="p">[:,</span><span class="n">queryJoke</span><span class="p">],</span> <span class="n">dataMat</span><span class="p">,</span> <span class="n">k</span> <span class="p">,</span> <span class="n">metric</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;The top </span><span class="si">%d</span><span class="s2"> recommended jokes are: &quot;</span><span class="o">%</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">topIndicies</span><span class="p">:</span>
        <span class="n">jok</span> <span class="o">=</span> <span class="n">jokes</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">()</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">,</span><span class="n">ind</span><span class="p">,</span><span class="s2">&quot; =&gt; &quot;</span><span class="p">,</span><span class="n">jok</span><span class="p">)</span>
    <span class="k">return</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[69]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Showing the top 3 most similar jokes using Pearson similarity</span>
<span class="n">print_most_similar_jokes</span><span class="p">(</span><span class="n">jest_matrix</span><span class="p">,</span><span class="n">jokes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">9</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">pearsonSim</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre> Query joke id 9 query joke = Two cannibals are eating a clown one turns to other and says: &quot;Does this taste funny to you? 
The top 3 recommended jokes are: 

# 4  =&gt;  Q. What&#39;s O. J. Simpson&#39;s Internet address? A.	Slash slash backslash slash slash escape.

# 18  =&gt;  Q: If a person who speaks three languages is called &quot;tri-lingual&quot; and a person who speaks two languages is called &quot;bi-lingual&quot; what do calla person who only speaks one language?A: American! 

# 30  =&gt;   President Clinton looks up from his desk in the Oval Office to see one of his aides nervously approach him.  &quot;What is it?&quot; exclaims the President. &quot;It&#39;s this Abortion Bill Mr. President what do you want to do about it?&quot; the aide replies. &quot;Just go ahead and pay it.&quot; responds the President. 
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[70]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Show the top 3 most similar jokes using Cosine Similarity</span>
<span class="n">print_most_similar_jokes</span><span class="p">(</span><span class="n">jest_matrix</span><span class="p">,</span><span class="n">jokes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">9</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">cosineSim</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre> Query joke id 9 query joke = Two cannibals are eating a clown one turns to other and says: &quot;Does this taste funny to you? 
The top 3 recommended jokes are: 

# 70  =&gt;  At a recent Sacramento PC Users Group meeting a company was demonstrating its latest speech-recognition software.   A representative from the company was just about ready to start the demonstration and asked everyone in the room to quiet down.Just then someone in the back of the room yelled&quot;Format C: Return.&quot;Someone else chimed in:&quot;Yes Return&quot;Unfortunately the software worked.

# 74  =&gt;  Q: Do you know the difference between an intelligent male and theSasquatch? A: There have been actual reported sightings of the Sasquatch.

# 73  =&gt;  Q: How many stalkers does it take to change a light bulb?A: Two. One to replace the bulb and the other to watch it day and night.
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>d. [15 pts] The implementation of item-based collaborative filtering provided in the module is not scalable since for each prediction it attempts to compute pairwise similarities among all items. Develop your own item-based collaborative filtering recommender that uses a model-based approach (separating the training and the prediction tasks). In the training component, item-item similarities for all pairs of items are computed and stored in an appropriate data structure such as a pairwise similarity matrix. Your training function should be able to use different similarity functions (passed as a parameter) including cosine Similarity or Pearson correlation. The prediction (or estimation) function should take as parameters a target user, an item, a value of k, and the similarities matrix computed in the training phase. It should then return the predicted rating on the target item for the target user. The predicted rating should be the weighted average of the target user&#39;s ratings on the k most similar items to the target item (obtained from the similarity matrix). Demonstrate that your function works by computing predicted ratings for users 4 and 25, using k = 10, on top two items recommended to each user on part a (using both Pearson and cosine similarities).</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[71]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">training_model</span><span class="p">(</span><span class="n">item_index</span><span class="p">,</span> <span class="n">dataMat</span><span class="p">,</span> <span class="n">metric</span><span class="p">):</span>
    <span class="n">query_ratings_vector</span> <span class="o">=</span> <span class="n">dataMat</span><span class="p">[:,</span><span class="n">item_index</span><span class="p">]</span>
    <span class="n">ratings_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">query_ratings_vector</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dataMat</span><span class="p">)</span>
    <span class="n">distances</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">dist_arr</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">similar_item_arr</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c1">#Each joke from the data are compared </span>
<span class="c1">#With the rating vector</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dataMat</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
<span class="c1">#Set the sim as 0, if the current item is same as i/p item</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="o">==</span><span class="n">item_index</span><span class="p">):</span>
            <span class="n">dist_arr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data_rating_vector</span> <span class="o">=</span> <span class="n">dataMat</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span>
            <span class="n">dist_arr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">metric</span><span class="p">(</span><span class="n">query_ratings_vector</span><span class="p">,</span> <span class="n">data_rating_vector</span><span class="p">))</span>
        <span class="n">similar_item_arr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">distances</span><span class="p">[</span><span class="n">item_index</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;distance&#39;</span> <span class="p">:</span> <span class="n">dist_arr</span><span class="p">,</span> <span class="s1">&#39;items&#39;</span> <span class="p">:</span> <span class="n">similar_item_arr</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">distances</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[72]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">prepare_training_model</span><span class="p">(</span><span class="n">dataMat</span><span class="p">,</span> <span class="n">metric</span><span class="p">):</span>
    <span class="n">distances</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dataMat</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">distances</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">training_model</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">dataMat</span><span class="p">,</span><span class="n">metric</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">distances</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[73]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">tpercent</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">tsize</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">tpercent</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">jest_matrix</span><span class="p">))</span>
<span class="c1">#training dataset is set to 80%</span>
<span class="n">train_data_set</span> <span class="o">=</span> <span class="n">jest_matrix</span><span class="p">[:</span><span class="n">tsize</span><span class="p">,:]</span> 
<span class="c1">#training dataset is set to 20%</span>
<span class="n">test_data_set</span> <span class="o">=</span> <span class="n">jest_matrix</span><span class="p">[</span><span class="n">tsize</span><span class="p">:,:]</span> 
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>CPU times: total: 0 ns
Wall time: 0 ns
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[74]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="n">user</span><span class="p">,</span><span class="n">item</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">ds</span><span class="p">):</span>
    <span class="n">user_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
    <span class="k">if</span><span class="p">(</span><span class="n">k</span><span class="o">==</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">user_df</span><span class="p">[</span><span class="n">item</span><span class="p">])[</span><span class="mi">0</span><span class="p">],[]</span> 
<span class="c1">#distance info </span>
<span class="c1">#item</span>
    <span class="n">distance</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="s1">&#39;distance&#39;</span><span class="p">]</span>
<span class="c1">#Distances are sorted   </span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span>
    <span class="n">top_k</span> <span class="o">=</span> <span class="n">idx</span><span class="p">[:</span><span class="n">k</span><span class="p">]</span>
    <span class="n">ratings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">user_df</span><span class="p">[</span><span class="n">top_k</span><span class="p">])</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">ratings</span><span class="p">)</span><span class="o">/</span><span class="n">k</span>
    <span class="k">return</span> <span class="n">dist</span><span class="p">,</span><span class="n">top_k</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[75]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Using the Cosine Similarity</span>
<span class="c1">#Part A and User 4</span>
<span class="n">values</span> <span class="o">=</span> <span class="n">prepare_training_model</span><span class="p">(</span><span class="n">train_data_set</span><span class="p">,</span> <span class="n">cosineSim</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">item</span> <span class="o">=</span> <span class="mi">71</span>
<span class="c1">#K = 4</span>
<span class="n">K</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">user_number</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">user</span> <span class="o">=</span> <span class="n">test_data_set</span><span class="p">[</span><span class="n">user_number</span><span class="p">]</span>
<span class="n">pred_rating</span><span class="p">,</span><span class="n">top_k</span> <span class="o">=</span> <span class="n">test</span><span class="p">(</span><span class="n">user</span><span class="p">,</span><span class="n">item</span><span class="p">,</span><span class="n">K</span><span class="p">,</span><span class="n">values</span><span class="p">)</span>
<span class="n">user_updated</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">user</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">user_updated</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="n">pred_rating</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;predicted rating for user:&#39;</span><span class="p">,</span> <span class="n">user_number</span><span class="p">,</span> <span class="s1">&#39; for item :&#39;</span><span class="p">,</span><span class="n">item</span><span class="p">,</span><span class="s1">&#39; </span><span class="se">\n</span><span class="s1">original rating &#39;</span><span class="p">,</span>
      <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">user</span><span class="p">)[</span><span class="n">item</span><span class="p">],</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">predicted rating &#39;</span><span class="p">,</span> <span class="n">user_updated</span><span class="p">[</span><span class="n">item</span><span class="p">],</span> <span class="s1">&#39;using cosine similarity.&#39;</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>predicted rating for user: 4  for item : 71  
original rating  0.0 
predicted rating  9.643 using cosine similarity.
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[76]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Using the Pearson Similarity</span>
<span class="c1">#Part A and User 4</span>
<span class="n">values</span> <span class="o">=</span> <span class="n">prepare_training_model</span><span class="p">(</span><span class="n">train_data_set</span><span class="p">,</span> <span class="n">pearsonSim</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">item</span> <span class="o">=</span> <span class="mi">71</span>
<span class="c1">#K = 10</span>
<span class="n">K</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">user_number</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">user</span> <span class="o">=</span> <span class="n">test_data_set</span><span class="p">[</span><span class="n">user_number</span><span class="p">]</span>
<span class="n">pred_rating</span><span class="p">,</span><span class="n">top_k</span> <span class="o">=</span> <span class="n">test</span><span class="p">(</span><span class="n">user</span><span class="p">,</span><span class="n">item</span><span class="p">,</span><span class="n">K</span><span class="p">,</span><span class="n">values</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;pred_rating &quot;</span><span class="p">,</span><span class="n">pred_rating</span><span class="p">)</span>
<span class="n">user_updated</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">user</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">user_updated</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="n">pred_rating</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;predicted rating for user:&#39;</span><span class="p">,</span> <span class="n">user_number</span><span class="p">,</span> <span class="s1">&#39; for item :&#39;</span><span class="p">,</span><span class="n">item</span><span class="p">,</span><span class="s1">&#39; </span><span class="se">\n</span><span class="s1">original rating &#39;</span><span class="p">,</span>
      <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">user</span><span class="p">)[</span><span class="n">item</span><span class="p">],</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">predicted rating &#39;</span><span class="p">,</span> <span class="n">user_updated</span><span class="p">[</span><span class="n">item</span><span class="p">],</span> <span class="s1">&#39;using pearson similarity.&#39;</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>pred_rating  9.604
predicted rating for user: 4  for item : 71  
original rating  0.0 
predicted rating  9.604 using pearson similarity.
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[77]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Using the Cosine Similarity</span>
<span class="c1">#Part A and User 25</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">item</span> <span class="o">=</span> <span class="mi">99</span>
<span class="c1">#K = 10</span>
<span class="n">K</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">user_number</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">user</span> <span class="o">=</span> <span class="n">test_data_set</span><span class="p">[</span><span class="n">user_number</span><span class="p">]</span>
<span class="n">pred_rating</span><span class="p">,</span><span class="n">top_k</span> <span class="o">=</span> <span class="n">test</span><span class="p">(</span><span class="n">user</span><span class="p">,</span><span class="n">item</span><span class="p">,</span><span class="n">K</span><span class="p">,</span><span class="n">values</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;pred_rating &quot;</span><span class="p">,</span><span class="n">pred_rating</span><span class="p">)</span>
<span class="n">user_updated</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">user</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">user_updated</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="n">pred_rating</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;predicted rating for user:&#39;</span><span class="p">,</span> <span class="n">user_number</span><span class="p">,</span> <span class="s1">&#39; for item :&#39;</span><span class="p">,</span><span class="n">item</span><span class="p">,</span><span class="s1">&#39; </span><span class="se">\n</span><span class="s1">original rating &#39;</span><span class="p">,</span>
      <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">user</span><span class="p">)[</span><span class="n">item</span><span class="p">],</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">predicted rating &#39;</span><span class="p">,</span> <span class="n">user_updated</span><span class="p">[</span><span class="n">item</span><span class="p">],</span> <span class="s1">&#39;using cosine similarity.&#39;</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>pred_rating  9.154
predicted rating for user: 25  for item : 99  
original rating  0.0 
predicted rating  9.154 using cosine similarity.
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[78]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Using the Pearson Similarity</span>
<span class="c1">#Part A and User 25</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">item</span> <span class="o">=</span> <span class="mi">71</span>
<span class="c1">#K = 10</span>
<span class="n">K</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">user_number</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">user</span> <span class="o">=</span> <span class="n">test_data_set</span><span class="p">[</span><span class="n">user_number</span><span class="p">]</span>
<span class="n">pred_rating</span><span class="p">,</span><span class="n">top_k</span> <span class="o">=</span> <span class="n">test</span><span class="p">(</span><span class="n">user</span><span class="p">,</span><span class="n">item</span><span class="p">,</span><span class="n">K</span><span class="p">,</span><span class="n">values</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;pred_rating &quot;</span><span class="p">,</span><span class="n">pred_rating</span><span class="p">)</span>
<span class="n">user_updated</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">user</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">user_updated</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="n">pred_rating</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;predicted rating for user:&#39;</span><span class="p">,</span> <span class="n">user_number</span><span class="p">,</span> <span class="s1">&#39; for item :&#39;</span><span class="p">,</span><span class="n">item</span><span class="p">,</span><span class="s1">&#39; </span><span class="se">\n</span><span class="s1">original rating &#39;</span><span class="p">,</span>
      <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">user</span><span class="p">)[</span><span class="n">item</span><span class="p">],</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">predicted rating &#39;</span><span class="p">,</span> <span class="n">user_updated</span><span class="p">[</span><span class="n">item</span><span class="p">],</span> <span class="s1">&#39;using pearson similarity.&#39;</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>pred_rating  9.604
predicted rating for user: 4  for item : 71  
original rating  0.0 
predicted rating  9.604 using pearson similarity.
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>e. [Extra Credit - 10 pts] Modify the &quot;cross_validate_user&quot; and  &quot;test&quot; functions as necessary to use the new version of the prediction function (from part d). First test the prediction accuracy of your prediction function (similarly to part b, above) using both cosine and Pearson similarity measures. Next, provide a plot of cross-validation accuracies across a range of values of k. (running the &quot;test&quot; function for each value of k). Your plot may look similar to this example. Next, Modify the &quot;recommend&quot; function to use your new prediction function. Using the best observed value of k from your plot demonstrate the functionality of your recommender by generating top 3 recommendations for users 4 and 25.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[79]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">cross_validate_user_modified</span><span class="p">(</span><span class="n">dataMat</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">predicted_rating</span><span class="p">,</span><span class="n">item</span><span class="p">):</span>
    <span class="n">dataMat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dataMat</span><span class="p">)</span>
    <span class="n">original_user_profile</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">dataMat</span><span class="p">[</span><span class="n">user</span><span class="p">])</span>
    <span class="n">original_user_rating</span> <span class="o">=</span> <span class="n">original_user_profile</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
    <span class="n">error_u</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">original_user_rating</span> <span class="o">-</span> <span class="n">predicted_rating</span><span class="p">)</span>
<span class="c1">#Sum of abs errors and count of test cases are returned</span>
<span class="c1">#Computing MAE</span>
    <span class="k">return</span> <span class="n">error_u</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[80]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">error</span> <span class="o">=</span> <span class="n">cross_validate_user_modified</span><span class="p">(</span><span class="n">test_data_set</span><span class="p">,</span><span class="n">user_number</span><span class="p">,</span><span class="n">pred_rating</span><span class="p">,</span><span class="n">item</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;error &quot;</span><span class="p">,</span><span class="n">error</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">test_data_set</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> 
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>error  9.604
100
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>

     </div>
</div>
</div>
</div>

</div>









<script type="module" src="https://s.brightspace.com/lib/bsi/20.23.2-186/unbundled/mathjax.js"></script><script type="text/javascript">document.addEventListener('DOMContentLoaded', function() {
					if (document.querySelector('math') || /\$\$|\\\(|\\\[|\\begin{|\\ref{|\\eqref{/.test(document.body.innerHTML)) {
						document.querySelectorAll('mspace[linebreak="newline"]').forEach(elm => {
							elm.setAttribute('style', 'display: block; height: 0.5rem;');
						});

						window.D2L.MathJax.loadMathJax({
							'outputScale': 1.3,
							'renderLatex': false
						});
					}
				});</script><script type="module" src="https://s.brightspace.com/lib/bsi/20.23.2-186/unbundled/prism.js"></script><script type="text/javascript">document.addEventListener('DOMContentLoaded', function() {
					document.querySelectorAll('.d2l-code').forEach(code => {
						window.D2L.Prism.formatCodeElement(code);
					});
				});</script></body></html>