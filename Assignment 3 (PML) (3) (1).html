<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html><head></head><body>















    




    
    
    
    


<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h1>Goutham Selvakumar<a rel="noopener" class="anchor-link" href="#Goutham-Selvakumar">&#182;</a></h1><h1>Assignment - 3 (DSC 478)<a rel="noopener" class="anchor-link" href="#Assignment---3-(DSC-478)">&#182;</a></h1><h1>Question 1<a rel="noopener" class="anchor-link" href="#Question-1">&#182;</a></h1><p>a. [5 pts] Load and preprocess the data using Pandas and remove the unneeded attributes. For the purpose of this assignment you do not need to normalize or standardize the data unless explicitly required in one of the following tasks. However, you may need to handle missing values by imputing those values based on variable means. Compute and display basic statistics (mean, standard deviation, min, max, etc.) for the variables in the data set. Separate the target attribute for regression. Use scikit-learn&#39;s train_test_split function to create a 20%-80% randomized split of the data (important note: for reporducible output across multiple runs, please use &quot;random_state = 33&quot;). Set aside the 20% test portion; the 80% training data partition will be used for cross-validation on various tasks specified below.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[175]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Importing the Packages </span>
<span class="c1">#Running it </span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pylab</span> <span class="k">as</span> <span class="nn">pl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="c1">#Using the Sci-kit learn</span>
<span class="c1">#Running it</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">KFold</span><span class="p">,</span> <span class="n">train_test_split</span><span class="p">,</span> <span class="n">cross_val_score</span><span class="p">,</span> <span class="n">cross_validate</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span><span class="p">,</span> <span class="n">Lasso</span><span class="p">,</span> <span class="n">Ridge</span><span class="p">,</span> <span class="n">ElasticNet</span><span class="p">,</span> <span class="n">SGDRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">feature_selection</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[176]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Reading the Communities.CSV file </span>
<span class="c1">#Showing 5 rows of Communities.CSV file</span>
<span class="n">comm</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;C:/Users/admin/Desktop/1/communities.csv&quot;</span><span class="p">,</span> <span class="n">na_values</span> <span class="o">=</span><span class="p">[</span><span class="s2">&quot;?&quot;</span><span class="p">,</span> <span class="s2">&quot;Null&quot;</span><span class="p">,</span> <span class="s2">&quot;missing&quot;</span><span class="p">])</span>
<span class="n">comm</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[176]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>communityname</th>
      <th>population</th>
      <th>householdsize</th>
      <th>racepctblack</th>
      <th>racePctWhite</th>
      <th>racePctAsian</th>
      <th>racePctHisp</th>
      <th>agePct12t21</th>
      <th>agePct12t29</th>
      <th>...</th>
      <th>NumStreet</th>
      <th>PctForeignBorn</th>
      <th>PctBornSameState</th>
      <th>PctSameHouse85</th>
      <th>PctSameCity85</th>
      <th>PctSameState85</th>
      <th>LandArea</th>
      <th>PopDens</th>
      <th>PctUsePubTrans</th>
      <th>ViolentCrimesPerPop</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>8</td>
      <td>Lakewoodcity</td>
      <td>0.19</td>
      <td>0.33</td>
      <td>0.02</td>
      <td>0.90</td>
      <td>0.12</td>
      <td>0.17</td>
      <td>0.34</td>
      <td>0.47</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.12</td>
      <td>0.42</td>
      <td>0.50</td>
      <td>0.51</td>
      <td>0.64</td>
      <td>0.12</td>
      <td>0.26</td>
      <td>0.20</td>
      <td>0.20</td>
    </tr>
    <tr>
      <th>1</th>
      <td>53</td>
      <td>Tukwilacity</td>
      <td>0.00</td>
      <td>0.16</td>
      <td>0.12</td>
      <td>0.74</td>
      <td>0.45</td>
      <td>0.07</td>
      <td>0.26</td>
      <td>0.59</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.21</td>
      <td>0.50</td>
      <td>0.34</td>
      <td>0.60</td>
      <td>0.52</td>
      <td>0.02</td>
      <td>0.12</td>
      <td>0.45</td>
      <td>0.67</td>
    </tr>
    <tr>
      <th>2</th>
      <td>24</td>
      <td>Aberdeentown</td>
      <td>0.00</td>
      <td>0.42</td>
      <td>0.49</td>
      <td>0.56</td>
      <td>0.17</td>
      <td>0.04</td>
      <td>0.39</td>
      <td>0.47</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.14</td>
      <td>0.49</td>
      <td>0.54</td>
      <td>0.67</td>
      <td>0.56</td>
      <td>0.01</td>
      <td>0.21</td>
      <td>0.02</td>
      <td>0.43</td>
    </tr>
    <tr>
      <th>3</th>
      <td>34</td>
      <td>Willingborotownship</td>
      <td>0.04</td>
      <td>0.77</td>
      <td>1.00</td>
      <td>0.08</td>
      <td>0.12</td>
      <td>0.10</td>
      <td>0.51</td>
      <td>0.50</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.19</td>
      <td>0.30</td>
      <td>0.73</td>
      <td>0.64</td>
      <td>0.65</td>
      <td>0.02</td>
      <td>0.39</td>
      <td>0.28</td>
      <td>0.12</td>
    </tr>
    <tr>
      <th>4</th>
      <td>42</td>
      <td>Bethlehemtownship</td>
      <td>0.01</td>
      <td>0.55</td>
      <td>0.02</td>
      <td>0.95</td>
      <td>0.09</td>
      <td>0.05</td>
      <td>0.38</td>
      <td>0.38</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.11</td>
      <td>0.72</td>
      <td>0.64</td>
      <td>0.61</td>
      <td>0.53</td>
      <td>0.04</td>
      <td>0.09</td>
      <td>0.02</td>
      <td>0.03</td>
    </tr>
  </tbody>
</table>
<p>5 rows &#215; 100 columns</p>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[177]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Getting the info on the Community.CSV </span>
<span class="n">comm</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 1994 entries, 0 to 1993
Data columns (total 100 columns):
 #   Column                 Non-Null Count  Dtype  
---  ------                 --------------  -----  
 0   state                  1994 non-null   int64  
 1   communityname          1994 non-null   object 
 2   population             1994 non-null   float64
 3   householdsize          1994 non-null   float64
 4   racepctblack           1994 non-null   float64
 5   racePctWhite           1994 non-null   float64
 6   racePctAsian           1994 non-null   float64
 7   racePctHisp            1994 non-null   float64
 8   agePct12t21            1994 non-null   float64
 9   agePct12t29            1994 non-null   float64
 10  agePct16t24            1994 non-null   float64
 11  agePct65up             1994 non-null   float64
 12  numbUrban              1994 non-null   float64
 13  pctUrban               1994 non-null   float64
 14  medIncome              1994 non-null   float64
 15  pctWWage               1994 non-null   float64
 16  pctWFarmSelf           1994 non-null   float64
 17  pctWInvInc             1994 non-null   float64
 18  pctWSocSec             1994 non-null   float64
 19  pctWPubAsst            1994 non-null   float64
 20  pctWRetire             1994 non-null   float64
 21  medFamInc              1994 non-null   float64
 22  perCapInc              1994 non-null   float64
 23  whitePerCap            1994 non-null   float64
 24  blackPerCap            1994 non-null   float64
 25  indianPerCap           1994 non-null   float64
 26  AsianPerCap            1994 non-null   float64
 27  OtherPerCap            1993 non-null   float64
 28  HispPerCap             1994 non-null   float64
 29  NumUnderPov            1994 non-null   float64
 30  PctPopUnderPov         1994 non-null   float64
 31  PctLess9thGrade        1994 non-null   float64
 32  PctNotHSGrad           1994 non-null   float64
 33  PctBSorMore            1994 non-null   float64
 34  PctUnemployed          1994 non-null   float64
 35  PctEmploy              1994 non-null   float64
 36  PctEmplManu            1994 non-null   float64
 37  PctEmplProfServ        1994 non-null   float64
 38  MalePctDivorce         1994 non-null   float64
 39  MalePctNevMarr         1994 non-null   float64
 40  FemalePctDiv           1994 non-null   float64
 41  TotalPctDiv            1994 non-null   float64
 42  PersPerFam             1994 non-null   float64
 43  PctFam2Par             1994 non-null   float64
 44  PctKids2Par            1994 non-null   float64
 45  PctYoungKids2Par       1994 non-null   float64
 46  PctTeen2Par            1994 non-null   float64
 47  PctWorkMomYoungKids    1994 non-null   float64
 48  PctWorkMom             1994 non-null   float64
 49  NumIlleg               1994 non-null   float64
 50  PctIlleg               1994 non-null   float64
 51  NumImmig               1994 non-null   float64
 52  PctImmigRecent         1994 non-null   float64
 53  PctImmigRec5           1994 non-null   float64
 54  PctImmigRec8           1994 non-null   float64
 55  PctImmigRec10          1994 non-null   float64
 56  PctRecentImmig         1994 non-null   float64
 57  PctRecImmig5           1994 non-null   float64
 58  PctRecImmig8           1994 non-null   float64
 59  PctRecImmig10          1994 non-null   float64
 60  PctSpeakEnglOnly       1994 non-null   float64
 61  PctNotSpeakEnglWell    1994 non-null   float64
 62  PctLargHouseFam        1994 non-null   float64
 63  PctLargHouseOccup      1994 non-null   float64
 64  PersPerOccupHous       1994 non-null   float64
 65  PersPerOwnOccHous      1994 non-null   float64
 66  PersPerRentOccHous     1994 non-null   float64
 67  PctPersOwnOccup        1994 non-null   float64
 68  PctPersDenseHous       1994 non-null   float64
 69  PctHousLess3BR         1994 non-null   float64
 70  MedNumBR               1994 non-null   float64
 71  HousVacant             1994 non-null   float64
 72  PctHousOccup           1994 non-null   float64
 73  PctHousOwnOcc          1994 non-null   float64
 74  PctVacantBoarded       1994 non-null   float64
 75  PctVacMore6Mos         1994 non-null   float64
 76  MedYrHousBuilt         1994 non-null   float64
 77  PctHousNoPhone         1994 non-null   float64
 78  PctWOFullPlumb         1994 non-null   float64
 79  OwnOccLowQuart         1994 non-null   float64
 80  OwnOccMedVal           1994 non-null   float64
 81  OwnOccHiQuart          1994 non-null   float64
 82  RentLowQ               1994 non-null   float64
 83  RentMedian             1994 non-null   float64
 84  RentHighQ              1994 non-null   float64
 85  MedRent                1994 non-null   float64
 86  MedRentPctHousInc      1994 non-null   float64
 87  MedOwnCostPctInc       1994 non-null   float64
 88  MedOwnCostPctIncNoMtg  1994 non-null   float64
 89  NumInShelters          1994 non-null   float64
 90  NumStreet              1994 non-null   float64
 91  PctForeignBorn         1994 non-null   float64
 92  PctBornSameState       1994 non-null   float64
 93  PctSameHouse85         1994 non-null   float64
 94  PctSameCity85          1994 non-null   float64
 95  PctSameState85         1994 non-null   float64
 96  LandArea               1994 non-null   float64
 97  PopDens                1994 non-null   float64
 98  PctUsePubTrans         1994 non-null   float64
 99  ViolentCrimesPerPop    1994 non-null   float64
dtypes: float64(98), int64(1), object(1)
memory usage: 1.5+ MB
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[178]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Showing the statistics of Community.CSV files</span>
<span class="n">comm</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[178]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>communityname</th>
      <th>population</th>
      <th>householdsize</th>
      <th>racepctblack</th>
      <th>racePctWhite</th>
      <th>racePctAsian</th>
      <th>racePctHisp</th>
      <th>agePct12t21</th>
      <th>agePct12t29</th>
      <th>...</th>
      <th>NumStreet</th>
      <th>PctForeignBorn</th>
      <th>PctBornSameState</th>
      <th>PctSameHouse85</th>
      <th>PctSameCity85</th>
      <th>PctSameState85</th>
      <th>LandArea</th>
      <th>PopDens</th>
      <th>PctUsePubTrans</th>
      <th>ViolentCrimesPerPop</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1994.00</td>
      <td>1994</td>
      <td>1994.00</td>
      <td>1994.00</td>
      <td>1994.00</td>
      <td>1994.00</td>
      <td>1994.00</td>
      <td>1994.00</td>
      <td>1994.00</td>
      <td>1994.00</td>
      <td>...</td>
      <td>1994.00</td>
      <td>1994.00</td>
      <td>1994.00</td>
      <td>1994.00</td>
      <td>1994.00</td>
      <td>1994.00</td>
      <td>1994.00</td>
      <td>1994.00</td>
      <td>1994.00</td>
      <td>1994.00</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>NaN</td>
      <td>1828</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>top</th>
      <td>NaN</td>
      <td>Greenvillecity</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>NaN</td>
      <td>5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>28.68</td>
      <td>NaN</td>
      <td>0.06</td>
      <td>0.46</td>
      <td>0.18</td>
      <td>0.75</td>
      <td>0.15</td>
      <td>0.14</td>
      <td>0.42</td>
      <td>0.49</td>
      <td>...</td>
      <td>0.02</td>
      <td>0.22</td>
      <td>0.61</td>
      <td>0.54</td>
      <td>0.63</td>
      <td>0.65</td>
      <td>0.07</td>
      <td>0.23</td>
      <td>0.16</td>
      <td>0.24</td>
    </tr>
    <tr>
      <th>std</th>
      <td>16.40</td>
      <td>NaN</td>
      <td>0.13</td>
      <td>0.16</td>
      <td>0.25</td>
      <td>0.24</td>
      <td>0.21</td>
      <td>0.23</td>
      <td>0.16</td>
      <td>0.14</td>
      <td>...</td>
      <td>0.10</td>
      <td>0.23</td>
      <td>0.20</td>
      <td>0.18</td>
      <td>0.20</td>
      <td>0.20</td>
      <td>0.11</td>
      <td>0.20</td>
      <td>0.23</td>
      <td>0.23</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.00</td>
      <td>NaN</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>...</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>12.00</td>
      <td>NaN</td>
      <td>0.01</td>
      <td>0.35</td>
      <td>0.02</td>
      <td>0.63</td>
      <td>0.04</td>
      <td>0.01</td>
      <td>0.34</td>
      <td>0.41</td>
      <td>...</td>
      <td>0.00</td>
      <td>0.06</td>
      <td>0.47</td>
      <td>0.42</td>
      <td>0.52</td>
      <td>0.56</td>
      <td>0.02</td>
      <td>0.10</td>
      <td>0.02</td>
      <td>0.07</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>34.00</td>
      <td>NaN</td>
      <td>0.02</td>
      <td>0.44</td>
      <td>0.06</td>
      <td>0.85</td>
      <td>0.07</td>
      <td>0.04</td>
      <td>0.40</td>
      <td>0.48</td>
      <td>...</td>
      <td>0.00</td>
      <td>0.13</td>
      <td>0.63</td>
      <td>0.54</td>
      <td>0.67</td>
      <td>0.70</td>
      <td>0.04</td>
      <td>0.17</td>
      <td>0.07</td>
      <td>0.15</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>42.00</td>
      <td>NaN</td>
      <td>0.05</td>
      <td>0.54</td>
      <td>0.23</td>
      <td>0.94</td>
      <td>0.17</td>
      <td>0.16</td>
      <td>0.47</td>
      <td>0.54</td>
      <td>...</td>
      <td>0.00</td>
      <td>0.28</td>
      <td>0.78</td>
      <td>0.66</td>
      <td>0.77</td>
      <td>0.79</td>
      <td>0.07</td>
      <td>0.28</td>
      <td>0.19</td>
      <td>0.33</td>
    </tr>
    <tr>
      <th>max</th>
      <td>56.00</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>...</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
    </tr>
  </tbody>
</table>
<p>11 rows &#215; 100 columns</p>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[179]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Counting the missing values</span>
<span class="c1">#In each row and column</span>
<span class="n">comm</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[179]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>1</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[180]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">comm</span><span class="p">[</span><span class="n">comm</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[180]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>communityname</th>
      <th>population</th>
      <th>householdsize</th>
      <th>racepctblack</th>
      <th>racePctWhite</th>
      <th>racePctAsian</th>
      <th>racePctHisp</th>
      <th>agePct12t21</th>
      <th>agePct12t29</th>
      <th>...</th>
      <th>NumStreet</th>
      <th>PctForeignBorn</th>
      <th>PctBornSameState</th>
      <th>PctSameHouse85</th>
      <th>PctSameCity85</th>
      <th>PctSameState85</th>
      <th>LandArea</th>
      <th>PopDens</th>
      <th>PctUsePubTrans</th>
      <th>ViolentCrimesPerPop</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>130</th>
      <td>28</td>
      <td>Natchezcity</td>
      <td>0.02</td>
      <td>0.38</td>
      <td>0.98</td>
      <td>0.22</td>
      <td>0.01</td>
      <td>0.01</td>
      <td>0.44</td>
      <td>0.4</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.01</td>
      <td>0.84</td>
      <td>0.7</td>
      <td>0.83</td>
      <td>0.77</td>
      <td>0.04</td>
      <td>0.12</td>
      <td>0.05</td>
      <td>0.23</td>
    </tr>
  </tbody>
</table>
<p>1 rows &#215; 100 columns</p>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[181]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#The Other_Per_Cap_mean is replaced for it&#39;s </span>
<span class="c1">#missing value with it&#39;s mean</span>
<span class="n">Other_Per_Cap_mean</span> <span class="o">=</span> <span class="n">comm</span><span class="o">.</span><span class="n">OtherPerCap</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">comm</span><span class="o">.</span><span class="n">OtherPerCap</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">Other_Per_Cap_mean</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[182]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#There are no null values present </span>
<span class="c1">#In the Community.CSV File</span>
<span class="n">comm</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 1994 entries, 0 to 1993
Data columns (total 100 columns):
 #   Column                 Non-Null Count  Dtype  
---  ------                 --------------  -----  
 0   state                  1994 non-null   int64  
 1   communityname          1994 non-null   object 
 2   population             1994 non-null   float64
 3   householdsize          1994 non-null   float64
 4   racepctblack           1994 non-null   float64
 5   racePctWhite           1994 non-null   float64
 6   racePctAsian           1994 non-null   float64
 7   racePctHisp            1994 non-null   float64
 8   agePct12t21            1994 non-null   float64
 9   agePct12t29            1994 non-null   float64
 10  agePct16t24            1994 non-null   float64
 11  agePct65up             1994 non-null   float64
 12  numbUrban              1994 non-null   float64
 13  pctUrban               1994 non-null   float64
 14  medIncome              1994 non-null   float64
 15  pctWWage               1994 non-null   float64
 16  pctWFarmSelf           1994 non-null   float64
 17  pctWInvInc             1994 non-null   float64
 18  pctWSocSec             1994 non-null   float64
 19  pctWPubAsst            1994 non-null   float64
 20  pctWRetire             1994 non-null   float64
 21  medFamInc              1994 non-null   float64
 22  perCapInc              1994 non-null   float64
 23  whitePerCap            1994 non-null   float64
 24  blackPerCap            1994 non-null   float64
 25  indianPerCap           1994 non-null   float64
 26  AsianPerCap            1994 non-null   float64
 27  OtherPerCap            1994 non-null   float64
 28  HispPerCap             1994 non-null   float64
 29  NumUnderPov            1994 non-null   float64
 30  PctPopUnderPov         1994 non-null   float64
 31  PctLess9thGrade        1994 non-null   float64
 32  PctNotHSGrad           1994 non-null   float64
 33  PctBSorMore            1994 non-null   float64
 34  PctUnemployed          1994 non-null   float64
 35  PctEmploy              1994 non-null   float64
 36  PctEmplManu            1994 non-null   float64
 37  PctEmplProfServ        1994 non-null   float64
 38  MalePctDivorce         1994 non-null   float64
 39  MalePctNevMarr         1994 non-null   float64
 40  FemalePctDiv           1994 non-null   float64
 41  TotalPctDiv            1994 non-null   float64
 42  PersPerFam             1994 non-null   float64
 43  PctFam2Par             1994 non-null   float64
 44  PctKids2Par            1994 non-null   float64
 45  PctYoungKids2Par       1994 non-null   float64
 46  PctTeen2Par            1994 non-null   float64
 47  PctWorkMomYoungKids    1994 non-null   float64
 48  PctWorkMom             1994 non-null   float64
 49  NumIlleg               1994 non-null   float64
 50  PctIlleg               1994 non-null   float64
 51  NumImmig               1994 non-null   float64
 52  PctImmigRecent         1994 non-null   float64
 53  PctImmigRec5           1994 non-null   float64
 54  PctImmigRec8           1994 non-null   float64
 55  PctImmigRec10          1994 non-null   float64
 56  PctRecentImmig         1994 non-null   float64
 57  PctRecImmig5           1994 non-null   float64
 58  PctRecImmig8           1994 non-null   float64
 59  PctRecImmig10          1994 non-null   float64
 60  PctSpeakEnglOnly       1994 non-null   float64
 61  PctNotSpeakEnglWell    1994 non-null   float64
 62  PctLargHouseFam        1994 non-null   float64
 63  PctLargHouseOccup      1994 non-null   float64
 64  PersPerOccupHous       1994 non-null   float64
 65  PersPerOwnOccHous      1994 non-null   float64
 66  PersPerRentOccHous     1994 non-null   float64
 67  PctPersOwnOccup        1994 non-null   float64
 68  PctPersDenseHous       1994 non-null   float64
 69  PctHousLess3BR         1994 non-null   float64
 70  MedNumBR               1994 non-null   float64
 71  HousVacant             1994 non-null   float64
 72  PctHousOccup           1994 non-null   float64
 73  PctHousOwnOcc          1994 non-null   float64
 74  PctVacantBoarded       1994 non-null   float64
 75  PctVacMore6Mos         1994 non-null   float64
 76  MedYrHousBuilt         1994 non-null   float64
 77  PctHousNoPhone         1994 non-null   float64
 78  PctWOFullPlumb         1994 non-null   float64
 79  OwnOccLowQuart         1994 non-null   float64
 80  OwnOccMedVal           1994 non-null   float64
 81  OwnOccHiQuart          1994 non-null   float64
 82  RentLowQ               1994 non-null   float64
 83  RentMedian             1994 non-null   float64
 84  RentHighQ              1994 non-null   float64
 85  MedRent                1994 non-null   float64
 86  MedRentPctHousInc      1994 non-null   float64
 87  MedOwnCostPctInc       1994 non-null   float64
 88  MedOwnCostPctIncNoMtg  1994 non-null   float64
 89  NumInShelters          1994 non-null   float64
 90  NumStreet              1994 non-null   float64
 91  PctForeignBorn         1994 non-null   float64
 92  PctBornSameState       1994 non-null   float64
 93  PctSameHouse85         1994 non-null   float64
 94  PctSameCity85          1994 non-null   float64
 95  PctSameState85         1994 non-null   float64
 96  LandArea               1994 non-null   float64
 97  PopDens                1994 non-null   float64
 98  PctUsePubTrans         1994 non-null   float64
 99  ViolentCrimesPerPop    1994 non-null   float64
dtypes: float64(98), int64(1), object(1)
memory usage: 1.5+ MB
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[183]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Showing the statistics of Community.CSV files</span>
<span class="c1">#Representing it in the Transpose (T)</span>
<span class="n">comm</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[183]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>state</th>
      <td>1994.0</td>
      <td>28.68</td>
      <td>16.40</td>
      <td>1.0</td>
      <td>12.00</td>
      <td>34.00</td>
      <td>42.00</td>
      <td>56.0</td>
    </tr>
    <tr>
      <th>population</th>
      <td>1994.0</td>
      <td>0.06</td>
      <td>0.13</td>
      <td>0.0</td>
      <td>0.01</td>
      <td>0.02</td>
      <td>0.05</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>householdsize</th>
      <td>1994.0</td>
      <td>0.46</td>
      <td>0.16</td>
      <td>0.0</td>
      <td>0.35</td>
      <td>0.44</td>
      <td>0.54</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>racepctblack</th>
      <td>1994.0</td>
      <td>0.18</td>
      <td>0.25</td>
      <td>0.0</td>
      <td>0.02</td>
      <td>0.06</td>
      <td>0.23</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>racePctWhite</th>
      <td>1994.0</td>
      <td>0.75</td>
      <td>0.24</td>
      <td>0.0</td>
      <td>0.63</td>
      <td>0.85</td>
      <td>0.94</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>PctSameState85</th>
      <td>1994.0</td>
      <td>0.65</td>
      <td>0.20</td>
      <td>0.0</td>
      <td>0.56</td>
      <td>0.70</td>
      <td>0.79</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>LandArea</th>
      <td>1994.0</td>
      <td>0.07</td>
      <td>0.11</td>
      <td>0.0</td>
      <td>0.02</td>
      <td>0.04</td>
      <td>0.07</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>PopDens</th>
      <td>1994.0</td>
      <td>0.23</td>
      <td>0.20</td>
      <td>0.0</td>
      <td>0.10</td>
      <td>0.17</td>
      <td>0.28</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>PctUsePubTrans</th>
      <td>1994.0</td>
      <td>0.16</td>
      <td>0.23</td>
      <td>0.0</td>
      <td>0.02</td>
      <td>0.07</td>
      <td>0.19</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>ViolentCrimesPerPop</th>
      <td>1994.0</td>
      <td>0.24</td>
      <td>0.23</td>
      <td>0.0</td>
      <td>0.07</td>
      <td>0.15</td>
      <td>0.33</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>99 rows &#215; 8 columns</p>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[184]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#The State and the CommunityName is removed from the dataframe</span>
<span class="n">comm_table</span> <span class="o">=</span> <span class="n">comm</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">:]</span>
<span class="n">comm_table</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[184]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>population</th>
      <th>householdsize</th>
      <th>racepctblack</th>
      <th>racePctWhite</th>
      <th>racePctAsian</th>
      <th>racePctHisp</th>
      <th>agePct12t21</th>
      <th>agePct12t29</th>
      <th>agePct16t24</th>
      <th>agePct65up</th>
      <th>...</th>
      <th>NumStreet</th>
      <th>PctForeignBorn</th>
      <th>PctBornSameState</th>
      <th>PctSameHouse85</th>
      <th>PctSameCity85</th>
      <th>PctSameState85</th>
      <th>LandArea</th>
      <th>PopDens</th>
      <th>PctUsePubTrans</th>
      <th>ViolentCrimesPerPop</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.19</td>
      <td>0.33</td>
      <td>0.02</td>
      <td>0.90</td>
      <td>0.12</td>
      <td>0.17</td>
      <td>0.34</td>
      <td>0.47</td>
      <td>0.29</td>
      <td>0.32</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.12</td>
      <td>0.42</td>
      <td>0.50</td>
      <td>0.51</td>
      <td>0.64</td>
      <td>0.12</td>
      <td>0.26</td>
      <td>0.20</td>
      <td>0.20</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.00</td>
      <td>0.16</td>
      <td>0.12</td>
      <td>0.74</td>
      <td>0.45</td>
      <td>0.07</td>
      <td>0.26</td>
      <td>0.59</td>
      <td>0.35</td>
      <td>0.27</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.21</td>
      <td>0.50</td>
      <td>0.34</td>
      <td>0.60</td>
      <td>0.52</td>
      <td>0.02</td>
      <td>0.12</td>
      <td>0.45</td>
      <td>0.67</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.00</td>
      <td>0.42</td>
      <td>0.49</td>
      <td>0.56</td>
      <td>0.17</td>
      <td>0.04</td>
      <td>0.39</td>
      <td>0.47</td>
      <td>0.28</td>
      <td>0.32</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.14</td>
      <td>0.49</td>
      <td>0.54</td>
      <td>0.67</td>
      <td>0.56</td>
      <td>0.01</td>
      <td>0.21</td>
      <td>0.02</td>
      <td>0.43</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.04</td>
      <td>0.77</td>
      <td>1.00</td>
      <td>0.08</td>
      <td>0.12</td>
      <td>0.10</td>
      <td>0.51</td>
      <td>0.50</td>
      <td>0.34</td>
      <td>0.21</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.19</td>
      <td>0.30</td>
      <td>0.73</td>
      <td>0.64</td>
      <td>0.65</td>
      <td>0.02</td>
      <td>0.39</td>
      <td>0.28</td>
      <td>0.12</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.01</td>
      <td>0.55</td>
      <td>0.02</td>
      <td>0.95</td>
      <td>0.09</td>
      <td>0.05</td>
      <td>0.38</td>
      <td>0.38</td>
      <td>0.23</td>
      <td>0.36</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.11</td>
      <td>0.72</td>
      <td>0.64</td>
      <td>0.61</td>
      <td>0.53</td>
      <td>0.04</td>
      <td>0.09</td>
      <td>0.02</td>
      <td>0.03</td>
    </tr>
  </tbody>
</table>
<p>5 rows &#215; 98 columns</p>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[185]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Target Variable </span>
<span class="c1">#Is separated from the dataframe </span>
<span class="n">tar</span> <span class="o">=</span> <span class="n">comm_table</span><span class="o">.</span><span class="n">ViolentCrimesPerPop</span>
<span class="n">tr</span> <span class="o">=</span> <span class="n">comm_table</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[186]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Importing the packages of train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="c1">#The training and the testing data is being splitted </span>
<span class="c1">#Train - tr</span>
<span class="c1">#Testing - te</span>
<span class="n">X_tr</span><span class="p">,</span> <span class="n">X_te</span><span class="p">,</span> <span class="n">Y_tr</span><span class="p">,</span> <span class="n">Y_te</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">tr</span><span class="p">,</span> <span class="n">tar</span><span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span><span class="mi">33</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[187]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Printing the train and test values for X and Y</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_tr</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_te</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Y_tr</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Y_te</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>(1595, 97)
(399, 97)
(1595,)
(399,)
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>b. [10 pts] Perform standard multiple linear regression on data using the scikit-learn Linear Regression module. Compute the RMSE values on the full training data (the 80% partition). Also, plot the correlation between the predicted and actual values of the target attribute. Display the obtained regression coefficients (weights) and plot them using matplotlib. Finally, perform 10-fold cross-validation on the training partition and compare the cross-validation RMSE to the training RMSE (for cross validation, you should use the KFold module from sklearn.model_selection).</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[188]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#From the sci-kit importing the LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="c1">#Applying the LinearRegression on the X_tr and Y_tr</span>
<span class="n">lin_reg</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">lin_reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_tr</span><span class="p">,</span> <span class="n">Y_tr</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[188]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>LinearRegression()</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[189]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Finding the training data prediction </span>
<span class="n">p_tr</span> <span class="o">=</span> <span class="n">lin_reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_tr</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[190]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Importing the mean_squared_error and mean_absolute_error</span>
<span class="c1">#mean_squared_error - The avg error squares are measured</span>
<span class="c1">#mean_absolute_error - Calculated by adding the abs difference b/w actual and entire array</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">mean_absolute_error</span>
<span class="c1">#The RMSE for the training data is computed</span>
<span class="n">rmse_tr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">p_tr</span><span class="p">,</span> <span class="n">Y_tr</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Testing Data RMSE: &quot;</span><span class="p">,</span> <span class="n">rmse_tr</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Testing Data RMSE:  0.1261959313342669
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[191]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#The correlation among predicted and actual are plotted </span>
<span class="c1">#Using the matplotlib</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p_tr</span><span class="p">,</span> <span class="n">Y_tr</span><span class="p">,</span><span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;g-&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Predicted Values&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Actual Values&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://" class="jp-needs-light-background"/>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[192]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#The regression weights are plotted</span>
<span class="c1">#Using the matplotlib</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="k">def</span> <span class="nf">plot_co_efficients</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">n_features</span><span class="p">,</span> <span class="n">feature_names</span><span class="p">):</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_features</span><span class="p">),</span> <span class="n">model</span><span class="o">.</span><span class="n">coef_</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_features</span><span class="p">),</span> <span class="n">feature_names</span><span class="p">)</span>
<span class="c1">#The label for X and Y are give as &#39;Co-efficient Val&#39; &amp; &#39;Feature&#39;</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Co-efficient Val&quot;</span><span class="p">)</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Feature&quot;</span><span class="p">)</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[193]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#The co-efficients are plotted </span>
<span class="c1">#figure size being 10.30</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">30</span><span class="p">))</span>
<span class="n">plot_co_efficients</span><span class="p">(</span><span class="n">lin_reg</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span> <span class="n">tr</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://" class="jp-needs-light-background"/>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[194]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Cross Validation is done</span>
<span class="c1">#On 10 fold</span>
<span class="c1">#Importing the cross_val_score </span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span>
<span class="c1">#The cross_val_score is computed</span>
<span class="n">cval_score</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">lin_reg</span><span class="p">,</span> <span class="n">X_tr</span><span class="p">,</span> <span class="n">Y_tr</span><span class="p">,</span> <span class="n">scoring</span> <span class="o">=</span><span class="s2">&quot;neg_mean_squared_error&quot;</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="c1">#The abs value for cross_val_score is printed</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">cval_score</span><span class="p">)))</span>
<span class="n">cval_rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">cval_score</span><span class="p">)))</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>[0.14 0.14 0.13 0.14 0.14 0.13 0.12 0.12 0.14 0.15]
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[195]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Using the method &#39;Simple Linear Regression&#39;</span>
<span class="n">method_SLR</span> <span class="o">=</span> <span class="s1">&#39;Simple Linear Regression&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Method: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span><span class="k">method_SLR</span>)
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RMSE on training: </span><span class="si">%.4f</span><span class="s1">&#39;</span> <span class="o">%</span><span class="k">rmse_tr</span>)
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RMSE on 10-fold CV: </span><span class="si">%.4f</span><span class="s1">&#39;</span> <span class="o">%</span><span class="k">cval_rmse</span>)
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Method: Simple Linear Regression
RMSE on training: 0.1262
RMSE on 10-fold CV: 0.1343
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>The 10-Fold CV was not used, however the RMSE performed good without the use of it</p>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>c.[15 pts] Feature Selection:  use the scikit-learn to select the best subset of features to perform linear regression. For feature selection, write a script or function that takes as input the training data; target variable; the regression model; and any other parameters you find necessary. The function should return the optimal percentage of the most informative features to use. Your approach should use k-fold cross-validation on the training data (use k=5 for consistency) and use feature_selection.SelectPercentile to find the most informative variables for a range of percentile values [Note: since this is regression not classification, in the SelectPercentile function you should use feature_selection.f_regression as scoring function rather than chi2). You should also plot the model&#39;s error values on cross-validation using only the selected features across the range of percentile values. For variety, in this part we will use Mean Absolute Error (MAE) as the error metric instead of RMSE. For cross-validation, use scikit&#39;s cross_val_score function. In order to use cross_val_score with regression you&#39;ll need to pass to it a specific error function. In this case, you will use scoring=&#39;neg_mean_absolute_error&#39; as a parameter. You should use aboslute values to convert these negated MAE values to positive MAE values. Your plot should look similar (but won&#39;t be exactly the same as this example). Once you have identified the best percentile based on cross-validation, use it to identify and display the corresponding best features. As a final step, train your model on the full 80% training data with the optimal subset of features and then compute it&#39;s peformance (again using MAE) on the set-aside 20% test partition.</p>
<p>[Note: For an example of a similar feature selection process please review the class example notebook (though note that the task in this example was classification not regression). Also, review scikit-learn documentation for feature selection.]</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[196]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#We are importing using the sci-kit</span>
<span class="c1">#Also, importing the feature_selection, f_regression, SelectPercentile, and math</span>
<span class="c1">#F-statistic and p-value are being returned by the univariate linear regression</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">feature_selection</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">f_regression</span><span class="p">,</span> <span class="n">SelectPercentile</span>
<span class="kn">import</span> <span class="nn">math</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[197]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#We are importing using the sci-kit</span>
<span class="c1">#Also, importing the feature_selection, f_regression, SelectPercentile, and math</span>
<span class="c1">#F-statistic and p-value are being returned by the univariate linear regression</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">feature_selection</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span>
<span class="c1">#Performing the fit transform for the feature selection</span>
<span class="c1">#Selecting the features with the highest scores (SelectPercentile)</span>
<span class="n">percentiles</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="n">feature_selection</span><span class="o">.</span><span class="n">SelectPercentile</span><span class="p">(</span><span class="n">feature_selection</span><span class="o">.</span><span class="n">f_regression</span><span class="p">,</span> <span class="n">percentile</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
    <span class="n">x_tr_fs</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_tr</span><span class="p">,</span> <span class="n">Y_tr</span><span class="p">)</span>
    <span class="n">scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">lin_reg</span><span class="p">,</span> <span class="n">x_tr_fs</span><span class="p">,</span> <span class="n">Y_tr</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;neg_mean_absolute_error&#39;</span><span class="p">)</span>
    <span class="n">scores</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%2d</span><span class="s2">  </span><span class="si">%0.4f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">scores</span><span class="o">.</span><span class="n">mean</span><span class="p">()))</span>
<span class="c1">#Printing the results</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">scores</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre> 1  0.1129
 6  0.0994
11  0.0990
16  0.0991
21  0.0975
26  0.0961
31  0.0948
36  0.0947
41  0.0944
46  0.0947
51  0.0950
56  0.0953
61  0.0957
66  0.0957
71  0.0958
76  0.0952
81  0.0954
86  0.0951
91  0.0953
96  0.0953
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[198]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">optimal_percentile_ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">results</span> <span class="o">==</span> <span class="n">results</span><span class="o">.</span><span class="n">min</span><span class="p">())[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">optimal_percentile_ind</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>8
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[199]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#importing the warnings to alter some condition in the program </span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">RuntimeWarning</span><span class="p">)</span> 
<span class="c1">#Using the Linear Regression</span>
<span class="n">lin_reg</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">percentiles</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">scorer</span> <span class="o">=</span><span class="s1">&#39;neg_mean_absolute_error&#39;</span>
<span class="c1">#Using the N = 5</span>
<span class="n">N</span> <span class="o">=</span><span class="mi">5</span>
<span class="c1">#optimal_num_features is defined with parameters as model, X_tr, Y_tr, N, percentile, scorer</span>
<span class="k">def</span> <span class="nf">optimal_num_features</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_tr</span><span class="p">,</span> <span class="n">Y_tr</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">percentile</span><span class="p">,</span> <span class="n">scorer</span><span class="p">):</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>  
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">percentiles</span><span class="p">:</span>
        <span class="n">f_s</span> <span class="o">=</span> <span class="n">SelectPercentile</span><span class="p">(</span><span class="n">f_regression</span><span class="p">,</span> <span class="n">percentile</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
        <span class="n">X_tr_f_s</span> <span class="o">=</span> <span class="n">f_s</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_tr</span><span class="p">,</span> <span class="n">Y_tr</span><span class="p">)</span>
        <span class="n">scores</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">cross_val_score</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_tr_f_s</span><span class="p">,</span> <span class="n">Y_tr</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">scoring</span> <span class="o">=</span> <span class="n">scorer</span><span class="p">))</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">scores</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">scores</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>        
    <span class="n">optimal_percentile</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">results</span> <span class="o">==</span> <span class="n">results</span><span class="o">.</span><span class="n">min</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Optimal percentile of features:</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">percentiles</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">optimal_percentile</span><span class="p">)]))</span>
    <span class="k">return</span> <span class="n">optimal_percentile</span><span class="p">,</span> <span class="n">results</span>
<span class="n">optimal_percent</span><span class="p">,</span> <span class="n">results</span> <span class="o">=</span> <span class="n">optimal_num_features</span><span class="p">(</span><span class="n">lin_reg</span><span class="p">,</span><span class="n">X_tr</span><span class="p">,</span><span class="n">Y_tr</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">percentiles</span><span class="p">,</span><span class="n">scorer</span><span class="p">)</span>
<span class="n">optimal_num_features</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">percentiles</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">optimal_percent</span><span class="p">)]</span><span class="o">*</span><span class="n">X_tr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">optimal_percent : &quot;</span><span class="p">,</span><span class="n">optimal_percent</span><span class="p">,</span><span class="s2">&quot; Optimal number of features:</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">optimal_num_features</span><span class="p">),</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>1 0.11287401163402822
6 0.09943268475677308
11 0.09900510519125444
16 0.0990905907952681
21 0.09750686221310859
26 0.09608904536542377
31 0.09478480270197638
36 0.09474955355002232
41 0.09435370428857698
46 0.09466441760571027
51 0.09498773346781053
56 0.0953208516480594
61 0.09574966889254498
66 0.09572089544915725
71 0.09583132229767206
76 0.09519157369784723
81 0.09542568827536395
86 0.09513624310358179
91 0.09525366581598067
96 0.0952762785288391
Optimal percentile of features:41

optimal_percent :  [8]  Optimal number of features:39 

</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[200]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Features vs cross-validation scores percentile are plotted</span>
<span class="c1">#Using the PyLab from the matplotlib</span>
<span class="kn">import</span> <span class="nn">pylab</span> <span class="k">as</span> <span class="nn">pl</span>
<span class="n">pl</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="c1">#Mentioning the Title for X and Y label respectively</span>
<span class="n">pl</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;The Percentile between features VS cross-validation score is shown&quot;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Percentage of features selected&quot;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Cross validation accuracy&quot;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">percentiles</span><span class="p">,</span><span class="n">results</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[200]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>[&lt;matplotlib.lines.Line2D at 0x22d8d7e4a60&gt;]</pre>
</div>

</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://" class="jp-needs-light-background"/>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[201]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;optimal_percent &quot;</span><span class="p">,</span><span class="n">percentiles</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">optimal_percent</span><span class="p">)])</span>
<span class="nb">print</span><span class="p">()</span>
<span class="n">f_s</span> <span class="o">=</span> <span class="n">SelectPercentile</span><span class="p">(</span><span class="n">f_regression</span><span class="p">,</span><span class="n">percentile</span><span class="o">=</span><span class="n">percentiles</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">optimal_percent</span><span class="p">)])</span>
<span class="n">X_tr_fs</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_tr</span><span class="p">,</span><span class="n">Y_tr</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X_tr</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">)):</span>
    <span class="k">if</span> <span class="n">fs</span><span class="o">.</span><span class="n">get_support</span><span class="p">()[</span><span class="n">i</span><span class="p">]:</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">X_tr</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fs</span><span class="o">.</span><span class="n">scores_</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>optimal_percent  41

population 	 256.0323547372104
householdsize 	 3.492519416199977
racepctblack 	 1074.8895092675332
racePctWhite 	 1412.507812392418
racePctHisp 	 137.54043215678004
agePct12t21 	 4.894803532795906
agePct12t29 	 37.334014965114044
agePct16t24 	 15.875055643949556
agePct65up 	 8.24793840554524
numbUrban 	 247.77613854814723
pctUrban 	 11.060895847737793
medIncome 	 341.63253752319184
pctWWage 	 161.57075094157048
pctWFarmSelf 	 40.34422029878609
pctWInvInc 	 756.0149723312651
pctWSocSec 	 22.486379068173918
pctWPubAsst 	 784.5706408092445
pctWRetire 	 13.975623750024441
medFamInc 	 366.9004218440595
perCapInc 	 214.99315799068734
whitePerCap 	 65.44623454922727
blackPerCap 	 126.57709861890284
indianPerCap 	 12.317095444554932
AsianPerCap 	 29.06922706893266
OtherPerCap 	 33.36930259404439
HispPerCap 	 92.36570683066252
NumUnderPov 	 400.30785689079215
PctPopUnderPov 	 578.8173652137684
PctLess9thGrade 	 319.21810810192335
PctNotHSGrad 	 472.1962078690574
PctBSorMore 	 173.36684318428422
PctUnemployed 	 533.9131521991873
PctEmploy 	 190.46526246383476
PctEmplManu 	 2.6058058164622735
PctEmplProfServ 	 7.399074994854386
MalePctDivorce 	 602.7748935816077
MalePctNevMarr 	 161.07842259577353
FemalePctDiv 	 704.7727390048349
TotalPctDiv 	 693.1378303822006
PersPerFam 	 24.46806220870128
PctFam2Par 	 1657.8650169981222
PctKids2Par 	 1972.8040638663906
PctYoungKids2Par 	 1342.1736137875248
PctTeen2Par 	 1299.5351058427004
PctWorkMom 	 36.49643186018172
NumIlleg 	 431.63556026914017
PctIlleg 	 1936.1208737826887
NumImmig 	 151.62332311317385
PctImmigRecent 	 40.65141128208953
PctImmigRec5 	 70.22763612601346
PctImmigRec8 	 96.27748488473334
PctImmigRec10 	 134.79436159590438
PctRecentImmig 	 85.19610427095064
PctRecImmig5 	 101.53568183196587
PctRecImmig8 	 106.97309037018287
PctRecImmig10 	 116.90181469983922
PctSpeakEnglOnly 	 92.38337246432047
PctNotSpeakEnglWell 	 144.66400533878212
PctLargHouseFam 	 241.2338163602984
PctLargHouseOccup 	 129.5384725625034
PersPerOccupHous 	 4.351864474370356
PersPerOwnOccHous 	 28.395095004947432
PersPerRentOccHous 	 93.29489369970833
PctPersOwnOccup 	 630.760339373983
PctPersDenseHous 	 375.645901876122
PctHousLess3BR 	 487.96168084239696
MedNumBR 	 242.06642994789578
HousVacant 	 339.968618162094
PctHousOccup 	 173.73941701732582
PctHousOwnOcc 	 478.53042971844724
PctVacantBoarded 	 507.63640854199105
MedYrHousBuilt 	 18.640270377927532
PctHousNoPhone 	 505.8626527468797
PctWOFullPlumb 	 209.11490495589555
OwnOccLowQuart 	 71.33963995687104
OwnOccMedVal 	 57.9766746611472
OwnOccHiQuart 	 46.443005188733345
RentLowQ 	 104.02885733441938
RentMedian 	 95.72437888918353
RentHighQ 	 90.25437367854578
MedRent 	 95.91995628599737
MedRentPctHousInc 	 178.68419423618568
MedOwnCostPctInc 	 6.724749880887773
MedOwnCostPctIncNoMtg 	 4.3230378952818125
NumInShelters 	 265.8459418752538
NumStreet 	 169.53426122290423
PctForeignBorn 	 61.96200805216785
PctBornSameState 	 9.707094406828169
PctSameHouse85 	 40.92745192299822
PctSameCity85 	 9.172636888505926
LandArea 	 61.980585133652255
PopDens 	 142.6901578134153
PctUsePubTrans 	 40.12079381252868
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[202]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">f_s</span> <span class="o">=</span> <span class="n">SelectPercentile</span><span class="p">(</span><span class="n">f_regression</span><span class="p">,</span> <span class="n">optimal_percent</span><span class="p">)</span>
<span class="n">X_tr_fs</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_tr</span><span class="p">,</span> <span class="n">Y_tr</span><span class="p">)</span>
<span class="n">lin_reg</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">lin_reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_tr_fs</span><span class="p">,</span> <span class="n">Y_tr</span><span class="p">)</span>
<span class="n">X_te_fs</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_te</span><span class="p">)</span>
<span class="n">predict</span> <span class="o">=</span> <span class="n">lin_reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_te_fs</span><span class="p">)</span>
<span class="n">score</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">Y_te</span><span class="p">,</span><span class="n">predict</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MAE score for test data on cv: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">score</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()))</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>
<span class="ansi-red-intense-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-intense-fg ansi-bold">TypeError</span>                                 Traceback (most recent call last)
Input <span class="ansi-green-intense-fg ansi-bold">In [202]</span>, in <span class="ansi-cyan-fg">&lt;cell line: 1&gt;</span><span class="ansi-blue-intense-fg ansi-bold">()</span>
<span class="ansi-green-intense-fg ansi-bold">----&gt; 1</span> f_s <span style="color: rgb(98,98,98);">=</span> <span class="ansi-yellow-bg">SelectPercentile</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">f_regression</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">optimal_percent</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">      2</span> X_tr_fs <span style="color: rgb(98,98,98);">=</span> fs<span style="color: rgb(98,98,98);">.</span>fit_transform(X_tr, Y_tr)
<span class="ansi-green-fg">      3</span> lin_reg <span style="color: rgb(98,98,98);">=</span> LinearRegression()

<span class="ansi-red-intense-fg ansi-bold">TypeError</span>: __init__() takes from 1 to 2 positional arguments but 3 were given</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>d. [10 pts] Next, using the original train and test data in part (a), perform Ridge Regression and Lasso Regression using the modules from sklearn.linear_model. In each case, perform systematic model selection to identify the optimal alpha hyperparameter (the regularization coefficient). You should create a function that takes as input the training data and target variable; the parameter to vary and a list of its values; the model to be trained; and any other relevant input needed to determine the optimal value for the specified parameter. The model selection process should perform k-fold cross validation (k should be a parameter, but you can select k=5 for this problem). For each model, you should also plot the error values (this time using RMSE as the error metric) on the training and cross-validation splits across the specified values of alpha. Finally, using the best alpha values for each regression model, train the model on the full training data and evaluate it on the set-aside test data. Discuss your observations and conclusions, especially about the impact of alpha on bias-variance trade-off. [Hint: for an example of a similar model optimization process please review the class example notebook.]</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[203]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Imporing the ridge regression using</span>
<span class="c1">#sci-kit package</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Ridge</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[204]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Tr - Train</span>
<span class="c1">#Te - Test</span>
<span class="k">def</span> <span class="nf">calc_params</span><span class="p">(</span><span class="n">Data</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">param_values</span><span class="p">,</span> <span class="n">param_name</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">model_name</span><span class="p">):</span>
    <span class="c1">#The i/p are converted into Numpy arrays</span>
    <span class="n">Data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Data</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="c1">#The training score and testing score are initialized with zeros</span>
    <span class="n">tr_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">param_values</span><span class="p">))</span>
    <span class="n">te_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">param_values</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">param_value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">param_values</span><span class="p">):</span>
        <span class="c1">#The classifier parameters are set</span>
        <span class="n">model</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="n">param_name</span><span class="p">:</span><span class="n">param_value</span><span class="p">})</span>
        <span class="c1">#The K scores for each Fold are intialized</span>
        <span class="n">k_train_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
        <span class="n">k_test_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
        <span class="c1">#Creating a K-Fold cross-validation technique</span>
        <span class="c1">#Computing the K-Fold cross-validation</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="n">K</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">tr</span><span class="p">,</span> <span class="n">te</span> <span class="ow">in</span> <span class="n">cv</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">Data</span><span class="p">):</span>
            <span class="c1"># fit the classifier in the corresponding fold</span>
            <span class="c1"># and obtain the corresponding accuracy scores on train and test sets</span>
            <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Data</span><span class="p">[</span><span class="n">tr</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">tr</span><span class="p">])</span>
            <span class="c1">#Predicting for the training and testing scores</span>
            <span class="n">tr_predict</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Data</span><span class="p">[</span><span class="n">tr</span><span class="p">])</span>
            <span class="n">te_predict</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Data</span><span class="p">[</span><span class="n">te</span><span class="p">])</span>            
            <span class="n">k_tr_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">tr</span><span class="p">],</span> <span class="n">tr_predict</span><span class="p">))</span>
            <span class="n">k_te_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">te</span><span class="p">],</span> <span class="n">te_predict</span><span class="p">))</span>
        <span class="c1">#The mean of the K-Fold scores are being stored</span>
        <span class="n">tr_scores</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">k_tr_scores</span><span class="p">)</span>
        <span class="n">te_scores</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">k_te_scores</span><span class="p">)</span>  
<span class="c1">#The training and testing scores are plotted</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="c1">#Plotting the Training and Testing</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">param_values</span><span class="p">,</span> <span class="n">tr_scores</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Tr&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">param_values</span><span class="p">,</span> <span class="n">te_scores</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Te&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="c1">#Title</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="c1">#X and Y label are given</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">param_name</span> <span class="o">+</span> <span class="s2">&quot; values&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Cross-validation RMSE&quot;</span><span class="p">)</span>
    <span class="n">min_err_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">te_scores</span> <span class="o">==</span> <span class="n">te_scores</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
    <span class="n">min_err_alpha</span> <span class="o">=</span> <span class="n">param_values</span><span class="p">[</span><span class="n">min_err_idx</span><span class="p">]</span>    
<span class="c1">#The scores for training and testing on each of the parameter value</span>
<span class="c1">#are returned</span>
    <span class="k">return</span> <span class="n">tr_scores</span><span class="p">,</span> <span class="n">te_scores</span><span class="p">,</span> <span class="n">min_err_alpha</span><span class="p">,</span><span class="n">min_err_idx</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[205]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Printing the shapes for Training and Testing</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; tr shape &#39;</span><span class="p">,</span><span class="n">X_tr</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="s1">&#39; y-tr shape &#39;</span><span class="p">,</span><span class="n">Y_tr</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">alpha</span><span class="p">])</span>
<span class="c1">#N = 5</span>
<span class="n">number_of_fold</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">param_name</span> <span class="o">=</span> <span class="s1">&#39;alpha&#39;</span>
<span class="n">param_values</span> <span class="o">=</span> <span class="n">alpha</span>
<span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">models</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Ridge&#39;</span><span class="p">:</span> <span class="n">Ridge</span><span class="p">(),</span><span class="s1">&#39;Lasso&#39;</span><span class="p">:</span><span class="n">Lasso</span><span class="p">()}</span>
<span class="n">min_alpha</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">models</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>  
    <span class="n">tr_scores</span><span class="p">,</span> <span class="n">te_scores</span><span class="p">,</span> <span class="n">min_err_alpha</span><span class="p">,</span><span class="n">min_err_idx</span> <span class="o">=</span> <span class="n">calc_params</span><span class="p">(</span><span class="n">X_tr</span><span class="p">,</span> <span class="n">Y_tr</span><span class="p">,</span> <span class="n">models</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">),</span> 
                                                                  <span class="n">param_values</span><span class="p">,</span>
                                                                  <span class="n">param_name</span><span class="p">,</span> 
                                                                  <span class="n">number_of_fold</span><span class="p">,</span><span class="n">verbose</span><span class="p">,</span><span class="n">key</span><span class="p">)</span>   
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1"> The minimum RMSE for </span><span class="se">\&quot;</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">key</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\&quot;</span><span class="s1"> using cross validation is:&#39;</span><span class="p">,</span> <span class="n">te_scores</span><span class="p">[</span><span class="n">min_err_idx</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;with&#39;</span><span class="p">,</span> <span class="n">param_name</span><span class="p">,</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">min_err_alpha</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">min_alpha</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">=</span><span class="n">min_err_alpha</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre> tr shape  (1595, 97)  y-tr shape  (1595,)


 The minimum RMSE for &quot; Ridge &quot; using cross validation is: 0.13882110895925448 with alpha : 1.0060150753768842


 The minimum RMSE for &quot; Lasso &quot; using cross validation is: 0.14224582056412474 with alpha : 0.001
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://" class="jp-needs-light-background"/>
</div>

</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://" class="jp-needs-light-background"/>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[206]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Models are done in Test</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The models are running on Test&quot;</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="kc">None</span>
<span class="c1">#Ridge &amp; Lasso Regression</span>
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">min_alpha</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="k">if</span><span class="p">(</span><span class="n">key</span><span class="o">==</span><span class="s1">&#39;Ridge&#39;</span><span class="p">):</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">(</span><span class="n">fit_intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">min_alpha</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
        <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_tr</span><span class="p">,</span> <span class="n">Y_tr</span><span class="p">)</span>          
    <span class="k">else</span> <span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">(</span><span class="n">fit_intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">min_alpha</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
        <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_tr</span><span class="p">,</span> <span class="n">Y_tr</span><span class="p">)</span>          
    <span class="n">pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_te</span><span class="p">)</span>
    <span class="n">RMSE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">Y_te</span><span class="p">,</span> <span class="n">pred</span><span class="p">))</span>
<span class="c1">#Printing the Root Mean Sq Error on Testing data</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="s1">&#39; =&gt; Root Mean Squared error on test data: </span><span class="si">%0.8f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">RMSE</span><span class="p">,</span> <span class="s1">&#39;using alpha =&#39;</span><span class="p">,</span><span class="n">min_alpha</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>The models are running on Test
Ridge  =&gt; Root Mean Squared error on test data: 0.14337675 using alpha = 1.0060150753768842
Lasso  =&gt; Root Mean Squared error on test data: 0.14601641 using alpha = 0.001
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>e. [10 pts] Next, perform regression using Stochastic Gradient Descent Regressor from scikit-learn (again use the original train-test split in part (a). Note that SGDRegessor requires that features be standardized (with 0 mean and scaled by standard deviation). Prior to fiting the model, perform the scaling using StandardScaler from sklearn.preprocessing. For this problem, perform a grid search (using GridSearchCV from sklearn.grid_search). Your grid search should compare combinations of two penalty parameters (&#39;l2&#39;, &#39;l1&#39;) and different values of alpha (alpha could vary from 0.0001 which is the default to relatively large values, say 10). Using the best parameters, train the model on the full training partition and apply the model to the set-aside test data, comparing traning and test RMSE scores. Finally, perform model optimization (similar to part d, above) to find the best &quot;l1_ratio&quot; parameter using SGDRegressor with  the &quot;elasticnet&quot; penalty parameter. [Note: &quot;l1_ratio&quot; is The Elastic Net mixing parameter, with 0 &lt;= l1_ratio &lt;= 1;  l1_ratio=0 corresponds to L2 penalty, l1_ratio=1 to L1 penalty; defaults to 0.15.] Using the best mixing ratio, apply the Elastic Net model, trained on full training data, to the set-aside test data and compare to the training perfromance. Provide a brief summary of your findings from the above experiments.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[207]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Using the sci-kit package</span>
<span class="c1">#we are importing </span>
<span class="c1">#SGDRegressor, StandardScaler, and GridSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">SGDRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[208]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input data Shape&#39;</span><span class="p">,</span><span class="n">comm</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="c1">#Dropping state, communityname, and ViolentCrimesPerPop</span>
<span class="n">vs_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">comm</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;state&#39;</span><span class="p">,</span><span class="s1">&#39;communityname&#39;</span><span class="p">,</span><span class="s1">&#39;ViolentCrimesPerPop&#39;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="c1">#Data Standardizing is done </span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">scaler</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">vs_matrix</span><span class="p">)</span>
<span class="n">vs_matrix</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">vs_matrix</span><span class="p">)</span>
<span class="n">vs_tr</span><span class="p">,</span> <span class="n">vs_te</span><span class="p">,</span> <span class="n">vs_tar_tr</span><span class="p">,</span> <span class="n">vs_tar_te</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">vs_matrix</span><span class="p">,</span> <span class="n">comm</span><span class="o">.</span><span class="n">ViolentCrimesPerPop</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">33</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;vs train shape &quot;</span><span class="p">,</span><span class="n">vs_tr</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s2">&quot; test shape &quot;</span><span class="p">,</span><span class="n">vs_te</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;train target shape &quot;</span><span class="p">,</span><span class="n">vs_tar_tr</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="s2">&quot; Test target shape &quot;</span><span class="p">,</span><span class="n">vs_tar_te</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="c1">#Training and Testing for X and Y</span>
<span class="n">x_tr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vs_tr</span><span class="p">)</span>
<span class="n">y_tr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vs_tar_tr</span><span class="p">)</span>
<span class="n">x_te</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vs_te</span><span class="p">)</span>
<span class="n">y_te</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vs_tar_te</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>input data Shape (1994, 100)
vs train shape  (1595, 97)  test shape  (399, 97)
train target shape  (1595,)  Test target shape  (399,)
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[209]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Stochastic Gradient Descent (SGD) is used </span>
<span class="n">sgd_reg</span> <span class="o">=</span> <span class="n">SGDRegressor</span><span class="p">();</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">.0001</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">alpha</span><span class="p">])</span>
<span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;penalty&#39;</span><span class="p">:[</span><span class="s2">&quot;l2&quot;</span><span class="p">,</span><span class="s2">&quot;l1&quot;</span><span class="p">],</span>
    <span class="s1">&#39;alpha&#39;</span><span class="p">:</span><span class="n">alpha</span>
<span class="p">}</span>
<span class="n">g_s</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">sgd_reg</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[210]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">time</span> _ = g_s.fit(X_tr, Y_tr)
<span class="n">g_s</span><span class="o">.</span><span class="n">best_params_</span><span class="p">,</span> <span class="n">g_s</span><span class="o">.</span><span class="n">best_score_</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Fitting 5 folds for each of 200 candidates, totalling 1000 fits
CPU times: total: 1min 1s
Wall time: 6.17 s
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[210]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>({&#39;alpha&#39;: 0.0001, &#39;penalty&#39;: &#39;l2&#39;}, 0.6424461972572585)</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[211]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#The best parameters are used and applied on the model </span>
<span class="n">sgd</span> <span class="o">=</span> <span class="n">SGDRegressor</span><span class="p">()</span>
<span class="n">val</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="n">g_s</span><span class="o">.</span><span class="n">best_params_</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">sgd</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="n">i</span><span class="p">:</span><span class="n">j</span><span class="p">})</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;The optimum value of&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;is estimated as&quot;</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
    <span class="n">val</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="c1">#Fitting the SGB into X and Y</span>
<span class="n">sgd</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_tr</span><span class="p">,</span> <span class="n">Y_tr</span><span class="p">)</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">sgd</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_te</span><span class="p">)</span>
<span class="n">RMSE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">Y_te</span><span class="p">,</span> <span class="n">pred</span><span class="p">))</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;The test dataset RMSE: </span><span class="si">%0.8f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">RMSE</span><span class="p">,</span> <span class="s2">&quot;with&quot;</span><span class="p">,</span><span class="n">val</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>The optimum value of alpha is estimated as 0.0001


The optimum value of penalty is estimated as l2


The test dataset RMSE: 0.32369588 with alpha=0.0001 penalty=l2 
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[212]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">l1_rat_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0001</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="c1">#Parameter name and value</span>
<span class="n">param_name</span> <span class="o">=</span> <span class="s2">&quot;l1_ratio&quot;</span> 
<span class="n">param_value</span> <span class="o">=</span> <span class="n">l1_rat_range</span>
<span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>
<span class="c1">#Loss function is done</span>
<span class="c1">#Penalized linear regression model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">SGDRegressor</span><span class="p">(</span><span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;elasticnet&#39;</span><span class="p">)</span>
<span class="n">tr_scores</span><span class="p">,</span> <span class="n">te_scores</span><span class="p">,</span> <span class="n">min_err_alpha</span><span class="p">,</span><span class="n">min_err_idx</span> <span class="o">=</span> <span class="n">calc_params</span><span class="p">(</span><span class="n">X_tr</span><span class="p">,</span> <span class="n">Y_tr</span><span class="p">,</span><span class="n">model</span><span class="p">,</span> 
                                                                   <span class="n">param_value</span><span class="p">,</span> <span class="n">param_name</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> 
                                                                   <span class="n">verbose</span><span class="p">,</span> <span class="s2">&quot;SGD Regressor&quot;</span><span class="p">)</span>    
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;SGD Regressor minimum RMSE using the cross-validation is:&#39;</span><span class="p">,</span> 
       <span class="n">te_scores</span><span class="p">[</span><span class="n">min_err_idx</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;with&#39;</span><span class="p">,</span>
       <span class="n">param_name</span><span class="p">,</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> 
       <span class="n">min_err_alpha</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>SGD Regressor minimum RMSE using the cross-validation is: 0.1435839758999752 with l1_ratio : 0.47479999999999994
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://" class="jp-needs-light-background"/>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>The l1_ratio values on the RMSE training data is 0.137 (from Output) which is the lowest and that can be used to run the model on the test data as the penalty parameter using the &quot;elasticnet&quot;.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[213]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#The best parameters are being used and </span>
<span class="c1">#then we apply it in the model </span>
<span class="n">sgd</span> <span class="o">=</span> <span class="n">SGDRegressor</span><span class="p">(</span><span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;elasticnet&#39;</span><span class="p">,</span> <span class="n">l1_ratio</span><span class="o">=</span><span class="n">min_err_alpha</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="c1">#Fitting the SGD</span>
<span class="n">sgd</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_tr</span><span class="p">,</span> <span class="n">Y_tr</span><span class="p">)</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">sgd</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_te</span><span class="p">)</span>
<span class="c1">#Mean Absolute Error</span>
<span class="n">MAE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">Y_te</span><span class="p">,</span> <span class="n">pred</span><span class="p">))</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;MAE on test data set: </span><span class="si">%0.8f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">MAE</span><span class="p">,</span> <span class="s2">&quot;&#39;elasticnet&#39; and l1_ratio penalty equals to = &quot;</span><span class="p">,</span><span class="n">min_err_alpha</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>MAE on test data set: 0.32247476 &#39;elasticnet&#39; and l1_ratio penalty equals to =  0.47479999999999994
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h1>Question 2<a rel="noopener" class="anchor-link" href="#Question-2">&#182;</a></h1><h1>Automatic Document Clustering<a rel="noopener" class="anchor-link" href="#Automatic-Document-Clustering">&#182;</a></h1><p>a. [5 pts] Create your own distance function that, instead of using Euclidean distance, uses Cosine similarity. This is the distance function you will use to pass to the kMeans function in the included module. Note: you should not use external function for computing Cosine. Write your own version that computes Cosine similarity between two n-dimentional vectors and returns the inverse as the distance between these vectors.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[214]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Importing the packages</span>
<span class="c1">#Running the packages</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[215]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Calculating the Euclidean Distance</span>
<span class="k">def</span> <span class="nf">calculateEuclideanDistance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">D</span><span class="p">):</span>
    <span class="n">dist_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">D</span> <span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dist</span>
<span class="c1">#Calculating the Cosine Similarity Distance</span>
<span class="k">def</span> <span class="nf">calculateCosineSimilarityDistance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">D</span><span class="p">):</span>  
    <span class="n">D_norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">D</span><span class="p">)</span> 
    <span class="n">x_norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">sims</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">D</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">D_norm</span> <span class="o">*</span> <span class="n">x_norm</span><span class="p">)</span>
<span class="c1">#The inverse of Cosine similarity is the distance measure</span>
    <span class="n">dist_</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">sims</span>  
    <span class="k">return</span> <span class="n">dist_</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>b. [10 pts] Load the data set [Note: the data matrix provided has terms as rows and documents as columns. Since you will be clustering documents, you&#39;ll need to take the transpose of this matrix so that your main data matrix is a document x term matrix. In Numpy, you may use the &quot;.T&quot; operation to obtain the transpose.] Then, use the train_test_split function (with random_state = 99) to perform a randomized split the data set (the document by term matrix) and set aside 20% for later use (see below). Use the 80% segment for clustering in the next part. Next, as in the previous assignment, perform TFxIDF transformation on these data sets. [Note: if you have difficulty with TFxIDF conversion, then use the original non-transformed data for the remainder of this assignment].</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[216]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Reading the matrix text file and running it </span>
<span class="c1">#Reading the terms text file and running it </span>
<span class="c1">#Reading the classes text file and running it </span>
<span class="n">matrix</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="s2">&quot;C:/Users/admin/Desktop/1/matrix.txt&quot;</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">terms</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="s2">&quot;C:/Users/admin/Desktop/1/terms.txt&quot;</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">classes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s2">&quot;C:/Users/admin/Desktop/1/classes.txt&quot;</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">skip_header</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[217]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Displaying matrix dataset</span>
<span class="n">matrix</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[217]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>2490</th>
      <th>2491</th>
      <th>2492</th>
      <th>2493</th>
      <th>2494</th>
      <th>2495</th>
      <th>2496</th>
      <th>2497</th>
      <th>2498</th>
      <th>2499</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9323</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9324</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9325</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9326</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9327</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>9328 rows &#215; 2500 columns</p>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[218]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">terms</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[218]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>aa</td>
    </tr>
    <tr>
      <th>1</th>
      <td>aargh</td>
    </tr>
    <tr>
      <th>2</th>
      <td>aaron</td>
    </tr>
    <tr>
      <th>3</th>
      <td>aaronc</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ab</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>9323</th>
      <td>zubov</td>
    </tr>
    <tr>
      <th>9324</th>
      <td>zv</td>
    </tr>
    <tr>
      <th>9325</th>
      <td>zw</td>
    </tr>
    <tr>
      <th>9326</th>
      <td>zx</td>
    </tr>
    <tr>
      <th>9327</th>
      <td>zz</td>
    </tr>
  </tbody>
</table>
<p>9328 rows &#215; 1 columns</p>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[219]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Displaying the classes</span>
<span class="n">classes</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[219]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>array([0, 1, 1, ..., 3, 4, 2])</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[220]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Representing the shapes for the Matrix, </span>
<span class="c1">#Terms, </span>
<span class="c1">#Classes</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Matrix Shape: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Terms Shape: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">terms</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Classes Shape: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">classes</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Matrix Shape: (9328, 2500)
Terms Shape: (9328, 1)
Classes Shape: (2500,)
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[221]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#The transpose of the matrix text file</span>
<span class="n">matrixT</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">T</span>
<span class="n">matrixT</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[221]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>(2500, 9328)</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[222]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">DT_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mat</span><span class="p">(</span><span class="n">matrixT</span><span class="p">)</span>
<span class="n">DT_matrix</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[222]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>(2500, 9328)</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[223]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Importing the train_test_split using the sci-kit package</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="n">x_tr</span><span class="p">,</span> <span class="n">x_te</span><span class="p">,</span> <span class="n">y_tr</span><span class="p">,</span> <span class="n">y_te</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">matrixT</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">99</span><span class="p">)</span>
<span class="c1">#Prining the Training and Testing</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;train : &quot;</span><span class="p">,</span><span class="n">x_tr</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test : &quot;</span><span class="p">,</span><span class="n">x_te</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>train :  (2000, 9328)
Test :  (500, 9328)
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>c. [20 pts] Perform Kmeans clustering on the transformed training data from part (b) Perform a qualitative analysis of the clusters by examining top features in each cluster and identifying patterns in the data. To facilitate your analysis of the clusters, write a function to display the top N terms in each cluster sorted by decreasing centroid weights for each term in the cluster (mean TFxIDF frequency of the term). Your output should also display the cluster DF value for the top N terms. The cluster DF value for a term t in a cluster C is the percentage of docs in cluster C in which term t appears (so, if a cluster has 500 documents, and term &quot;game&quot; appears in 100 of those 500 documents, then DF value of &quot;game&quot; in that cluster is 0.2 or 20%). For each cluster, you should also display the cluster size (the nunber of documents in the cluster). Here is an example of how this output might look like (here the top 10 terms for a sample of clusters are displayed in decreasing order of mean TFxIDF weights from the cluster centroids (the &quot;Freq&quot; column), but in addition the cluster DF values (both raw and as a percentage) are also shown).
Important Note: for this problem you should try several values of k for the number of clusters (try values of k from 4 through 8) and in each case try several runs in order to obtain clusters that seem more meaningful. In some cases, you may find some small clusters containing noise documents, which is not unusual. The point is to experiment with different runs and cluster numbers until you find at least several clusters that seem to capture some of the key topics in the documents. You do not need to provide the results of all your runs; you should only provide the results of your best clustering along with a brief discussion of your experimentation and your final observations.
[Extra Credit - 5 pts: use your favorite third party tool or library, ideally with a Python based API, to create a word cloud for each cluster (using your best clustering from earlier experiments.]</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[224]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Getting the random centroids</span>
<span class="k">def</span> <span class="nf">randCent</span><span class="p">(</span><span class="n">dataSet</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">dataSet</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">centroids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">k</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span> 
        <span class="n">minJ</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">dataSet</span><span class="p">[:,</span><span class="n">j</span><span class="p">])</span>
        <span class="n">rangeJ</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">dataSet</span><span class="p">[:,</span><span class="n">j</span><span class="p">])</span> <span class="o">-</span> <span class="n">minJ</span><span class="p">)</span>
        <span class="n">centroids</span><span class="p">[:,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">minJ</span> <span class="o">+</span> <span class="n">rangeJ</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">centroids</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[225]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">kmeans</span><span class="p">(</span><span class="n">D</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">distMeas</span><span class="o">=</span><span class="n">calculateCosineSimilarityDistance</span><span class="p">,</span><span class="n">createCentroid</span> <span class="o">=</span> <span class="n">randCent</span><span class="p">):</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">D</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">cluster_Assment</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">m</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span> 
<span class="c1">#Prinitng the calculated centroids (Start)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;calculating centroids : Start&#39;</span><span class="p">)</span>
    <span class="n">centroids</span> <span class="o">=</span> <span class="n">createCentroid</span><span class="p">(</span><span class="n">D</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
<span class="c1">#Prinitng the calculated centroids (End)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;calculating centroids : End&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> centroids are :: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">centroids</span><span class="p">)</span>
    <span class="n">clusterChanged</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">while</span> <span class="n">clusterChanged</span><span class="p">:</span>
        <span class="n">clusterChanged</span> <span class="o">=</span> <span class="kc">False</span>
<span class="c1">#Looping over the datapoints and the closest centroid are assigned to them</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
            <span class="n">min_DIst</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">;</span>
            <span class="n">min_Index</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
                <span class="n">dist_JI</span> <span class="o">=</span> <span class="n">distMeas</span><span class="p">(</span><span class="n">centroids</span><span class="p">[</span><span class="n">j</span><span class="p">,:],</span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">,:])</span>
                <span class="k">if</span><span class="p">(</span><span class="n">dist_JI</span> <span class="o">&lt;</span> <span class="n">min_DIst</span><span class="p">):</span>
                    <span class="n">min_DIst</span> <span class="o">=</span> <span class="n">dist_JI</span><span class="p">;</span>
                    <span class="n">min_Index</span> <span class="o">=</span> <span class="n">j</span><span class="p">;</span>
            <span class="k">if</span> <span class="n">cluster_Assment</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span><span class="n">min_Index</span> <span class="p">:</span> <span class="n">cluster_Changed</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">cluster_Assment</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">min_Index</span><span class="p">,</span> <span class="n">min_DIst</span><span class="o">**</span><span class="mi">2</span>      
<span class="c1">#The centroid is updated </span>
        <span class="k">for</span> <span class="n">cent</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
            <span class="n">pts_In_Clust</span> <span class="o">=</span> <span class="n">D</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">cluster_Assment</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">cent</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="n">centroids</span><span class="p">[</span><span class="n">cent</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">pts_In_Clust</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">centroids</span><span class="p">,</span> <span class="n">cluster_Assment</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[226]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mat</span><span class="p">(</span><span class="n">x_tr</span><span class="p">)</span>
<span class="c1">#Using the Kmeans for clustering</span>
<span class="n">centroids</span><span class="p">,</span> <span class="n">cluster_Assment</span> <span class="o">=</span> <span class="n">kmeans</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="c1">#Running the centroids</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>calculating centroids : Start
calculating centroids : End 
 centroids are :: 
 [[ 0.63  0.4  43.32 ...  1.12  0.77  1.65]
 [ 0.39  0.86 41.45 ...  0.68  0.24  0.07]
 [ 0.71  0.73 30.62 ...  1.19  0.95  4.91]
 [ 0.03  0.95 20.1  ...  0.66  0.06  2.53]
 [ 0.19  0.71 21.09 ...  1.29  0.34  0.08]]
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>C:\Users\admin\AppData\Local\Temp\ipykernel_60652\2915286355.py:22: DeprecationWarning: setting an array element with a sequence. This was supported in some cases where the elements are arrays with a single element. For example `np.array([1, np.array([2])], dtype=int)`. In the future this will raise the same ValueError as `np.array([1, [2]], dtype=int)`.
  cluster_Assment[i,:] = min_Index, min_DIst**2
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>CPU times: total: 2min 2s
Wall time: 2min
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[227]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#printing the centroids shape</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot; centroids shape&quot;</span><span class="p">,</span><span class="n">centroids</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="c1">#printing the clusster Assesment shape</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot; clusterAssment shape &quot;</span><span class="p">,</span><span class="n">cluster_Assment</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre> centroids shape (5, 9328)
 clusterAssment shape  (2000, 2)
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[228]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">cluster_report</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">terms</span><span class="p">,</span> <span class="n">clusters</span><span class="p">,</span> <span class="n">centroids</span><span class="p">):</span>
<span class="c1">#Clusters_DF</span>
    <span class="n">clusters_DF</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">clusters</span><span class="p">)</span>
<span class="c1">#term_list</span>
    <span class="n">term_list</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">terms</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Term&#39;</span><span class="p">)</span>   
    <span class="n">cluster_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">clusters_DF</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">size</span> <span class="o">=</span><span class="p">{}</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cluster_labels</span><span class="p">:</span>
        <span class="n">c</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="c1">#The train data from Cluster &#39;C&#39; index is taken</span>
        <span class="n">cl_data</span> <span class="o">=</span> <span class="n">x_tr</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">clusters_DF</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">c</span><span class="p">]</span>
        <span class="n">centroid</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">centroids</span><span class="p">[</span><span class="n">c</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Freq&#39;</span><span class="p">)</span>
        <span class="n">cl_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cl_data</span><span class="p">)</span>
        <span class="n">size</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">cl_size</span>        
<span class="c1">#doc Cluster</span>
        <span class="n">docsfrom_cluster</span> <span class="o">=</span> <span class="n">x_tr</span><span class="p">[</span><span class="n">x_tr</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">cl_data</span><span class="p">)]</span>
<span class="c1">#term Cluster</span>
        <span class="n">docsfrom_cluster</span> <span class="o">=</span> <span class="n">docsfrom_cluster</span><span class="o">.</span><span class="n">T</span>
<span class="c1">#All the non-zero terms are counted </span>
        <span class="n">DF</span> <span class="o">=</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([(</span><span class="n">docsfrom_cluster</span><span class="o">!=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
        <span class="n">DF</span> <span class="o">=</span> <span class="n">DF</span> <span class="o">/</span> <span class="n">size</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
<span class="c1">#In the cluster the number of docs are divided by each term count </span>
        <span class="n">DF</span><span class="o">.</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;DF&#39;</span><span class="p">]</span>     
        <span class="n">DF_PERCENT_</span> <span class="o">=</span> <span class="n">DF</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">DF_PERCENT_</span> <span class="o">=</span> <span class="n">DF_PERCENT_</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="n">DF_PERCENT_</span><span class="o">.</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">% o</span><span class="s1">f Docs&#39;</span><span class="p">]</span>
<span class="c1">#Concatenating the centroid, terms, and DF values</span>
        <span class="n">term_centroid_</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">term_list</span><span class="p">,</span> <span class="n">centroid</span><span class="p">,</span><span class="n">DF</span><span class="p">,</span><span class="n">DF_PERCENT_</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">result</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">term_centroid_</span>
    <span class="k">return</span> <span class="n">result</span> <span class="p">,</span> <span class="n">size</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[229]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">display_clusters</span><span class="p">(</span><span class="n">cluster_Dict</span><span class="p">,</span> <span class="n">cluster_Size</span><span class="p">,</span> <span class="n">num_Terms</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cluster_Dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">cluster_rep_</span> <span class="o">=</span> <span class="n">cluster_Dict</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
<span class="c1">#Printing the Cluster Size </span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cluster &quot;</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s2">&quot;size =&quot;</span><span class="p">,</span> <span class="n">cluster_Size</span><span class="p">[</span><span class="n">c</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">cluster_rep_</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;DF&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">num_Terms</span><span class="p">))</span>
    <span class="k">return</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[230]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">x_tr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">x_tr</span><span class="p">)</span>
<span class="n">cluster_Dict_nonidf</span> <span class="p">,</span> <span class="n">cluster_Size_nonidf</span> <span class="o">=</span> <span class="n">cluster_report</span><span class="p">(</span><span class="n">x_tr</span><span class="p">,</span><span class="n">terms</span><span class="p">,</span><span class="n">cluster_Assment</span><span class="p">,</span><span class="n">centroids</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cluster_Dict_nonidf</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;cluster of docs&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">cluster_Size_nonidf</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
      <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="s2">&quot; </span><span class="se">\t</span><span class="s2"> :: &quot;</span><span class="p">,</span><span class="n">cluster_Size_nonidf</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>1
3
4
dict_keys([1, 3, 4])
cluster of docs
1  	 ::  1
3  	 ::  5
4  	 ::  1994
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[231]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#NUMOFTOPTERMS is given 10</span>
<span class="n">numOf_TopNTerms</span> <span class="o">=</span> <span class="mi">10</span>
<span class="c1">#Displaying the clusters</span>
<span class="n">display_clusters</span><span class="p">(</span><span class="n">cluster_Dict_nonidf</span><span class="p">,</span><span class="n">cluster_Size_nonidf</span><span class="p">,</span><span class="n">numOf_TopNTerms</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Cluster  1 size = 1
          Term  Freq   DF  % of Docs
204       alin   1.0  1.0      100.0
7115      sale   1.0  1.0      100.0
1391     class   1.0  1.0      100.0
547         ax   2.0  1.0      100.0
8209     thoma   1.0  1.0      100.0
4027  instruct   1.0  1.0      100.0
7466    silent   1.0  1.0      100.0
7895   subject   1.0  1.0      100.0
6293     power   1.0  1.0      100.0
5593     ninja   1.0  1.0      100.0
Cluster  3 size = 5
       Term  Freq   DF  % of Docs
443    asqq   5.0  1.0      100.0
2508     ei   8.2  1.0      100.0
3317   gkwt   3.2  1.0      100.0
744     bhj   4.6  1.0      100.0
1420  cliff   1.0  1.0      100.0
5680   nriz   4.0  1.0      100.0
5428    mwt   3.8  1.0      100.0
3385     gp   4.6  1.0      100.0
4835     ma   7.0  1.0      100.0
5426     mw  10.2  1.0      100.0
Cluster  4 size = 1994
         Term  Freq    DF  % of Docs
7895  subject  1.08  1.00     100.00
9129    write  0.64  0.48      48.09
5795       on  0.76  0.39      39.27
417    articl  0.46  0.36      36.01
4449     know  0.48  0.29      29.39
3266      get  0.50  0.29      29.24
4319     just  0.42  0.28      27.83
8203    think  0.40  0.25      24.52
8255     time  0.38  0.23      23.02
3339       go  0.37  0.22      21.82
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[232]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#DT_IDF is repeated</span>
<span class="n">term_Freqs</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
<span class="n">term_Freqs</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[232]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>(9328,)</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[233]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Plotting the term_Freqs</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">term_Freqs</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="c1">#Providing the X and Y labels</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Terms&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://" class="jp-needs-light-background"/>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>The above output (graph) curve, it shows us that the term frequency are lesser.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[234]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Printing the shape for TD and DT</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;TD &quot;</span><span class="p">,</span> <span class="n">matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">DTmatrix</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">T</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DT &quot;</span><span class="p">,</span><span class="n">DTmatrix</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>TD  (9328, 2500)
DT  (2500, 9328)
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[235]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">num_Terms</span><span class="o">=</span><span class="n">DT_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">N_Docs</span> <span class="o">=</span> <span class="n">DT_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">T_D_matrix</span> <span class="o">=</span> <span class="n">matrix</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;numTerms &quot;</span><span class="p">,</span><span class="n">num_Terms</span><span class="p">,</span><span class="s2">&quot; NDocs &quot;</span><span class="p">,</span><span class="n">N_Docs</span><span class="p">)</span>
<span class="c1">#For each term finding the doc counts</span>
<span class="n">D_F</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([(</span><span class="n">T_D_matrix</span><span class="o">!=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span>
<span class="nb">print</span><span class="p">(</span><span class="n">D_F</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="c1">#A matrix with all entries are created </span>
<span class="n">N_Matrix</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">T_D_matrix</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span><span class="o">*</span><span class="n">N_Docs</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">120</span><span class="p">)</span>
<span class="c1">#Printing the NMatrix</span>
<span class="nb">print</span><span class="p">(</span><span class="n">N_Matrix</span><span class="p">)</span>
<span class="c1">#Each entry is converted into IDF values</span>
<span class="c1">#IDF - Inverse Data Frequency</span>
<span class="n">IDF</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">N_Matrix</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">D_F</span><span class="p">)))</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">IDF</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.precision&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="c1">#The TFXIDF is computed</span>
<span class="n">TD_tf_idf</span> <span class="o">=</span> <span class="n">T_D_matrix</span> <span class="o">*</span> <span class="n">IDF</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;TD_tfidf&quot;</span><span class="p">,</span><span class="n">TD_tf_idf</span><span class="p">)</span>
<span class="n">DT_tf_idf</span> <span class="o">=</span> <span class="n">TD_tf_idf</span><span class="o">.</span><span class="n">T</span>
<span class="n">DT_tf_idf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mat</span><span class="p">(</span><span class="n">DT_tf_idf</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The DT_tfidf.shape :&quot;</span><span class="p">,</span><span class="n">DT_tf_idf</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>numTerms  9328  NDocs  2500
(9328, 1)
[[2500. 2500. 2500. ... 2500. 2500. 2500.]
 [2500. 2500. 2500. ... 2500. 2500. 2500.]
 [2500. 2500. 2500. ... 2500. 2500. 2500.]
 ...
 [2500. 2500. 2500. ... 2500. 2500. 2500.]
 [2500. 2500. 2500. ... 2500. 2500. 2500.]
 [2500. 2500. 2500. ... 2500. 2500. 2500.]]
[[7.97 7.97 7.97 ... 7.97 7.97 7.97]
 [8.7  8.7  8.7  ... 8.7  8.7  8.7 ]
 [6.83 6.83 6.83 ... 6.83 6.83 6.83]
 ...
 [9.7  9.7  9.7  ... 9.7  9.7  9.7 ]
 [9.7  9.7  9.7  ... 9.7  9.7  9.7 ]
 [9.29 9.29 9.29 ... 9.29 9.29 9.29]]
TD_tfidf       0     1     2     3     4     5     6     7     8     9     ...  2490  \
0      0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  ...   0.0   
1      0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  ...   0.0   
2      0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  ...   0.0   
3      0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  ...   0.0   
4      0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  ...   0.0   
...    ...   ...   ...   ...   ...   ...   ...   ...   ...   ...  ...   ...   
9323   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  ...   0.0   
9324   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  ...   0.0   
9325   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  ...   0.0   
9326   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  ...   0.0   
9327   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  ...   0.0   

      2491  2492  2493  2494  2495  2496  2497  2498  2499  
0      0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  
1      0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  
2      0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  
3      0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  
4      0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  
...    ...   ...   ...   ...   ...   ...   ...   ...   ...  
9323   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  
9324   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  
9325   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  
9326   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  
9327   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  

[9328 rows x 2500 columns]
The DT_tfidf.shape : (2500, 9328)
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[236]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">x_tr_df</span><span class="p">,</span> <span class="n">x_te_idf</span><span class="p">,</span> <span class="n">y_tr_idf</span><span class="p">,</span> <span class="n">y_te_idf</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">DT_tf_idf</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">99</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[237]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mat</span><span class="p">(</span><span class="n">x_tr_df</span><span class="p">)</span>
<span class="c1">#Using the K-means</span>
<span class="n">centroids</span><span class="p">,</span> <span class="n">cluster_Assment</span> <span class="o">=</span> <span class="n">kmeans</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot; clusterAssment : &quot;</span><span class="p">,</span><span class="n">cluster_Assment</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot; centroids : &quot;</span><span class="p">,</span><span class="n">centroids</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>calculating centroids : Start
calculating centroids : End 
 centroids are :: 
 [[  4.88   5.1  136.07 ...  10.84   1.32  16.09]
 [  6.9    0.13 190.3  ...  11.48   8.96   7.75]
 [  7.06   2.22 186.16 ...   6.41   9.42  41.25]
 [  3.59   1.67 146.23 ...   4.1    7.25   1.45]
 [  5.35   1.71  49.69 ...   4.57   3.95  32.94]]
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>C:\Users\admin\AppData\Local\Temp\ipykernel_60652\2915286355.py:22: DeprecationWarning: setting an array element with a sequence. This was supported in some cases where the elements are arrays with a single element. For example `np.array([1, np.array([2])], dtype=int)`. In the future this will raise the same ValueError as `np.array([1, [2]], dtype=int)`.
  cluster_Assment[i,:] = min_Index, min_DIst**2
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre> clusterAssment :  (2000, 2)
 centroids :  (5, 9328)
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[238]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Finding the Centroids</span>
<span class="n">centroids</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[238]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>array([[0.  , 0.  , 0.16, ..., 0.12, 0.  , 0.  ],
       [0.  , 0.  , 0.  , ..., 0.  , 0.  , 0.  ],
       [0.03, 0.03, 0.27, ..., 0.01, 0.01, 0.05],
       [0.  , 0.  , 0.  , ..., 0.  , 0.  , 0.  ],
       [0.  , 0.  , 0.  , ..., 0.  , 0.  , 0.  ]])</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[239]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">x_tr_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">x_tr_df</span><span class="p">)</span>
<span class="n">cluster_Dict</span> <span class="p">,</span> <span class="n">cluster_Size</span> <span class="o">=</span> <span class="n">cluster_report</span><span class="p">(</span><span class="n">x_tr_df</span><span class="p">,</span><span class="n">terms</span><span class="p">,</span><span class="n">cluster_Assment</span><span class="p">,</span><span class="n">centroids</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cluster_Dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">cluster# :: # of docs&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">cluster_Size</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
      <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="s2">&quot; </span><span class="se">\t</span><span class="s2"> :: &quot;</span><span class="p">,</span><span class="n">cluster_Size</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>0
1
2
3
4
dict_keys([0, 1, 2, 3, 4])

cluster# :: # of docs
0  	 ::  83
1  	 ::  4
2  	 ::  1907
3  	 ::  5
4  	 ::  1
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[240]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#NumofTopNTerms</span>
<span class="n">num_OfTop_NTerms</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">display_clusters</span><span class="p">(</span><span class="n">cluster_Dict</span><span class="p">,</span><span class="n">cluster_Size</span><span class="p">,</span><span class="n">num_OfTop_NTerms</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Cluster  0 size = 83
         Term  Freq    DF  % of Docs
7895  subject  0.00  1.00     100.00
5795       on  0.75  0.36      36.14
2933     file  2.81  0.30      30.12
8174    thank  0.73  0.28      27.71
9129    write  0.36  0.27      26.51
5506     need  0.86  0.25      25.30
4449     know  0.58  0.25      25.30
2550    email  0.59  0.20      20.48
417    articl  0.40  0.19      19.28
4319     just  0.45  0.18      18.07
Cluster  1 size = 4
              Term      Freq    DF  % of Docs
7895       subject      0.00  1.00      100.0
6225           pne     13.45  0.75       75.0
5344            mp     37.56  0.75       75.0
3311         gizwt     16.96  0.75       75.0
5694           nui     42.40  0.75       75.0
7116  salmonusdedu      5.87  0.75       75.0
9223            yd     37.84  0.75       75.0
3275         ghjkn     10.88  0.75       75.0
547             ax  45576.57  0.75       75.0
5428           mwt     23.32  0.75       75.0
Cluster  2 size = 1907
         Term  Freq    DF  % of Docs
7895  subject  0.00  1.00     100.00
9129    write  0.70  0.49      49.08
5795       on  1.06  0.39      39.49
417    articl  0.70  0.37      36.76
3266      get  0.91  0.30      29.89
4449     know  0.87  0.30      29.58
4319     just  0.79  0.28      28.26
8203    think  0.83  0.25      25.12
8255     time  0.81  0.23      23.44
3339       go  0.84  0.22      22.44
Cluster  3 size = 5
                Term  Freq   DF  % of Docs
7895         subject  0.00  1.0      100.0
6207           pleas  1.03  0.4       40.0
1977           david  2.10  0.4       40.0
7115            sale  1.76  0.4       40.0
6280            post  1.16  0.4       40.0
2703  eulerlbsmsuedu  1.79  0.2       20.0
8477            type  0.88  0.2       20.0
727             best  0.65  0.2       20.0
2836             fan  1.66  0.2       20.0
8270              tj  1.74  0.2       20.0
Cluster  4 size = 1
         Term   Freq   DF  % of Docs
7338      set   3.70  1.0      100.0
4777      lot  10.33  1.0      100.0
7895  subject   0.00  1.0      100.0
7020     ross   7.04  1.0      100.0
7121      sam   6.90  1.0      100.0
6377      pro   5.62  1.0      100.0
1126     card  23.22  1.0      100.0
2376     drop   5.62  1.0      100.0
2275    divid   7.48  1.0      100.0
760       bid  16.24  1.0      100.0
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>d. [5 pts] Using the cluster assignments from your Kmeans clustering and the original cluster labels for the training document, compare your clusters to the re-assigned classes by computing the Completeness and Homogeneity values. You should do this for the best values of k and the best clustering run you settled on in the previous part.
[Extra Credit - 5 pts: Try several other clustering runs each time with values of k ranging between 4 and 8 and in each case compute Completeness and Homogeneity. This experiment will indicate which clustering provides the best representation of the original newsgroup categories. Provide a brief report of your experiment including a comparison of final results for at least three different runs.]</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[241]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Training IDF</span>
<span class="n">y_tr_idf</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[241]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>array([1, 0, 0, ..., 3, 1, 0])</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[242]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Cluster</span>
<span class="n">cluster_Assment</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[242]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>matrix([[0., 2., 2., ..., 2., 2., 2.]])</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[243]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#importing the completeness_score, and homogeneity_score </span>
<span class="c1">#using the sci-kit</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">completeness_score</span><span class="p">,</span> <span class="n">homogeneity_score</span>
<span class="c1">#Completeness Score</span>
<span class="c1">#Homogeneity Score</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;completeness_score = &quot;</span><span class="p">,</span><span class="n">completeness_score</span><span class="p">(</span><span class="n">y_tr_idf</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">cluster_Assment</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;homogeneity_score = &quot;</span><span class="p">,</span><span class="n">homogeneity_score</span><span class="p">(</span><span class="n">y_tr_idf</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">cluster_Assment</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>completeness_score =  0.0639102193757946
homogeneity_score =  0.008286302814358196
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>e. [10 pts] Finally, using your cluster assignments as class labels, categorize each of the documents in the 20% set-aside data into each of the appropriate clusters (using your final clustering results in part c). Your categorization should be based on Cosine similarity between each test document and cluster centroids. For each test document show the assigned cluster label as well as Cosine similarity to the corresponding cluster.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[244]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Printing the shape</span>
<span class="nb">print</span><span class="p">(</span><span class="n">centroids</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">centroids</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;vs_test_idf shape &quot;</span><span class="p">,</span><span class="n">x_te_idf</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>(5, 9328)
[[0.   0.   0.16 ... 0.12 0.   0.  ]
 [0.   0.   0.   ... 0.   0.   0.  ]
 [0.03 0.03 0.27 ... 0.01 0.01 0.05]
 [0.   0.   0.   ... 0.   0.   0.  ]
 [0.   0.   0.   ... 0.   0.   0.  ]]
vs_test_idf shape  (500, 9328)
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[245]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">x_te</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_te_idf</span><span class="p">)</span>
<span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">x_te</span><span class="p">:</span>
<span class="c1">#dic</span>
    <span class="n">dic</span> <span class="o">=</span> <span class="p">{}</span>
<span class="c1">#sim</span>
    <span class="n">sim</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">cluster</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">centroid</span> <span class="ow">in</span> <span class="n">centroids</span><span class="p">:</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">calculateCosineSimilarityDistance</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span><span class="n">centroid</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">centroid_doc_sim</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">val</span> 
        <span class="n">sim</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">centroid_doc_sim</span><span class="p">)</span> 
        <span class="n">dic</span><span class="p">[</span><span class="s1">&#39;Cluster to Cosine Similarity&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">cluster</span><span class="p">)]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">centroid_doc_sim</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">cluster</span> <span class="o">+=</span> <span class="mi">1</span>     
    <span class="n">dic</span><span class="p">[</span><span class="s1">&#39;The Predicted Cluster&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">sim</span><span class="p">))</span>    
    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dic</span><span class="p">)</span>
<span class="n">te_cluster</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[246]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">50</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The Categorized test data shape &quot;</span><span class="p">,</span><span class="n">te_cluster</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="c1">#Showing the result for the test cluster</span>
<span class="n">te_cluster</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>The Categorized test data shape  (500, 6)
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[246]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Cluster to Cosine Similarity0</th>
      <th>Cluster to Cosine Similarity1</th>
      <th>Cluster to Cosine Similarity2</th>
      <th>Cluster to Cosine Similarity3</th>
      <th>Cluster to Cosine Similarity4</th>
      <th>The Predicted Cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0005947145629348061</td>
      <td>4.5542392901332107e-07</td>
      <td>0.1771508063405529</td>
      <td>0.016402888409637773</td>
      <td>0.0032941266950289316</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0005273903719441586</td>
      <td>0.0</td>
      <td>0.10402558965399467</td>
      <td>0.02389476342484731</td>
      <td>0.008207128739202263</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0007477381836455965</td>
      <td>1.4921338694962039e-05</td>
      <td>0.13166280779932582</td>
      <td>0.004224232708908149</td>
      <td>0.009056930283236397</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>9.952061229578923e-05</td>
      <td>4.997920329485872e-06</td>
      <td>0.06067654386888233</td>
      <td>0.03448694007478459</td>
      <td>0.0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.0007369601887645683</td>
      <td>8.272710750212298e-06</td>
      <td>0.1996192626254707</td>
      <td>0.04104974102899528</td>
      <td>0.008651124738891514</td>
      <td>2</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>495</th>
      <td>0.0008516999515513213</td>
      <td>0.0</td>
      <td>0.10975912590377535</td>
      <td>0.0018424236411392902</td>
      <td>0.0023510086123419427</td>
      <td>2</td>
    </tr>
    <tr>
      <th>496</th>
      <td>0.00018328967802572205</td>
      <td>3.7881102961101476e-06</td>
      <td>0.10361856463833696</td>
      <td>0.011662603881717581</td>
      <td>0.0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>497</th>
      <td>0.0003130777146843622</td>
      <td>4.2383552284142034e-05</td>
      <td>0.07563875122836594</td>
      <td>0.004731567287736382</td>
      <td>0.0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>498</th>
      <td>0.0007647884015551387</td>
      <td>6.199013367069739e-07</td>
      <td>0.10731921378029818</td>
      <td>0.01168417251769538</td>
      <td>0.0025590047919475944</td>
      <td>2</td>
    </tr>
    <tr>
      <th>499</th>
      <td>0.0005715686542151488</td>
      <td>0.0</td>
      <td>0.10676150994240152</td>
      <td>0.006487760269677567</td>
      <td>0.0017975267383805171</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
<p>500 rows &#215; 6 columns</p>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>

     </div>
</div>
</div>
</div>

</div>









<script type="module" src="https://s.brightspace.com/lib/bsi/20.23.2-186/unbundled/mathjax.js"></script><script type="text/javascript">document.addEventListener('DOMContentLoaded', function() {
					if (document.querySelector('math') || /\$\$|\\\(|\\\[|\\begin{|\\ref{|\\eqref{/.test(document.body.innerHTML)) {
						document.querySelectorAll('mspace[linebreak="newline"]').forEach(elm => {
							elm.setAttribute('style', 'display: block; height: 0.5rem;');
						});

						window.D2L.MathJax.loadMathJax({
							'outputScale': 1.3,
							'renderLatex': false
						});
					}
				});</script><script type="module" src="https://s.brightspace.com/lib/bsi/20.23.2-186/unbundled/prism.js"></script><script type="text/javascript">document.addEventListener('DOMContentLoaded', function() {
					document.querySelectorAll('.d2l-code').forEach(code => {
						window.D2L.Prism.formatCodeElement(code);
					});
				});</script></body></html>